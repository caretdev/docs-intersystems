"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[97794],{28631:(e,t,s)=>{s.r(t),s.d(t,{contentTitle:()=>o,default:()=>c,frontMatter:()=>a,toc:()=>i});var r=s(74848),n=s(28453);const a={pagination_prev:null,pagination_next:null},o="SYS.DataCheck.Workflow",i=[{value:"Parameters",id:"parameters",level:2},{value:"VERSIONPROPERTY",id:"versionproperty",level:3},{value:"Properties",id:"properties",level:2},{value:"SystemName",id:"systemname",level:3},{value:"Phases",id:"phases",level:3},{value:"NewPhaseNumber",id:"newphasenumber",level:3},{value:"AbortCurrentPhase",id:"abortcurrentphase",level:3},{value:"Version",id:"version",level:3},{value:"Timeout",id:"timeout",level:3},{value:"Methods",id:"methods",level:2},{value:"%OnValidateObject",id:"onvalidateobject",level:3}];function h(e){const t={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",property:"property",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"sysdatacheckworkflow",children:"SYS.DataCheck.Workflow"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Class SYS.DataCheck.Workflow Extends %Persistent\n"})}),"\n",(0,r.jsx)(t.p,{children:"Workflow to be performed by running system. See System for overview. An instance of this class is referenced by each Destination object."}),"\n",(0,r.jsxs)(t.p,{children:["The workflow is a numbered list of phases. Each phase is an object of one of the following classes:",(0,r.jsx)(t.br,{}),"\nPhaseCheck, PhaseRecheckDiscrepancies, PhaseStop, or PhaseIdle."]}),"\n",(0,r.jsx)(t.p,{children:"Each phase object represents a set of actions that the system will take and includes properties to act as the functional parameters of the phase (as well as internal properties to manage internal state). When the Workflow object is created as part of the creation of a new DataCheck Destination object, it is set up with a default set of phases: 1 - Check, 2 - ReCheckDiscrepancies (with 10 iterations), and 3 - Stop."}),"\n",(0,r.jsx)(t.p,{children:"The system proceeds through the phases in numerical order and on completion of the last phase, begins the fist phase anew. The Workflow object can be modified at any time while the system is running, and can be used to force the system to move to a new phase, or redefine the list of phases."}),"\n",(0,r.jsx)(t.p,{children:"If DataCheck stops in the middle of processing (e.g. in the Check or RecheckDiscrepancy phase) there are options upon starting again to restart from phase #1 of the workflow anew rather than resume processing the current phase. The first phase, therefore, should be set up to be the logical beginning of the workflow. The options to restart from phase #1 take three forms: the Timeout property in this object, an argument to the Start method of the Destination object, and interactive dialog for starting in ^DATACHECK."}),"\n",(0,r.jsxs)(t.p,{children:["As an example, the following code snippet changes the workflow back to the default set of phases and sets the system to immediately go back to the first phase:",(0,r.jsx)(t.br,{}),"\n",(0,r.jsx)(t.code,{children:"set workflow=##class(SYS.DataCheck.Workflow).%OpenId(name)     set sc=workflow.Phases.Clear() quit:$$$ISERR(sc) sc     set p=##class(SYS.DataCheck.PhaseCheck).%New()     set sc=workflow.Phases.Insert(p) quit:$$$ISERR(sc) sc     set p=##class(SYS.DataCheck.PhaseRecheckDiscrepancies).%New()     set p.Iterations=10     set sc=workflow.Phases.Insert(p) quit:$$$ISERR(sc) sc     set p=##class(SYS.DataCheck.PhaseStop).%New()     set sc=workflow.Phases.Insert(p) quit:$$$ISERR(sc) sc     set workflow.NewPhaseNumber=1 ; start at phase 1     set workflow.AbortCurrentPhase=1 ; stop working on the current phase     set sc=workflow.%Save()     quit sc"})]}),"\n",(0,r.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(t.h3,{id:"versionproperty",children:"VERSIONPROPERTY"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter VERSIONPROPERTY As STRING [ Internal ] = "Version";\n'})}),"\n",(0,r.jsxs)(t.p,{children:["VERSIONPROPERTY = ",(0,r.jsxs)(t.property,{children:[" means that the ",(0,r.jsxs)(t.property,{children:[" in memory will be compared to the ",(0,r.jsx)(t.property,{children:" on disk during an update. If different a concurrency conflict error will be reported and the save will fail."})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(t.h3,{id:"systemname",children:"SystemName"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Property SystemName As SystemName [ Required ];\n"})}),"\n",(0,r.jsx)(t.p,{children:"Name of the DataCheck Destination system that uses this object. Set upon creating the destination object and should not be changed."}),"\n",(0,r.jsx)(t.h3,{id:"phases",children:"Phases"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Property Phases As list Of Phase(CLASSNAME = 1);\n"})}),"\n",(0,r.jsx)(t.p,{children:"Numbered list of phases"}),"\n",(0,r.jsx)(t.h3,{id:"newphasenumber",children:"NewPhaseNumber"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Property NewPhaseNumber As %Integer(MINVAL = 0);\n"})}),"\n",(0,r.jsx)(t.p,{children:"User-specified new phase number. If not set (or set to zero) the system will move to the phase that follows its current phase when the current phase is complete. If set to a phase number the system will move to the specified phase when the current phase is complete."}),"\n",(0,r.jsx)(t.h3,{id:"abortcurrentphase",children:"AbortCurrentPhase"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Property AbortCurrentPhase As %Boolean [ InitialExpression = 0 ];\n"})}),"\n",(0,r.jsx)(t.p,{children:"If true, the system will abort the phase of the workflow that it is currently processing and move to the next phase immediately rather than allow this phase to complete any queries it is currently processing."}),"\n",(0,r.jsx)(t.h3,{id:"version",children:"Version"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Property Version As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(t.p,{children:"Version used for optimistic concurrency"}),"\n",(0,r.jsx)(t.h3,{id:"timeout",children:"Timeout"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Property Timeout As %Integer [ InitialExpression = 432000 ];\n"})}),"\n",(0,r.jsx)(t.p,{children:"If the DataCheck system becomes stopped, disconnected, or paused (waiting for mirroring) in the middle of the check, then upon returning to the running state, the system would normally resume the workflow from where it left off. If the system does not return to the running state within some reasonable period, it may not be desireable to automatically resume the workflow. For example, if the systems were disconnected for several weeks in the middle of a check and then the check is resumed, the results are of questionable value, having been collected in part from two weeks prior and in part from the present time."}),"\n",(0,r.jsx)(t.p,{children:"This property is the time, in seconds, within which DataCheck may resume a partially completed workflow phase. If this timeout is exceeded, it will restart from phase number one. A value of zero will always resume, never restart."}),"\n",(0,r.jsx)(t.p,{children:"Default is five days (432000), on the assumption that a large amount of data is checked by this DataCheck configuration and the check may take a day or more to complete. A smaller value may be desired for configurations that complete a check in a shorter amount of time."}),"\n",(0,r.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(t.h3,{id:"onvalidateobject",children:"%OnValidateObject"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method %OnValidateObject() As %Status [ Internal, Private, ProcedureBlock = 1, ServerOnly = 1 ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"This callback method is invoked by the %ValidateObject method to provide notification that the current object is being validated."}),"\n",(0,r.jsx)(t.p,{children:"If this method returns an error then %ValidateObject will fail."})]})}function c(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>i});var r=s(96540);const n={},a=r.createContext(n);function o(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);