"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[57008],{30994:(e,s,n)=>{n.r(s),n.d(s,{contentTitle:()=>o,default:()=>c,frontMatter:()=>r,toc:()=>l});var i=n(74848),t=n(28453);const r={pagination_prev:null,pagination_next:null},o="%OAuth2.Server.CookieSession",l=[{value:"Parameters",id:"parameters",level:2},{value:"COOKIENAME",id:"cookiename",level:3},{value:"Properties",id:"properties",level:2},{value:"Cookie",id:"cookie",level:3},{value:"Username",id:"username",level:3},{value:"Expires",id:"expires",level:3},{value:"Scope",id:"scope",level:3},{value:"AuthTime",id:"authtime",level:3},{value:"Methods",id:"methods",level:2},{value:"GetUser",id:"getuser",level:3},{value:"Update",id:"update",level:3},{value:"Login",id:"login",level:3},{value:"Logout",id:"logout",level:3},{value:"DeleteAll",id:"deleteall",level:3},{value:"MakeCookieValue",id:"makecookievalue",level:3},{value:"GetCookie",id:"getcookie",level:3},{value:"SetCookie",id:"setcookie",level:3},{value:"GetCurrentSession",id:"getcurrentsession",level:3},{value:"OpenByCookie",id:"openbycookie",level:3},{value:"Delete",id:"delete",level:3},{value:"Cleanup",id:"cleanup",level:3}];function a(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"oauth2servercookiesession",children:"%OAuth2.Server.CookieSession"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Class %OAuth2.Server.CookieSession Extends (%Persistent, %OAuth2.Server.AbstractSession) [ Abstract, NoExtent, System = 4 ]\n"})}),"\n",(0,i.jsx)(s.p,{children:"This class implements a simple OAuth2 session maintenance class where the user's session is tracked by an opaque cookie. This is a persistent class containing basic session data indexed by the cookie value."}),"\n",(0,i.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsx)(s.h3,{id:"cookiename",children:"COOKIENAME"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter COOKIENAME As STRING;\n"})}),"\n",(0,i.jsx)(s.p,{children:"The name of the cookie used to maintain the session"}),"\n",(0,i.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,i.jsx)(s.h3,{id:"cookie",children:"Cookie"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property Cookie As %String(COLLATION = "EXACT", MAXLEN = 128) [ Required ];\n'})}),"\n",(0,i.jsx)(s.p,{children:"The IDKEY for the session class. The session is indexed by the Username Order by expiration time Opaque Cookie value used to track the user's session"}),"\n",(0,i.jsx)(s.h3,{id:"username",children:"Username"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property Username As %Library.Username(COLLATION = "EXACT");\n'})}),"\n",(0,i.jsx)(s.p,{children:"The User name associated with this session"}),"\n",(0,i.jsx)(s.h3,{id:"expires",children:"Expires"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Property Expires As %Integer;\n"})}),"\n",(0,i.jsx)(s.p,{children:'Expires is the time in seconds from beginning of the Unix epoch when the session expires. If Expires="", then session does not expire.'}),"\n",(0,i.jsx)(s.h3,{id:"scope",children:"Scope"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property Scope As %String(MAXLEN = "");\n'})}),"\n",(0,i.jsx)(s.p,{children:"Scope is the blank separated list of scopes permitted for this user in this session."}),"\n",(0,i.jsx)(s.h3,{id:"authtime",children:"AuthTime"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Property AuthTime As %Integer;\n"})}),"\n",(0,i.jsx)(s.p,{children:"The time when the user was authenticated"}),"\n",(0,i.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,i.jsx)(s.h3,{id:"getuser",children:"GetUser"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod GetUser(Output scope As %String, Output authTime As %Integer, Output sc As %Status, authCode As %String = "") As %String\n'})}),"\n",(0,i.jsx)(s.p,{children:'Return the username (and granted scopes, and authentication time) for the current session, or "" if there is no current session.'}),"\n",(0,i.jsx)(s.h3,{id:"update",children:"Update"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Update(scope As %String, interval As %Integer) As %Status\n"})}),"\n",(0,i.jsx)(s.p,{children:"Update the current session with the given scope values and timeout interval. This does nothing if there is no current session."}),"\n",(0,i.jsx)(s.h3,{id:"login",children:"Login"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod Login(username As %String, scope As %String, interval As %Integer, Output authTime As %Integer, authCode As %String = "") As %Status\n'})}),"\n",(0,i.jsx)(s.p,{children:"Create a new session for the given user. This creates a new session Object and sets a new cookie in the User Agent referencing this session."}),"\n",(0,i.jsx)(s.h3,{id:"logout",children:"Logout"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Logout() As %Status\n"})}),"\n",(0,i.jsx)(s.p,{children:"Terminate the current session. This will delete the session object and all cookies associated with it and expire the cookie. Absence of a session is not seen as an error and this method will still return 1 (though it won't actually do anything if no session exists)."}),"\n",(0,i.jsx)(s.h3,{id:"deleteall",children:"DeleteAll"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DeleteAll() As %Status\n"})}),"\n",(0,i.jsx)(s.p,{children:"Delete all sessions."}),"\n",(0,i.jsx)(s.h3,{id:"makecookievalue",children:"MakeCookieValue"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod MakeCookieValue() As %String\n"})}),"\n",(0,i.jsx)(s.p,{children:"This method is used to produce the cookie value for a new session."}),"\n",(0,i.jsx)(s.h3,{id:"getcookie",children:"GetCookie"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetCookie() As %String\n"})}),"\n",(0,i.jsx)(s.p,{children:"This method will retrieve the cookie value for the current session, if one exists."}),"\n",(0,i.jsx)(s.h3,{id:"setcookie",children:"SetCookie"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SetCookie(value As %String, expires As %Integer)\n"})}),"\n",(0,i.jsx)(s.p,{children:"This method will set the given cookie value in the User Agent, with the given expiration time."}),"\n",(0,i.jsx)(s.h3,{id:"getcurrentsession",children:"GetCurrentSession"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetCurrentSession(Output sc As %Status) As %OAuth2.Server.CookieSession [ Internal ]\n"})}),"\n",(0,i.jsx)(s.p,{children:'The GetCurrentSession method returns the currently logged in session. If no session exists, then "" is returned.'}),"\n",(0,i.jsx)(s.h3,{id:"openbycookie",children:"OpenByCookie"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OpenByCookie(cookie As %String, Output sc As %Status) As %OAuth2.Server.CookieSession [ Internal ]\n"})}),"\n",(0,i.jsx)(s.p,{children:"Open the OAuth2.Server.Session instance using Cookie."}),"\n",(0,i.jsx)(s.h3,{id:"delete",children:"Delete"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Method Delete() As %Status [ Internal ]\n"})}),"\n",(0,i.jsx)(s.p,{children:"Delete this session object"}),"\n",(0,i.jsx)(s.h3,{id:"cleanup",children:"Cleanup"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Cleanup() [ CodeMode = objectgenerator, Internal ]\n"})}),"\n",(0,i.jsx)(s.p,{children:"Delete all expired sessions"})]})}function c(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>l});var i=n(96540);const t={},r=i.createContext(t);function o(e){const s=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);