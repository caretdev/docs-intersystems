"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[68519],{3270:(e,r,s)=>{s.r(r),s.d(r,{contentTitle:()=>i,default:()=>d,frontMatter:()=>o,toc:()=>c});var n=s(74848),t=s(28453);const o={pagination_prev:null,pagination_next:null},i="%SYSTEM.Error",c=[{value:"Properties",id:"properties",level:2},{value:"Status",id:"status",level:3},{value:"messageId",id:"messageid",level:3},{value:"Code",id:"code",level:3},{value:"SQLCode",id:"sqlcode",level:3},{value:"Message",id:"message",level:3},{value:"Severity",id:"severity",level:3},{value:"Methods",id:"methods",level:2},{value:"%OnNew",id:"onnew",level:3},{value:"%OnClose",id:"onclose",level:3},{value:"SQLCodeSet",id:"sqlcodeset",level:3},{value:"SQLCodeGet",id:"sqlcodeget",level:3},{value:"findXRef",id:"findxref",level:3},{value:"AsException",id:"asexception",level:3},{value:"FromException",id:"fromexception",level:3},{value:"FromSQLCode",id:"fromsqlcode",level:3},{value:"FromXSQL",id:"fromxsql",level:3},{value:"getOdbcError",id:"getodbcerror",level:3}];function a(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"systemerror",children:"%SYSTEM.Error"})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:"Class %SYSTEM.Error Extends %RegisteredObject [ System = 4 ]\n"})}),"\n",(0,n.jsx)(r.p,{children:"%SYSTEM.Error is a generic error container used to return error information reported from various sources. Errors can occur in several different ways. A %Status value can be returned, an ObjectScript error can be trapped and reported as $ZERROR, an SQLCODE error can be reported by an SQL statement, or an error number from an XSQL procedure can be reported. All of these errors must be recognizable and be able to be reported in various forms. xDBC expects an SQLCODE while other systems might want %Status values. This class provides a mechanism for consistent reporting and detection."}),"\n",(0,n.jsx)(r.h2,{id:"properties",children:"Properties"}),"\n",(0,n.jsx)(r.h3,{id:"status",children:"Status"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:"Property Status As %Status;\n"})}),"\n",(0,n.jsx)(r.p,{children:"The %Status code of this error. An error will ALWAYS have a %Status value"}),"\n",(0,n.jsx)(r.h3,{id:"messageid",children:"messageId"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:'Property messageId As %Integer [ SqlComputeCode = { set {*}=$Select({Status}="":0,1:$List($List($Extract({Status},3,$Length({Status}))))) }, SqlComputed, SqlComputeOnChange = Status ];\n'})}),"\n",(0,n.jsx)(r.p,{children:"This is computed from the value of Status"}),"\n",(0,n.jsx)(r.h3,{id:"code",children:"Code"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:'Property Code As %String(MAXLEN = 255) [ InitialExpression = "0" ];\n'})}),"\n",(0,n.jsx)(r.p,{children:'The error code - for CacheError (messageId = 5002) this is the $ZError code ($e($ze,1,$f($ze,1,">")) for SQLError (messageId = 5540) this is the SQLCODE value. For most other messageId\'s, this is 0 (zero). Code simply provides additional detail for a %Status error'}),"\n",(0,n.jsx)(r.h3,{id:"sqlcode",children:"SQLCode"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:'Property SQLCode As %String(MAXLEN = "");\n'})}),"\n",(0,n.jsx)(r.p,{children:"SQLCode of this error, may be null."}),"\n",(0,n.jsx)(r.h3,{id:"message",children:"Message"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:'Property Message As %String(MAXLEN = "");\n'})}),"\n",(0,n.jsx)(r.p,{children:"Additional free text information about the error, may be null"}),"\n",(0,n.jsx)(r.h3,{id:"severity",children:"Severity"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:"Property Severity As %Integer(MAXVAL = 25, MINVAL = 0);\n"})}),"\n",(0,n.jsx)(r.p,{children:"Severity is an indication as to the severity of the error being reported. The value, 0-25, not only provides information, it is a hint to the error processor as to what action to take. For TSQL this means returning control to the current batch or procedure at the point following the statement reporting the error, exiting the current batch or procedure or terminating the connection. TSQL defines severity of 10-19 as transferring to the CATCH block. InterSystems IRIS will exit the current procedure if severity is > 19."}),"\n",(0,n.jsx)(r.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(r.h3,{id:"onnew",children:"%OnNew"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:'Method %OnNew(pStatus As %Status = "", pSQLCode As %String = "", pMessage As %String = "", pSeverity As %Integer = 0) As %Status\n'})}),"\n",(0,n.jsx)(r.p,{children:"Create a new error given a %Status or an SQLCODE and %message value. Severity applies to certain XSQL systems (TSQL only for now)"}),"\n",(0,n.jsx)(r.h3,{id:"onclose",children:"%OnClose"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:"Method %OnClose() As %Status [ Private, ProcedureBlock = 1, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(r.p,{children:"This callback method is invoked by the %Close method to provide notification that the current object is being closed."}),"\n",(0,n.jsx)(r.p,{children:"The return value of this method is ignored."}),"\n",(0,n.jsx)(r.h3,{id:"sqlcodeset",children:"SQLCodeSet"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:"Method SQLCodeSet(newvalue As %String) As %Status\n"})}),"\n",(0,n.jsx)(r.h3,{id:"sqlcodeget",children:"SQLCodeGet"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:"Method SQLCodeGet() As %String\n"})}),"\n",(0,n.jsx)(r.h3,{id:"findxref",children:"findXRef"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:"Method findXRef(messageDomain As %String) As %Integer [ CodeMode = expression ]\n"})}),"\n",(0,n.jsx)(r.p,{children:"findXRef - lookup a cross-referenced message in the requested domain"}),"\n",(0,n.jsx)(r.h3,{id:"asexception",children:"AsException"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:"Method AsException() As %Exception.AbstractException\n"})}),"\n",(0,n.jsx)(r.p,{children:"asException() - return a new instance of an exception"}),"\n",(0,n.jsx)(r.h3,{id:"fromexception",children:"FromException"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:'ClassMethod FromException(pException As %Exception.AbstractException = "") As %SYSTEM.Error\n'})}),"\n",(0,n.jsx)(r.p,{children:"fromException() - instantiate a new %SYSTEM.Error object from an exception object."}),"\n",(0,n.jsx)(r.h3,{id:"fromsqlcode",children:"FromSQLCode"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:'ClassMethod FromSQLCode(pSQLCODE As %Integer = -400, pMessage As %String(MAXLEN="") = "") As %SYSTEM.Error\n'})}),"\n",(0,n.jsx)(r.p,{children:"fromSQLCode() - instantiate a new %SYSTEM.Error object from an SQLCODE and message."}),"\n",(0,n.jsx)(r.h3,{id:"fromxsql",children:"FromXSQL"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:'ClassMethod FromXSQL(pDomain As %String = "", pXSQLCODE As %Integer = 0, pMessage As %String(MAXLEN="") = "") As %SYSTEM.Error\n'})}),"\n",(0,n.jsx)(r.p,{children:"FromXSQL() - instantiate a new %SYSTEM.Error object from an error code that originates from and XSQL procedure. This is called from generated code for TSQL RAISERROR (v27) and Informix RAISE EXCEPTION (v25)"}),"\n",(0,n.jsx)(r.h3,{id:"getodbcerror",children:"getOdbcError"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-objectscript-class",children:"Method getOdbcError(sqlcode, message)\n"})})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},28453:(e,r,s)=>{s.d(r,{R:()=>i,x:()=>c});var n=s(96540);const t={},o=n.createContext(t);function i(e){const r=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),n.createElement(o.Provider,{value:r},e.children)}}}]);