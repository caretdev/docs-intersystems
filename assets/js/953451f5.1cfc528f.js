"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[13541],{28397:(e,n,i)=>{i.r(n),i.d(n,{contentTitle:()=>t,default:()=>c,frontMatter:()=>l,toc:()=>a});var s=i(74848),r=i(28453);const l={pagination_prev:null,pagination_next:null},t="%ML.Model",a=[{value:"Properties",id:"properties",level:2},{value:"Name",id:"name",level:3},{value:"Description",id:"description",level:3},{value:"PredictingColumnNames",id:"predictingcolumnnames",level:3},{value:"PredictingColumnTypes",id:"predictingcolumntypes",level:3},{value:"WithColumnNames",id:"withcolumnnames",level:3},{value:"WithColumnTypes",id:"withcolumntypes",level:3},{value:"WithColumnText",id:"withcolumntext",level:3},{value:"DefaultIDColumnFound",id:"defaultidcolumnfound",level:3},{value:"TimeSeries",id:"timeseries",level:3},{value:"DateTimeColumn",id:"datetimecolumn",level:3},{value:"Forward",id:"forward",level:3},{value:"TimeStep",id:"timestep",level:3},{value:"ForwardResponse",id:"forwardresponse",level:3},{value:"DefaultParameters",id:"defaultparameters",level:3},{value:"DefaultTrainingQuery",id:"defaulttrainingquery",level:3},{value:"CreatedAt",id:"createdat",level:3},{value:"DefaultTrainedModel",id:"defaulttrainedmodel",level:3},{value:"Triggers",id:"triggers",level:2},{value:"DeleteTrigger",id:"deletetrigger",level:3},{value:"Methods",id:"methods",level:2},{value:"%Train",id:"train",level:3},{value:"%Predict",id:"predict",level:3},{value:"%Probability",id:"probability",level:3},{value:"%PredictAll",id:"predictall",level:3},{value:"%Validate",id:"validate",level:3},{value:"%Purge",id:"purge",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"mlmodel",children:"%ML.Model"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Class %ML.Model Extends %Persistent [ ClassType = persistent, System = 4 ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Definition of a ML model"}),"\n",(0,s.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,s.jsx)(n.h3,{id:"name",children:"Name"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property Name As %String(MAXLEN = 256) [ Required ];\n"})}),"\n",(0,s.jsx)(n.p,{children:"Name of the model"}),"\n",(0,s.jsx)(n.h3,{id:"description",children:"Description"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property Description As %String(MAXLEN = 8192);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Model description"}),"\n",(0,s.jsx)(n.h3,{id:"predictingcolumnnames",children:"PredictingColumnNames"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property PredictingColumnNames As list Of %String(MAXLEN = 128) [ Required ];\n"})}),"\n",(0,s.jsx)(n.p,{children:"Column Name(s) we're predicting"}),"\n",(0,s.jsx)(n.h3,{id:"predictingcolumntypes",children:"PredictingColumnTypes"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property PredictingColumnTypes As list Of %String(MAXLEN = 128) [ Required ];\n"})}),"\n",(0,s.jsx)(n.p,{children:"Column Types(s) we're predicting"}),"\n",(0,s.jsx)(n.h3,{id:"withcolumnnames",children:"WithColumnNames"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property WithColumnNames As list Of %String(MAXLEN = 128) [ Required ];\n"})}),"\n",(0,s.jsx)(n.p,{children:"Columns names we're predicting using"}),"\n",(0,s.jsx)(n.h3,{id:"withcolumntypes",children:"WithColumnTypes"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property WithColumnTypes As list Of %String(MAXLEN = 128) [ Required ];\n"})}),"\n",(0,s.jsx)(n.p,{children:"Columns types we're predicting using"}),"\n",(0,s.jsx)(n.h3,{id:"withcolumntext",children:"WithColumnText"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property WithColumnText As list Of %String(MAXLEN = 512) [ Required ];\n"})}),"\n",(0,s.jsx)(n.p,{children:"Columns text we're predicting using, text from SQL query or with expression"}),"\n",(0,s.jsx)(n.h3,{id:"defaultidcolumnfound",children:"DefaultIDColumnFound"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property DefaultIDColumnFound As %Boolean [ InitialExpression = 0, Required ];\n"})}),"\n",(0,s.jsx)(n.p,{children:"Have we found an ID column that would otherwise be trained on by default if we did not exclude it"}),"\n",(0,s.jsx)(n.h3,{id:"timeseries",children:"TimeSeries"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property TimeSeries As %Boolean [ InitialExpression = 0, Required ];\n"})}),"\n",(0,s.jsx)(n.p,{children:"Is this a timeseries model?"}),"\n",(0,s.jsx)(n.h3,{id:"datetimecolumn",children:"DateTimeColumn"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property DateTimeColumn As %String(MAXLEN = 128);\n"})}),"\n",(0,s.jsx)(n.p,{children:"What is the datetime column for a timeseries model?"}),"\n",(0,s.jsx)(n.h3,{id:"forward",children:"Forward"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property Forward As %Integer;\n"})}),"\n",(0,s.jsx)(n.p,{children:"How far forward are we predicting? Important for validation."}),"\n",(0,s.jsx)(n.h3,{id:"timestep",children:"TimeStep"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property TimeStep As %String(MAXLEN = 128);\n"})}),"\n",(0,s.jsx)(n.p,{children:"What time step size was returned (DataRobot Exclusive)"}),"\n",(0,s.jsx)(n.h3,{id:"forwardresponse",children:"ForwardResponse"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property ForwardResponse As %String(MAXLEN = 128);\n"})}),"\n",(0,s.jsx)(n.p,{children:"What is the calculated forward window? (DataRobot Exclusive)"}),"\n",(0,s.jsx)(n.h3,{id:"defaultparameters",children:"DefaultParameters"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property DefaultParameters As array Of %String(MAXLEN = 1024);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Model parameters"}),"\n",(0,s.jsx)(n.h3,{id:"defaulttrainingquery",children:"DefaultTrainingQuery"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property DefaultTrainingQuery As %String(MAXLEN = 32000);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Default training query (SQL)"}),"\n",(0,s.jsx)(n.h3,{id:"createdat",children:"CreatedAt"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property CreatedAt As %TimeStamp [ InitialExpression = {$ZDATETIME($ZTIMESTAMP,3,1,3)}, Required ];\n"})}),"\n",(0,s.jsx)(n.p,{children:"Timestamp for when the model was created (UTC)"}),"\n",(0,s.jsx)(n.h3,{id:"defaulttrainedmodel",children:"DefaultTrainedModel"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property DefaultTrainedModel As %ML.TrainedModel;\n"})}),"\n",(0,s.jsx)(n.p,{children:"Default trained model"}),"\n",(0,s.jsx)(n.h2,{id:"triggers",children:"Triggers"}),"\n",(0,s.jsx)(n.h3,{id:"deletetrigger",children:"DeleteTrigger"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Trigger DeleteTrigger [ Event = DELETE, Foreach = row/object ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"When deleting a model, also delete any %ML.ValidationRun, %ML.ValidationMetric, %ML.TrainingRun and %ML.TrainedModel objects for this Model"}),"\n",(0,s.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(n.h3,{id:"train",children:"%Train"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %Train(data As %SQL.StatementResult, ByRef trainedmodelname As %String, ByRef trainedmodel As %ML.TrainedModel, ByRef trainingrun As %ML.TrainingRun, using As %DynamicObject = {$$$NULLOREF}, notdefault As %Boolean = 0) As %Status\n"})}),"\n",(0,s.jsx)(n.p,{children:"Index on the model name Train an ML model (synchronously)"}),"\n",(0,s.jsx)(n.h3,{id:"predict",children:"%Predict"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %Predict(rowdata As %List, ByRef result As %Double, contextitem As %RawString) As %Status\n"})}),"\n",(0,s.jsx)(n.p,{children:"Predict"}),"\n",(0,s.jsx)(n.h3,{id:"probability",children:"%Probability"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Method %Probability(rowdata As %List, ByRef result As %Double, ByRef trainedmodel As %ML.TrainedModel = "", expr As %String = 1) As %Status\n'})}),"\n",(0,s.jsx)(n.p,{children:"Probability"}),"\n",(0,s.jsx)(n.h3,{id:"predictall",children:"%PredictAll"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod %PredictAll(modelname As %String, trainedmodelname As %String = "", tfn As %Integer, argspos As %List, predpos As %List = "", probpos As %List = "", expr As %String = 1, mtorder As %List, mtunary As %List) As %Status\n'})}),"\n",(0,s.jsx)(n.p,{children:"Bulk Predict arguments: modelname - model name trainedmodelname - name of %ML.TrainedModel, might be different from the DefaultTrainedModel tfn - tempfile index argspos - Positions of the WithColumns in the temp rows, $list(column-positions) predpos - Position of the predicted value, $list(result-column-positions) probpos - Position of the probability value, $list(result-column-positions) expr - expression for probability returns: $$$OK on success, otherwise a $$$ERROR(...)"}),"\n",(0,s.jsx)(n.h3,{id:"validate",children:"%Validate"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Method %Validate(trainedModel As %ML.TrainedModel = "", ByRef query As %String = "", ByRef validationRunName As %String = "", using As %DynamicObject = {$$$NULLOREF}) [ Internal ]\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," Do not call this method directly. Please refer to the SQL syntax as documented in %ML.Model"]}),"\n",(0,s.jsx)(n.p,{children:"This is the entry point for the"}),"\n",(0,s.jsx)(n.p,{children:"VALIDATE MODEL"}),"\n",(0,s.jsx)(n.p,{children:"command. After setting up a %ML.ValidationRun instance, this method will hand off to helper methods in %ML.TrainedModel specific to the model's type (e.g. classification or regression)."}),"\n",(0,s.jsx)(n.h3,{id:"purge",children:"%Purge"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %Purge(days = 0) As %Status\n"})}),"\n",(0,s.jsx)(n.p,{children:"Purge all trained models"})]})}function c(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>a});var s=i(96540);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);