"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[57502],{57627:(e,s,t)=>{t.r(s),t.d(s,{contentTitle:()=>l,default:()=>c,frontMatter:()=>i,toc:()=>a});var n=t(74848),r=t(28453);const i={pagination_prev:null,pagination_next:null},l="%iKnow.Source.SQL.Lister",a=[{value:"Methods",id:"methods",level:2},{value:"ExpandList",id:"expandlist",level:3},{value:"SplitFullRef",id:"splitfullref",level:3},{value:"BuildFullRef",id:"buildfullref",level:3},{value:"GetAlias",id:"getalias",level:3},{value:"DefaultProcessor",id:"defaultprocessor",level:3},{value:"FormatParams",id:"formatparams",level:3},{value:"TestParams",id:"testparams",level:3}];function o(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"iknowsourcesqllister",children:"%iKnow.Source.SQL.Lister"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Class %iKnow.Source.SQL.Lister Extends %iKnow.Source.Lister [ Deprecated, System = 4 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Lister implementation for retrieving sources corresponding to records in a query result."}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Lister Parameters"})," to be supplied to AddListToBatch and ProcessList calls:"]}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"query"})," As %String - the query to fetch the data from, wherein each returned row corresponds to an individual source to be indexed."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"idField"})," As %String - the column retrieved by the query that contains the identifier we can use as the LocalReference for the source to be stored. Values for this column should not contain colon characters."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"groupField"})," As %String - the column retrieved by the query that contains the group name to use as for the source to be stored."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"dataFields"})," As %List - the columns retrieved by the query that contain the data to be indexed (currently %String only)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"metaFields"})," As %List - the columns retrieved by the query that contain the metadata attributes to set for this source."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"metaKeys"})," As %List - the metadata field names, corresponding to the entries in metaFields (if left blank, we assume the column names correspond to the metadata field names)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"multiDataFieldMode"})," As %Integer - 0 = concatenate dataFields (default), 1 = store as separate sources (colon+dataField pos is postfixed to idField value)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"concatSeparator"}),' As %String - separator to use for concatenating multiple fields (default " ").']}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"External ID structure:"})," [GroupName]:[LocalRef]"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"GroupName = either retrieved as a column in the query results or, if none specified, the full query string."}),"\n",(0,n.jsx)(s.li,{children:"LocalRef = a unique (within the group) identifier retrieved as one of the query result columns. This should not contain colon characters!"}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Lister alias:"}),' "SQL"']}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Default Processor:"})," %iKnow.Source.Temp.Processor"]}),"\n",(0,n.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(s.h3,{id:"expandlist",children:"ExpandList"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method ExpandList(listparams As %List) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"Triggers the query and loops through the results, listing each row as a separate source (exception: when multiDataFieldMode = 1). Metadata is retrieved and stored as specified by the metaFields and metaKeys parameters."}),"\n",(0,n.jsx)(s.p,{children:"In the current implementation, the data columns are also fetched and stored locally using StoreTemp."}),"\n",(0,n.jsx)(s.h3,{id:"splitfullref",children:"SplitFullRef"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SplitFullRef(domainId As %Integer, fullRef As %String, Output groupName As %String, Output localRef As %String) As %Status [ Private ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Splits the full reference in group name and ID by finding the last colon, which by definition should separate the local reference (which cannot contain colons) from the group name."}),"\n",(0,n.jsx)(s.p,{children:"See also SplitFullRef in %iKnow.Source.Lister."}),"\n",(0,n.jsx)(s.h3,{id:"buildfullref",children:"BuildFullRef"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod BuildFullRef(domainId As %Integer, groupName As %String, localRef As %String) As %String [ Private ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Builds the full reference by appending the local reference to the group name, adding a colon as a separator in between."}),"\n",(0,n.jsx)(s.p,{children:"See also BuildFullRef in %iKnow.Source.Lister."}),"\n",(0,n.jsx)(s.h3,{id:"getalias",children:"GetAlias"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetAlias() As %String\n"})}),"\n",(0,n.jsx)(s.p,{children:'Lister alias: "SQL"'}),"\n",(0,n.jsx)(s.h3,{id:"defaultprocessor",children:"DefaultProcessor"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DefaultProcessor() As %String\n"})}),"\n",(0,n.jsx)(s.p,{children:"Default Processor: %iKnow.Source.Temp.Processor"}),"\n",(0,n.jsx)(s.h3,{id:"formatparams",children:"FormatParams"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod FormatParams(listerParams As %List) As %String\n"})}),"\n",(0,n.jsx)(s.h3,{id:"testparams",children:"TestParams"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method TestParams(listerParams...) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"Tests performed by this Lister:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsx)(s.li,{children:"query: checks whether this is a valid SQL statement (type SELECT or CALL)"}),"\n",(0,n.jsx)(s.li,{children:"idField: checks whether this is a valid column, returned by the above query"}),"\n",(0,n.jsx)(s.li,{children:"groupField: checks whether this is a valid column, returned by the above query"}),"\n",(0,n.jsx)(s.li,{children:"dataFields: checks whether these are valid columns, returned by the above query"}),"\n",(0,n.jsx)(s.li,{children:"metaFields: checks whether these are valid columns, returned by the above query"}),"\n",(0,n.jsx)(s.li,{children:"metaKeys: checks whether these are existing metadata fields"}),"\n",(0,n.jsx)(s.li,{children:"multiDataFieldMode: no checks"}),"\n",(0,n.jsx)(s.li,{children:"concatSeparator: no checks"}),"\n"]})]})}function c(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>l,x:()=>a});var n=t(96540);const r={},i=n.createContext(r);function l(e){const s=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);