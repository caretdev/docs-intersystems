"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[82154],{12366:(e,s,t)=>{t.r(s),t.d(s,{contentTitle:()=>l,default:()=>o,frontMatter:()=>r,toc:()=>i});var n=t(74848),a=t(28453);const r={pagination_prev:null,pagination_next:null},l="%Net.POP3",i=[{value:"Properties",id:"properties",level:2},{value:"port",id:"port",level:3},{value:"timeout",id:"timeout",level:3},{value:"SSLConfiguration",id:"sslconfiguration",level:3},{value:"UseSTARTTLS",id:"usestarttls",level:3},{value:"IgnoreInvalidBase64Chars",id:"ignoreinvalidbase64chars",level:3},{value:"SSLCheckServerIdentity",id:"sslcheckserveridentity",level:3},{value:"dev",id:"dev",level:3},{value:"Branch",id:"branch",level:3},{value:"Methods",id:"methods",level:2},{value:"portGet",id:"portget",level:3},{value:"%OnClose",id:"onclose",level:3},{value:"Connect",id:"connect",level:3},{value:"ConnectPort",id:"connectport",level:3},{value:"GetMailBoxStatus",id:"getmailboxstatus",level:3},{value:"GetSizeOfMessages",id:"getsizeofmessages",level:3},{value:"GetMessageUIDArray",id:"getmessageuidarray",level:3},{value:"GetMessageUID",id:"getmessageuid",level:3},{value:"Fetch",id:"fetch",level:3},{value:"FetchFromStream",id:"fetchfromstream",level:3},{value:"FetchMessage",id:"fetchmessage",level:3},{value:"GetMailMessage",id:"getmailmessage",level:3},{value:"GetAttachedEmail",id:"getattachedemail",level:3},{value:"WalkParts",id:"walkparts",level:3},{value:"FetchMessageInfo",id:"fetchmessageinfo",level:3},{value:"GetHeadersAndBody",id:"getheadersandbody",level:3},{value:"FetchMessageHeaders",id:"fetchmessageheaders",level:3},{value:"GetHeadersArray",id:"getheadersarray",level:3},{value:"DeleteMessage",id:"deletemessage",level:3},{value:"RollbackDeletes",id:"rollbackdeletes",level:3},{value:"QuitAndCommit",id:"quitandcommit",level:3},{value:"QuitAndRollback",id:"quitandrollback",level:3},{value:"Ping",id:"ping",level:3},{value:"SetDestList",id:"setdestlist",level:3},{value:"BeginsWithSpace",id:"beginswithspace",level:3},{value:"MailError",id:"mailerror",level:3}];function c(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"netpop3",children:"%Net.POP3"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Class %Net.POP3 Extends %Net.FetchMailProtocol [ System = 3 ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"For information on using this class"}),", see ",(0,n.jsx)(s.a,{href:"/csp/docbook/DocBook.UI.Page.cls?FIND=CLASSES+%25Net.POP3",children:"Sending and Receiving Email"}),"."]}),"\n",(0,n.jsx)(s.p,{children:"Implements %Net.FetchMailProtocol"}),"\n",(0,n.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,n.jsx)(s.h3,{id:"port",children:"port"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property port As %Integer;\n"})}),"\n",(0,n.jsx)(s.p,{children:"The port of the POP3 server, the default is 110 for plain text and 995 for SSL."}),"\n",(0,n.jsx)(s.h3,{id:"timeout",children:"timeout"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property timeout As %Integer [ InitialExpression = 30 ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"The read timeout in seconds to use when communicating with the POP3 server"}),"\n",(0,n.jsx)(s.h3,{id:"sslconfiguration",children:"SSLConfiguration"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property SSLConfiguration As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"The name of the activated TLS/SSL configuration to use for pop3s requests."}),"\n",(0,n.jsx)(s.h3,{id:"usestarttls",children:"UseSTARTTLS"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property UseSTARTTLS As %Boolean;\n"})}),"\n",(0,n.jsx)(s.p,{children:"If true then the STARTTLS extension to POP3 (RFC 2595) should be used to authenticate to the POP3 server on the normal POP3 port. The SSLConfiguration must be specified."}),"\n",(0,n.jsx)(s.h3,{id:"ignoreinvalidbase64chars",children:"IgnoreInvalidBase64Chars"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property IgnoreInvalidBase64Chars As %Boolean [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"If IgnoreInvalidBase64Chars is true, then unexpected characters will be ignored during base64 decoding. RFC 2045 is ambiguous about whether unexpected characters should be ignored or result in an error during base64 decoding. The default is false."}),"\n",(0,n.jsx)(s.h3,{id:"sslcheckserveridentity",children:"SSLCheckServerIdentity"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property SSLCheckServerIdentity As %Boolean [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"When making an SSL connection check the server identity in the server certificate matches the name of the system we are connecting to. This defaults to being on and matches based on the rules layed out in section 3.1 of RFC 2818."}),"\n",(0,n.jsx)(s.h3,{id:"dev",children:"dev"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property dev As %String [ Internal ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"TCP device actually used for communicating with the POP3 server."}),"\n",(0,n.jsx)(s.h3,{id:"branch",children:"Branch"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property Branch As %Integer [ Internal, Private ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Branch of the temp global that stores the message."}),"\n",(0,n.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(s.h3,{id:"portget",children:"portGet"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method portGet() As %Integer [ CodeMode = expression, Internal ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Default port is 110 for plain text and 995 for SSL."}),"\n",(0,n.jsx)(s.h3,{id:"onclose",children:"%OnClose"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method %OnClose() As %Status [ ProcedureBlock = 1, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Cleanup the temp global used to store the message."}),"\n",(0,n.jsx)(s.h3,{id:"connect",children:"Connect"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'Method Connect(PopServer As %String, UserName As %String, Password As %String = "", AccessToken As %String = "") As %Status [ CodeMode = expression ]\n'})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol Connect"}),"\n",(0,n.jsx)(s.h3,{id:"connectport",children:"ConnectPort"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'Method ConnectPort(PopServer As %String, PopPort As %Integer = 110, UserName As %String, Password As %String, AccessToken As %String = "") As %Status\n'})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol Connect"}),"\n",(0,n.jsx)(s.h3,{id:"getmailboxstatus",children:"GetMailBoxStatus"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method GetMailBoxStatus(ByRef NumberOfMessages As %Integer, ByRef NumberOfBytes As %Integer) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol GetMailBoxStatus"}),"\n",(0,n.jsx)(s.h3,{id:"getsizeofmessages",children:"GetSizeOfMessages"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'Method GetSizeOfMessages(MessageNumber As %String = "", ByRef ListOfSizes As %ArrayOfDataTypes) As %Status\n'})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol GetSizeOfMessages"}),"\n",(0,n.jsx)(s.h3,{id:"getmessageuidarray",children:"GetMessageUIDArray"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'Method GetMessageUIDArray(MessageNumber As %String = "", ByRef ListOfUniqueIDs As %ArrayOfDataTypes) As %Status\n'})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol GetMessageUIDArray"}),"\n",(0,n.jsx)(s.h3,{id:"getmessageuid",children:"GetMessageUID"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method GetMessageUID(MessageNumber As %Integer, ByRef UniqueID As %String) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol GetMessageUID"}),"\n",(0,n.jsx)(s.h3,{id:"fetch",children:"Fetch"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method Fetch(MessageNumber As %Integer, ByRef MailMsg As %Net.MailMessage, Delete As %Boolean = 0, messageStream As %BinaryStream) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol Fetch"}),"\n",(0,n.jsx)(s.h3,{id:"fetchfromstream",children:"FetchFromStream"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method FetchFromStream(messageStream As %BinaryStream, ByRef MailMsg As %Net.MailMessage) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol FetchFromStream"}),"\n",(0,n.jsx)(s.h3,{id:"fetchmessage",children:"FetchMessage"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method FetchMessage(MessageNumber As %Integer, ByRef From As %String, ByRef To As %String, ByRef Date As %String, ByRef Subject As %String, ByRef MessageSize As %Integer, ByRef MsgHeaders As %ArrayOfDataTypes, ByRef MailMsg As %Net.MailMessage, Delete As %Boolean = 0) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol FetchMessage"}),"\n",(0,n.jsx)(s.h3,{id:"getmailmessage",children:"GetMailMessage"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method GetMailMessage(glv As %String, part As %Integer, Output mailmsg As %Net.MailMessage) As %Status [ Internal, Private, ProcedureBlock = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Convert a part that represents an email message to %Net.MailMessage object"}),"\n",(0,n.jsx)(s.h3,{id:"getattachedemail",children:"GetAttachedEmail"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method GetAttachedEmail(msgpart As %Net.MailMessagePart, Output mailmsg As %Net.MailMessage) As %Status [ ProcedureBlock = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Convert the text of an attached email (Content-Type: message/rfc822) to a %Net.mailMessage."}),"\n",(0,n.jsx)(s.h3,{id:"walkparts",children:"WalkParts"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method WalkParts(glv As %String, part As %Integer, msgpart As %Net.MailMessagePart) [ Internal, Private ]\n"})}),"\n",(0,n.jsx)(s.h3,{id:"fetchmessageinfo",children:"FetchMessageInfo"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method FetchMessageInfo(MessageNumber As %Integer, Lines As %Integer, ByRef From As %String, ByRef To As %String, ByRef Date As %String, ByRef Subject As %String, ByRef MessageSize As %Integer, ByRef MsgHeaders As %ArrayOfDataTypes, ByRef MessageText As %String) As %Status\n"})}),"\n",(0,n.jsx)(s.h3,{id:"getheadersandbody",children:"GetHeadersAndBody"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method GetHeadersAndBody(ByRef From As %String, ByRef To As %String, ByRef Date As %String, ByRef Subject As %String, ByRef MsgHeaders As %ArrayOfDataTypes, MessageText As %String) As %Status [ Internal, Private ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Assumes current device is TCP socket to POP3 server."}),"\n",(0,n.jsx)(s.h3,{id:"fetchmessageheaders",children:"FetchMessageHeaders"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method FetchMessageHeaders(MessageNumber As %Integer, ByRef MsgHeadersArray As %String) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol FetchMessageHeaders"}),"\n",(0,n.jsx)(s.h3,{id:"getheadersarray",children:"GetHeadersArray"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method GetHeadersArray(Output MsgHeadersArray As %String) As %Status [ Internal ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Assumes current device is TCP socket to POP3 server."}),"\n",(0,n.jsx)(s.h3,{id:"deletemessage",children:"DeleteMessage"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method DeleteMessage(MessageNumber As %Integer) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol DeleteMessage"}),"\n",(0,n.jsx)(s.h3,{id:"rollbackdeletes",children:"RollbackDeletes"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method RollbackDeletes() As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol RollbackDeletes"}),"\n",(0,n.jsx)(s.h3,{id:"quitandcommit",children:"QuitAndCommit"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method QuitAndCommit() As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol QuitAndCommit"}),"\n",(0,n.jsx)(s.h3,{id:"quitandrollback",children:"QuitAndRollback"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method QuitAndRollback() As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol QuitAndRollback"}),"\n",(0,n.jsx)(s.h3,{id:"ping",children:"Ping"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method Ping() As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"see %Net.FetchMailProtocol Ping"}),"\n",(0,n.jsx)(s.h3,{id:"setdestlist",children:"SetDestList"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method SetDestList(destlist As %ListOfDataTypes, dests As %String) [ Internal, Private ]\n"})}),"\n",(0,n.jsx)(s.h3,{id:"beginswithspace",children:"BeginsWithSpace"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod BeginsWithSpace(x As %String) As %Integer [ Internal, Private ]\n"})}),"\n",(0,n.jsx)(s.h3,{id:"mailerror",children:"MailError"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod MailError(line As %String) As %String [ Internal, Private ]\n"})})]})}function o(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>l,x:()=>i});var n=t(96540);const a={},r=n.createContext(a);function l(e){const s=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);