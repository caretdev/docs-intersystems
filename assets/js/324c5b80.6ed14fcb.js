"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[63858],{11594:(e,n,r)=>{r.r(n),r.d(n,{contentTitle:()=>c,default:()=>d,frontMatter:()=>s,toc:()=>a});var i=r(74848),t=r(28453);const s={pagination_prev:null,pagination_next:null},c="%XML.Security.EncryptedKey",a=[{value:"Parameters",id:"parameters",level:2},{value:"XMLFORMAT",id:"xmlformat",level:3},{value:"NAMESPACE",id:"namespace",level:3},{value:"ELEMENTQUALIFIED",id:"elementqualified",level:3},{value:"Properties",id:"properties",level:2},{value:"CipherData",id:"cipherdata",level:3},{value:"EncryptionProperties",id:"encryptionproperties",level:3},{value:"ReferenceList",id:"referencelist",level:3},{value:"CarriedKeyName",id:"carriedkeyname",level:3},{value:"Recipient",id:"recipient",level:3},{value:"UsedAsSigningKey",id:"usedassigningkey",level:3},{value:"UsedAsEncryptionKey",id:"usedasencryptionkey",level:3},{value:"EncryptionOptions",id:"encryptionoptions",level:3},{value:"EncryptionAlgorithm",id:"encryptionalgorithm",level:3},{value:"Methods",id:"methods",level:2},{value:"EncryptionAlgorithmGet",id:"encryptionalgorithmget",level:3},{value:"CreateX509",id:"createx509",level:3},{value:"GetEncryptedKeySHA1",id:"getencryptedkeysha1",level:3},{value:"Initialize",id:"initialize",level:3},{value:"InitializeForService",id:"initializeforservice",level:3},{value:"EncryptKey",id:"encryptkey",level:3},{value:"AddReference",id:"addreference",level:3},{value:"Perform",id:"perform",level:3},{value:"Reset",id:"reset",level:3},{value:"ValidateKey",id:"validatekey",level:3},{value:"ValidateTokenRef",id:"validatetokenref",level:3},{value:"ValidateElement",id:"validateelement",level:3},{value:"Equals",id:"equals",level:3}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"xmlsecurityencryptedkey",children:"%XML.Security.EncryptedKey"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Class %XML.Security.EncryptedKey Extends (%XML.Security.KeyInfoClause, %XML.Security.EncryptedType) [ System = 4 ]\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"For details on using this class"}),", see ",(0,i.jsx)(n.a,{href:"/csp/docbook/Doc.View.cls?FIND=CLASSES+%25XML.Security.EncryptedKey+xml",children:"Encrypting XML Documents"}),". and ",(0,i.jsx)(n.a,{href:"/csp/docbook/Doc.View.cls?FIND=CLASSES+%25XML.Security.EncryptedKey+soap",children:"Encrypting SOAP Security Headers"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"XML Encryption element."}),"\n",(0,i.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsx)(n.h3,{id:"xmlformat",children:"XMLFORMAT"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:'Parameter XMLFORMAT = "literal";\n'})}),"\n",(0,i.jsx)(n.h3,{id:"namespace",children:"NAMESPACE"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:'Parameter NAMESPACE = "http://www.w3.org/2001/04/xmlenc#";\n'})}),"\n",(0,i.jsx)(n.h3,{id:"elementqualified",children:"ELEMENTQUALIFIED"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Parameter ELEMENTQUALIFIED = 1;\n"})}),"\n",(0,i.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,i.jsx)(n.h3,{id:"cipherdata",children:"CipherData"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Property CipherData As %XML.Security.CipherData(XMLREF = 1) [ Required ];\n"})}),"\n",(0,i.jsx)(n.h3,{id:"encryptionproperties",children:"EncryptionProperties"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Property EncryptionProperties As %XML.Security.EncryptionProperties(XMLREF = 1);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"referencelist",children:"ReferenceList"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Property ReferenceList As %XML.Security.ReferenceList(XMLREF = 1);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"carriedkeyname",children:"CarriedKeyName"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:'Property CarriedKeyName As %String(MAXLEN = "");\n'})}),"\n",(0,i.jsx)(n.h3,{id:"recipient",children:"Recipient"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:'Property Recipient As %String(MAXLEN = "", XMLPROJECTION = "attribute");\n'})}),"\n",(0,i.jsx)(n.h3,{id:"usedassigningkey",children:"UsedAsSigningKey"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:'Property UsedAsSigningKey As %Boolean(XMLPROJECTION = "none");\n'})}),"\n",(0,i.jsx)(n.p,{children:"UsedAsSigningKey is true if this EncryptedKey element was used for signing"}),"\n",(0,i.jsx)(n.h3,{id:"usedasencryptionkey",children:"UsedAsEncryptionKey"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:'Property UsedAsEncryptionKey As %Boolean(XMLPROJECTION = "none");\n'})}),"\n",(0,i.jsx)(n.p,{children:"UsedAsEncryptionKey is true if this EncryptedKey element was used for encryption"}),"\n",(0,i.jsx)(n.h3,{id:"encryptionoptions",children:"EncryptionOptions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:'Property EncryptionOptions As %Integer(XMLPROJECTION = "none");\n'})}),"\n",(0,i.jsx)(n.p,{children:"EncryptionOptions specifies which parts of the message are to be signed. See %soap.inc definitions of $$$SOAPWSEncrypt.... for possibilities."}),"\n",(0,i.jsx)(n.h3,{id:"encryptionalgorithm",children:"EncryptionAlgorithm"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:'Property EncryptionAlgorithm As %String(XMLPROJECTION = "none") [ Calculated, Internal ];\n'})}),"\n",(0,i.jsx)(n.p,{children:"The algorithm used for encryption"}),"\n",(0,i.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,i.jsx)(n.h3,{id:"encryptionalgorithmget",children:"EncryptionAlgorithmGet"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method EncryptionAlgorithmGet() As %String [ CodeMode = expression, Internal ]\n"})}),"\n",(0,i.jsx)(n.h3,{id:"createx509",children:"CreateX509"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod CreateX509(credentials As %SYS.X509Credentials = "", encryptionOptions As %Integer, referenceOption As %Integer, Output status As %Status) As %XML.Security.EncryptedKey\n'})}),"\n",(0,i.jsx)(n.p,{children:"Create an EncryptedKey element that is to carry a symmetric key which is encrypted using an X.509 certificate's public key."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The certificate is specified in the token argument by a %SYS.X509Credentials instance containing the certificate or a BinarySecurityToken containing the X509 certificate."}),"\n",(0,i.jsx)(n.li,{children:"The encryptionOptions argument specifies the parts of the SOAP message to be encrypted. The default is to encrypt the body - $$$SOAPWSEncryptSoapBody. $$$SOAPWSEncryptNoBody means body will not be encrypted, but other parts added using AddReference method. $$$SOAPWSEncryptNone means there will be no ReferenceList in the EncryptedKey element. See %soap.inc definitions of $$$SOAPWSEncrypt.... for possibilities."}),"\n",(0,i.jsx)(n.li,{children:"The referenceOption argument specifies the type of reference to create. See %soap.inc definitions of $$$SOAPWSReference.... The default is to use the Thumbprint if the first argument is a %SYS.X509Credentials instance."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"getencryptedkeysha1",children:"GetEncryptedKeySHA1"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetEncryptedKeySHA1() As %Binary\n"})}),"\n",(0,i.jsx)(n.p,{children:"Get EncryptedKeySHA1 format of this EncryptedKey element. Get EncryptedKeySHA1 format of this EncryptedKey element."}),"\n",(0,i.jsx)(n.h3,{id:"initialize",children:"Initialize"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method Initialize() As %Status\n"})}),"\n",(0,i.jsx)(n.p,{children:"Initialize an EncryptedKey element that is intended for creating EncryptedKey elements which will not be in the Security header. EncryptionMethod, and Algorithm or KeySize are expected to be set or defaulted."}),"\n",(0,i.jsx)(n.h3,{id:"initializeforservice",children:"InitializeForService"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method InitializeForService(service As %SOAP.WebBase, header As %SOAP.Security.Header) As %Status [ Internal ]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Initialize"}),"\n",(0,i.jsx)(n.h3,{id:"encryptkey",children:"EncryptKey"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method EncryptKey() As %Status [ Internal ]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Encrypt the symmetric key"}),"\n",(0,i.jsx)(n.h3,{id:"addreference",children:"AddReference"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method AddReference(reference As %XML.Security.DataReference, doNotReuse As %Boolean = 0)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Add a reference to XML element using a %XML.Security.DataReference. The reference may be created by using the ##class(%XML.Security.Reference).Create method. If doNotReuse is true, then this reference will be removed during Reset"}),"\n",(0,i.jsx)(n.h3,{id:"perform",children:"Perform"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method Perform(messageStream As %BinaryStream, header As %SOAP.Security.Header) As %Status [ Internal ]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Perform encryption"}),"\n",(0,i.jsx)(n.h3,{id:"reset",children:"Reset"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method Reset()\n"})}),"\n",(0,i.jsx)(n.p,{children:"Reset the element."}),"\n",(0,i.jsx)(n.h3,{id:"validatekey",children:"ValidateKey"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method ValidateKey(service As %SOAP.WebBase) As %String [ Internal ]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Validate the key decryption. If invalid return an error code."}),"\n",(0,i.jsx)(n.h3,{id:"validatetokenref",children:"ValidateTokenRef"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method ValidateTokenRef(service As %SOAP.WebBase, ByRef tokenType As %String, Output credentials As %RawString) As %String [ Internal ]\n"})}),"\n",(0,i.jsx)(n.p,{children:'Validate this input EncryptedKey used as a KeyInfo clause. If valid, set credentials and tokenType and return "". credentials is this EncryptedKey element'}),"\n",(0,i.jsx)(n.h3,{id:"validateelement",children:"ValidateElement"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:'Method ValidateElement(ByRef document As %XML.Document, service As %SOAP.WebBase, mimeAttachments As %Net.MIMEPart = "") As %String [ Internal ]\n'})}),"\n",(0,i.jsx)(n.p,{children:"Validate the security header element. If invalid return an error code."}),"\n",(0,i.jsx)(n.h3,{id:"equals",children:"Equals"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-objectscript-class",children:"Method Equals(credentials As %XML.Security.EncryptedKey) As %Boolean\n"})}),"\n",(0,i.jsx)(n.p,{children:"Return true if the same Key."})]})}function d(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>a});var i=r(96540);const t={},s=i.createContext(t);function c(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);