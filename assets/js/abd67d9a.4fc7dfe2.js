"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[75811],{79101:(e,t,s)=>{s.r(t),s.d(t,{contentTitle:()=>l,default:()=>c,frontMatter:()=>o,toc:()=>a});var n=s(74848),r=s(28453);const o={pagination_prev:null,pagination_next:null},l="%Atelier.SourceControl",a=[{value:"Parameters",id:"parameters",level:2},{value:"PREFIX",id:"prefix",level:3},{value:"Methods",id:"methods",level:2},{value:"CheckIn",id:"checkin",level:3},{value:"CheckOut",id:"checkout",level:3},{value:"UndoCheckout",id:"undocheckout",level:3},{value:"AddToSourceControl",id:"addtosourcecontrol",level:3},{value:"RemoveFromSourceControl",id:"removefromsourcecontrol",level:3},{value:"GetLatest",id:"getlatest",level:3},{value:"OnBeforeSave",id:"onbeforesave",level:3},{value:"OnAfterAllClassCompile",id:"onafterallclasscompile",level:3},{value:"OnAfterClassCompile",id:"onafterclasscompile",level:3},{value:"OnAfterCompile",id:"onaftercompile",level:3},{value:"OnAfterDelete",id:"onafterdelete",level:3},{value:"OnAfterLoad",id:"onafterload",level:3},{value:"OnAfterSave",id:"onaftersave",level:3},{value:"OnAfterStorage",id:"onafterstorage",level:3},{value:"OnBeforeAllClassCompile",id:"onbeforeallclasscompile",level:3},{value:"OnBeforeClassCompile",id:"onbeforeclasscompile",level:3},{value:"OnBeforeCompile",id:"onbeforecompile",level:3},{value:"OnBeforeDelete",id:"onbeforedelete",level:3},{value:"OnBeforeLoad",id:"onbeforeload",level:3},{value:"OnBeforeTimestamp",id:"onbeforetimestamp",level:3},{value:"OnMenuItem",id:"onmenuitem",level:3},{value:"OnPortalCreate",id:"onportalcreate",level:3}];function i(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"ateliersourcecontrol",children:"%Atelier.SourceControl"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Class %Atelier.SourceControl Extends %Studio.SourceControl.Base\n"})}),"\n",(0,n.jsxs)(t.p,{children:["This class is intended to demonstrate that source control hooks are called on the server when corresponding actions are peformed in Atelier. Enabling this class in the managment portal will write diagnostic information to the Atelier console during events, such as save, compile, etc. Note that the methods in section ",(0,n.jsx)(t.strong,{children:"'Menu Items'"})," here are included for completeness, in reality only those methods in the section marked ",(0,n.jsx)(t.strong,{children:"'Events'"})," will be called."]}),"\n",(0,n.jsx)(t.p,{children:"Users wishing to take advantage of server side source control hooks with Atelier should subclass %Studio.SourceControl.Base directly."}),"\n",(0,n.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsx)(t.h3,{id:"prefix",children:"PREFIX"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter PREFIX = "*** Atelier Source Control Hook *** ";\n'})}),"\n",(0,n.jsx)(t.p,{children:"This aids in identifying the hook output amongst other console output"}),"\n",(0,n.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(t.h3,{id:"checkin",children:"CheckIn"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method CheckIn(InternalName As %String, Description As %String = "") As %Status\n'})}),"\n",(0,n.jsx)(t.p,{children:"Check this routine/class/csp file into source control."}),"\n",(0,n.jsx)(t.h3,{id:"checkout",children:"CheckOut"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method CheckOut(InternalName As %String, Description As %String = "") As %Status\n'})}),"\n",(0,n.jsx)(t.p,{children:"Check this routine/class/csp file out of source control."}),"\n",(0,n.jsx)(t.h3,{id:"undocheckout",children:"UndoCheckout"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method UndoCheckout(InternalName As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Undo the checkout of this item."}),"\n",(0,n.jsx)(t.h3,{id:"addtosourcecontrol",children:"AddToSourceControl"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method AddToSourceControl(InternalName As %String, Description As %String = "") As %Status\n'})}),"\n",(0,n.jsx)(t.p,{children:"Called to add this item to source control"}),"\n",(0,n.jsx)(t.h3,{id:"removefromsourcecontrol",children:"RemoveFromSourceControl"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method RemoveFromSourceControl(InternalName As %String, Description As %String = "") As %Status\n'})}),"\n",(0,n.jsx)(t.p,{children:"Called to delete this item from source control"}),"\n",(0,n.jsx)(t.h3,{id:"getlatest",children:"GetLatest"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetLatest(InternalName As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Get the latest version of this file from source control."}),"\n",(0,n.jsx)(t.h3,{id:"onbeforesave",children:"OnBeforeSave"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method OnBeforeSave(InternalName As %String, Location As %String = "", Object As %RegisteredObject = {$$$NULLOREF}) As %Status\n'})}),"\n",(0,n.jsx)(t.p,{children:"Called before the item is saved to the database it is passed a reference to the current temporary storage of this item so that it can be modified before the save completes. If you quit with an error value then it will abort the save."}),"\n",(0,n.jsx)(t.h3,{id:"onafterallclasscompile",children:"OnAfterAllClassCompile"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod OnAfterAllClassCompile(List As %String, Level As %Integer, ByRef qstruct As %String, Status As %Status) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Called in the activated source control class after we have compiled all the classes but before we exit. Note that this is a class method and it does not require the source control class to be instanciated in order for it to be called. By default it will call the OnAfterClassCompile if there is a source control class instanciated, but you can override this to do whatever you require. List is a subscripted array of items that were compiled. Status is the current compile return error %Status, so the callback can check if there was any error in compiling the list of classes."}),"\n",(0,n.jsx)(t.h3,{id:"onafterclasscompile",children:"OnAfterClassCompile"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnAfterClassCompile(List As %String, Level As %Integer, ByRef qstruct As %String, Status As %Status) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Called in the class compiler after we have compiled all the classes before we exit List is a subscripted array of items that were compiled. Status is the current compile return error %Status, so the callback can check if there was any error in compiling the list of classes."}),"\n",(0,n.jsx)(t.h3,{id:"onaftercompile",children:"OnAfterCompile"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnAfterCompile(InternalName As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Called after the compile of the item is done."}),"\n",(0,n.jsx)(t.h3,{id:"onafterdelete",children:"OnAfterDelete"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnAfterDelete(InternalName As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Called after an item is deleted."}),"\n",(0,n.jsx)(t.h3,{id:"onafterload",children:"OnAfterLoad"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnAfterLoad(InternalName As %String, Object As %RegisteredObject = {$$$NULLOREF}) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"This is called after the item is loaded but before it is sent to Studio so you have a chance to modify this copy before it appears in the editor. It is passed a reference to the object that represents this item so it can be modified before Studio reads this information."}),"\n",(0,n.jsx)(t.h3,{id:"onaftersave",children:"OnAfterSave"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnAfterSave(InternalName As %String, Object As %RegisteredObject = {$$$NULLOREF}) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"This is called after the item has been saved to the database. It may be passed a reference to the object representing the item just saved. It can be use to export this documement to an external form for example."}),"\n",(0,n.jsx)(t.h3,{id:"onafterstorage",children:"OnAfterStorage"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method OnAfterStorage(InternalName As %String, Location As %String = "") As %Status\n'})}),"\n",(0,n.jsx)(t.p,{children:"This is called if you compile a class and the compilation updates the classes storage. It is called after the storage has been updated so you can determine how to deal with this change in the class. The Location is the global reference to the class definition that was changed."}),"\n",(0,n.jsx)(t.h3,{id:"onbeforeallclasscompile",children:"OnBeforeAllClassCompile"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod OnBeforeAllClassCompile(List As %String, Level As %Integer, ByRef qstruct As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Called in the activated source control class before starting a compile after we have resolved the list of classes but before we have started the compile itself. Note that this is a class method and it does not require the source control class to be instanciated in order for it to be called. By default it will call the OnBeforeClassCompile if there is a source control class instanciated, but you can override this to do whatever you require. Returning an error here will abort the compile. List is a subscripted array of items that will be compiled."}),"\n",(0,n.jsx)(t.h3,{id:"onbeforeclasscompile",children:"OnBeforeClassCompile"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnBeforeClassCompile(List As %String, Level As %Integer, ByRef qstruct As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Called in the class compiler after we have resolved the list of classes to be compiled but before we have started the compile itself. List is a subscripted array of items that will be compiled."}),"\n",(0,n.jsx)(t.h3,{id:"onbeforecompile",children:"OnBeforeCompile"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnBeforeCompile(InternalName As %String, ByRef qstruct As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Called before the compile of the item is done. It is passed a qstruct which can be inspected and modified."}),"\n",(0,n.jsx)(t.h3,{id:"onbeforedelete",children:"OnBeforeDelete"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnBeforeDelete(InternalName As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Called before an item is deleted. Returning an error code prevents the delete from occurring."}),"\n",(0,n.jsx)(t.h3,{id:"onbeforeload",children:"OnBeforeLoad"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnBeforeLoad(InternalName As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"This is called before the actual load of data to give the chance to load the item from an external format."}),"\n",(0,n.jsx)(t.h3,{id:"onbeforetimestamp",children:"OnBeforeTimestamp"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnBeforeTimestamp(InternalName As %String)\n"})}),"\n",(0,n.jsx)(t.p,{children:"Called before Studio checks for the timestamp of an item."}),"\n",(0,n.jsx)(t.h3,{id:"onmenuitem",children:"OnMenuItem"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OnMenuItem(MenuName As %String, InternalName As %String, SelectedText As %String, ByRef Enabled As %Boolean, ByRef DisplayName As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.h3,{id:"onportalcreate",children:"OnPortalCreate"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method OnPortalCreate(pUserData As %ZEN.proxyObject = "") As %Status [ CodeMode = objectgenerator ]\n'})}),"\n",(0,n.jsx)(t.p,{children:"Callback invoked when the portal-based Source Control hooks instantiate the source control class. Operations that occur in this callback should be lightweight as the source control class needs to be instantiated afresh every time a source control action is performed."})]})}function c(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(i,{...e})}):i(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>l,x:()=>a});var n=s(96540);const r={},o=n.createContext(r);function l(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);