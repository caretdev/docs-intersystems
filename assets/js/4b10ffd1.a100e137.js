"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[54823],{62438:(e,t,r)=>{r.r(t),r.d(t,{contentTitle:()=>l,default:()=>c,frontMatter:()=>o,toc:()=>a});var n=r(74848),s=r(28453);const o={pagination_prev:null,pagination_next:null},l="%Library.SQLExportMgr",a=[{value:"Parameters",id:"parameters",level:2},{value:"RTNPREFIX",id:"rtnprefix",level:3},{value:"Properties",id:"properties",level:2},{value:"IsExporting",id:"isexporting",level:3},{value:"Methods",id:"methods",level:2},{value:"Reset",id:"reset",level:3},{value:"GenerateExportRoutine",id:"generateexportroutine",level:3},{value:"GenDataExpr",id:"gendataexpr",level:3},{value:"DeleteExportRoutine",id:"deleteexportroutine",level:3},{value:"Export",id:"export",level:3},{value:"OpenExport",id:"openexport",level:3},{value:"ExportRows",id:"exportrows",level:3},{value:"GetSample",id:"getsample",level:3},{value:"CloseExport",id:"closeexport",level:3},{value:"GetExportSize",id:"getexportsize",level:3}];function i(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"librarysqlexportmgr",children:"%Library.SQLExportMgr"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Class %Library.SQLExportMgr Extends (%RegisteredObject, %SQLExImData) [ Inheritance = right, Not ProcedureBlock, System = 3 ]\n"})}),"\n",(0,n.jsx)(t.p,{children:"Export Controller for SQL Export."}),"\n",(0,n.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsx)(t.h3,{id:"rtnprefix",children:"RTNPREFIX"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter RTNPREFIX = "SQLExport";\n'})}),"\n",(0,n.jsx)(t.h2,{id:"properties",children:"Properties"}),"\n",(0,n.jsx)(t.h3,{id:"isexporting",children:"IsExporting"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property IsExporting As %Boolean [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(t.p,{children:"Private flag set to True when export is underway."}),"\n",(0,n.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(t.h3,{id:"reset",children:"Reset"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method Reset()\n"})}),"\n",(0,n.jsx)(t.p,{children:"Reset the state of this object."}),"\n",(0,n.jsx)(t.h3,{id:"generateexportroutine",children:"GenerateExportRoutine"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method GenerateExportRoutine(sample As %Integer = 0) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Generate the Export routine."}),"\n",(0,n.jsx)(t.p,{children:"If sample is 1 then generate code that writes sample data to a local variable."}),"\n",(0,n.jsx)(t.h3,{id:"gendataexpr",children:"GenDataExpr"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method GenDataExpr(col As %Integer, colno As %Integer) As %String\n"})}),"\n",(0,n.jsx)(t.p,{children:"Compute and return the correct expression for column col."}),"\n",(0,n.jsx)(t.p,{children:"colno is the number of the actual exported column (some columns may be skipped."}),"\n",(0,n.jsx)(t.h3,{id:"deleteexportroutine",children:"DeleteExportRoutine"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method DeleteExportRoutine() As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Delete the generated export routine."}),"\n",(0,n.jsx)(t.h3,{id:"export",children:"Export"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method Export(savertn As %Boolean = 0)\n"})}),"\n",(0,n.jsx)(t.p,{children:"Do an export from the command line."}),"\n",(0,n.jsx)(t.h3,{id:"openexport",children:"OpenExport"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method OpenExport() As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Prepares the start of an export."}),"\n",(0,n.jsx)(t.p,{children:"Call this after generating an export routine."}),"\n",(0,n.jsx)(t.h3,{id:"exportrows",children:"ExportRows"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method ExportRows(ByRef rows As %Integer, ByRef done As %Integer) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Exports the next rows rows to the export file. On return, rows contains the number of rows exported or 0 if the export is complete."}),"\n",(0,n.jsx)(t.h3,{id:"getsample",children:"GetSample"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetSample(ByRef rows As %Integer) As %String\n"})}),"\n",(0,n.jsx)(t.p,{children:"Exports the first rows rows to a sample variable."}),"\n",(0,n.jsx)(t.h3,{id:"closeexport",children:"CloseExport"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method CloseExport() As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Call this at the end of the export operation."}),"\n",(0,n.jsx)(t.h3,{id:"getexportsize",children:"GetExportSize"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetExportSize(ByRef rows As %Integer) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Returns the number of rows in the export table in rows."}),"\n",(0,n.jsx)(t.p,{children:"Call this after generating an export routine."})]})}function c(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(i,{...e})}):i(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>l,x:()=>a});var n=r(96540);const s={},o=n.createContext(s);function l(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);