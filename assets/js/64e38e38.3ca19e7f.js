"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[61625],{54485:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>i,default:()=>l,frontMatter:()=>s,toc:()=>c});var r=n(74848),a=n(28453);const s={pagination_prev:null,pagination_next:null},i="%CSP.Portal.SourceControl.IO",c=[{value:"Properties",id:"properties",level:2},{value:"Mode",id:"mode",level:3},{value:"NewLineTranslation",id:"newlinetranslation",level:3},{value:"InCapture",id:"incapture",level:3},{value:"Device",id:"device",level:3},{value:"Data",id:"data",level:3},{value:"Methods",id:"methods",level:2},{value:"ModeSet",id:"modeset",level:3},{value:"InitData",id:"initdata",level:3},{value:"%OnNew",id:"onnew",level:3},{value:"Redirect",id:"redirect",level:3},{value:"StartRedirect",id:"startredirect",level:3},{value:"StopRedirect",id:"stopredirect",level:3},{value:"WriteData",id:"writedata",level:3},{value:"ClearData",id:"cleardata",level:3},{value:"GetData",id:"getdata",level:3},{value:"%OnClose",id:"onclose",level:3}];function d(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"cspportalsourcecontrolio",children:"%CSP.Portal.SourceControl.IO"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Class %CSP.Portal.SourceControl.IO Extends %RegisteredObject [ System = 4 ]\n"})}),"\n",(0,r.jsx)(t.h2,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(t.h3,{id:"mode",children:"Mode"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Property Mode As %Integer(DISPLAYLIST = ",stream,array", VALUELIST = ",1,2");\n'})}),"\n",(0,r.jsx)(t.p,{children:"Capture mode indicating how the data should be stored."}),"\n",(0,r.jsx)(t.h3,{id:"newlinetranslation",children:"NewLineTranslation"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Property NewLineTranslation As %String(VALUELIST = ",,JS,HTML");\n'})}),"\n",(0,r.jsx)(t.p,{children:"Flag indicating whether newline translation should be used."}),"\n",(0,r.jsx)(t.h3,{id:"incapture",children:"InCapture"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Property InCapture As %Boolean [ InitialExpression = 0 ];\n"})}),"\n",(0,r.jsx)(t.p,{children:"Flag to indicate whether a capture is underway."}),"\n",(0,r.jsx)(t.h3,{id:"device",children:"Device"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Property Device As %String;\n"})}),"\n",(0,r.jsx)(t.p,{children:"The name of the device from which data is being captured. Note that this device will be used, and thus become the current device, when redirection is started."}),"\n",(0,r.jsx)(t.h3,{id:"data",children:"Data"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Property Data [ MultiDimensional, Private ];\n"})}),"\n",(0,r.jsx)(t.p,{children:"Location for data storage"}),"\n",(0,r.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(t.h3,{id:"modeset",children:"ModeSet"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method ModeSet(pMode) As %Status\n"})}),"\n",(0,r.jsx)(t.p,{children:"Ensure that Data is correctly initialized whenever Mode is changed."}),"\n",(0,r.jsx)(t.h3,{id:"initdata",children:"InitData"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Method InitData(pMode As %Integer = 1, pForce As %Boolean = 0, pStream As %Stream.Object = "") As %Status [ Private ]\n'})}),"\n",(0,r.jsx)(t.h3,{id:"onnew",children:"%OnNew"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Method %OnNew(pMode As %Integer = 1, pStream As %Stream.Object = "", pDevice As %String = {$IO}, pNewLineTranslation As %String = "") As %Status [ Private, ProcedureBlock = 1, ServerOnly = 1 ]\n'})}),"\n",(0,r.jsx)(t.p,{children:'Initialize the class based on a capture mode specified by pMode and a currently open device specified by pDevice. Note that the default mode is 1 (i.e. "stream") and the default device is the current device (i.e. $IO)'}),"\n",(0,r.jsx)(t.h3,{id:"redirect",children:"Redirect"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'ClassMethod Redirect(Output pInstance As %CSP.Portal.SourceControl.IO, pMode As %String = "stream", pStream As %Stream.Object = "", pDevice As %String = {$IO}, pNewLineTranslation As %String = "") As %Status\n'})}),"\n",(0,r.jsx)(t.p,{children:'Initialize redirection and return the current %CSP.Portal.SourceControl.IO instance in pInstance. pMode can take one of two values, either "stream" or "array". pDevice defines the device which should be used as the source for the data - note that the device must already be open for the redirection to work.'}),"\n",(0,r.jsx)(t.h3,{id:"startredirect",children:"StartRedirect"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method StartRedirect() As %Status [ ProcedureBlock = 0 ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Start the redirection using the current settings."}),"\n",(0,r.jsx)(t.h3,{id:"stopredirect",children:"StopRedirect"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method StopRedirect() As %Status\n"})}),"\n",(0,r.jsx)(t.p,{children:"Stop the IO redirection, correct the state of InCapture and clean up the %ISCIO variable"}),"\n",(0,r.jsx)(t.h3,{id:"writedata",children:"WriteData"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method WriteData(data As %String) As %Status\n"})}),"\n",(0,r.jsx)(t.p,{children:"Capture the data based on the current value of Mode."}),"\n",(0,r.jsx)(t.h3,{id:"cleardata",children:"ClearData"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Method ClearData(pReplacementStream As %Stream.Object = "") As %Status\n'})}),"\n",(0,r.jsx)(t.h3,{id:"getdata",children:"GetData"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetData(Output pData) As %Status\n"})}),"\n",(0,r.jsx)(t.p,{children:"Get the data captured during the redirection. pData will be a stream object if stream mode was specified,"}),"\n",(0,r.jsx)(t.h3,{id:"onclose",children:"%OnClose"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method %OnClose() As %Status [ Private, ProcedureBlock = 1, ServerOnly = 1 ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Ensure that redirection is stopped when the object goes out of scope."})]})}function l(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>c});var r=n(96540);const a={},s=r.createContext(a);function i(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);