"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[76859],{49652:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>l,default:()=>c,frontMatter:()=>i,toc:()=>a});var s=n(74848),r=n(28453);const i={pagination_prev:null,pagination_next:null},l="%Collection.ArrayOfObj",a=[{value:"Parameters",id:"parameters",level:2},{value:"IdCollection",id:"idcollection",level:3},{value:"Methods",id:"methods",level:2},{value:"Count",id:"count",level:3},{value:"Find",id:"find",level:3},{value:"FindObjectId",id:"findobjectid",level:3},{value:"FindOref",id:"findoref",level:3},{value:"GetAt",id:"getat",level:3},{value:"GetObjectAt",id:"getobjectat",level:3},{value:"GetObjectIdAt",id:"getobjectidat",level:3},{value:"GetNext",id:"getnext",level:3},{value:"GetObjectNext",id:"getobjectnext",level:3},{value:"GetObjectIdNext",id:"getobjectidnext",level:3},{value:"GetPrevious",id:"getprevious",level:3},{value:"GetObjectPrevious",id:"getobjectprevious",level:3},{value:"GetObjectIdPrevious",id:"getobjectidprevious",level:3},{value:"RemoveAt",id:"removeat",level:3},{value:"SetAt",id:"setat",level:3},{value:"SetObjectAt",id:"setobjectat",level:3},{value:"SetObjectIdAt",id:"setobjectidat",level:3},{value:"%UnSwizzleAt",id:"unswizzleat",level:3},{value:"%OnConstructClone",id:"onconstructclone",level:3},{value:"IsDefined",id:"isdefined",level:3},{value:"Define",id:"define",level:3},{value:"Next",id:"next",level:3},{value:"Previous",id:"previous",level:3},{value:"Serialize",id:"serialize",level:3},{value:"DeSerialize",id:"deserialize",level:3}];function o(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"collectionarrayofobj",children:"%Collection.ArrayOfObj"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Class %Collection.ArrayOfObj Extends (%Collection.AbstractArrayOfObj, Super) [ Inheritance = right, System = 2 ]\n"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"For information on this class"}),", see ",(0,s.jsx)(t.a,{href:"/csp/docbook/Doc.View.cls?FIND=CLASSES+%25Collection.ArrayOfObj",children:"Working with Collections"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"The %Collection.ArrayOfObjects class represents an array of references to objects, each of which is associated with a unique key value. Keys can have any value, string or numeric. The objects referred to must be registered. They can be either persistent objects or non-id objects."}),"\n",(0,s.jsx)(t.p,{children:'Internally, an %Collection.ArrayOfObjects object contains two arrays: one for holding the OID values for the objects referred to (or their serialized state in the case of an array of non-id objects); and another for holding the OREF values for any objects that have been explicitly referred to, and hence "swizzled" into memory. Swizzling (loading an object into memory and generating an OREF value for it) happens automatically whenever the user refers to an object within the array.'}),"\n",(0,s.jsxs)(t.p,{children:["For example, if array is an %Collection.ArrayOfObjects object containing an array of ",(0,s.jsx)(t.strong,{children:"Doctor"})," objects (that is an array of OID values for Doctor objects stored in the database) then the following code fragment will automatically load the ",(0,s.jsx)(t.strong,{children:"Doctor"}),' object associated with the key "Primary" into memory and generate an OREF value referring to the in-memory version of the ',(0,s.jsx)(t.strong,{children:"Doctor"})," object. This OREF value can then be used to access the properties and methods of the ",(0,s.jsx)(t.strong,{children:"Doctor"})," object: ",(0,s.jsx)(t.code,{children:'Set doc=array.GetAt("Primary") Write doc.Name'})]}),"\n",(0,s.jsxs)(t.p,{children:["Alternatively, we could use cascading dot syntax: ",(0,s.jsx)(t.code,{children:'Set name=array.GetAt("Primary").Name'})," These %Collection classes can only be used when you have a collection property of another object as they rely on storing the data inside the parent object, they cannot be used as 'standalone' collections, for this use the %ArrayOfObjects."]}),"\n",(0,s.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsx)(t.h3,{id:"idcollection",children:"IdCollection"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Parameter IdCollection As BOOLEAN = 0;\n"})}),"\n",(0,s.jsx)(t.p,{children:"If true then in the container we have an array of id's rather than an array of oid's"}),"\n",(0,s.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(t.h3,{id:"count",children:"Count"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Count() As %Integer\n"})}),"\n",(0,s.jsx)(t.p,{children:"Returns the number of elements contained in the array."}),"\n",(0,s.jsx)(t.h3,{id:"find",children:"Find"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Find(element As %ObjectIdentity, key As %String) As %String\n"})}),"\n",(0,s.jsx)(t.p,{children:"Starting from, but not including, location key, finds the next element in the array whose OID value equals element."}),"\n",(0,s.jsx)(t.p,{children:'If key is a null string (""), the search starts at the beginning of the array.'}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Find"}),' returns the key associated with the found element or null string ("") if no element is found.']}),"\n",(0,s.jsx)(t.h3,{id:"findobjectid",children:"FindObjectId"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method FindObjectId(id As %String, key As %Integer) As %String\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Starting from, but not including, position key, ",(0,s.jsx)(t.strong,{children:"FindObjectId"})," finds the next element in the list whose ObjectId equals id. If key is a null string, ",(0,s.jsx)(t.strong,{children:"Find"})," starts at the beginning of the list."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Find"}),' returns the position of the found element or null string ("") if no element was found.']}),"\n",(0,s.jsx)(t.h3,{id:"findoref",children:"FindOref"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method FindOref(oref As %RegisteredObject, key As %String = "", id As %String = "") As %String\n'})}),"\n",(0,s.jsx)(t.p,{children:"Starting from, but not including, location key, finds the next element in the array whose Oref value equals oref."}),"\n",(0,s.jsx)(t.p,{children:'If key is a null string (""), the search starts at the beginning of the array.'}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"FindOref"}),' returns the key associated with the found element or null string ("") if no element is found. Unswizzled references are compared to oref.%Oid() and if equal, swizzling will occur.']}),"\n",(0,s.jsx)(t.h3,{id:"getat",children:"GetAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetAt(key As %String) As %RegisteredObject\n"})}),"\n",(0,s.jsx)(t.p,{children:"Finds and returns the OREF value of the element associated with key."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"GetAt"}),' returns the OREF value of the element associated with key or null string ("") if no element is found.']}),"\n",(0,s.jsx)(t.h3,{id:"getobjectat",children:"GetObjectAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectAt(key As %String, force As %Integer = 0) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:"Finds and returns the OID value of the element associated with key."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"GetObjectAt"}),' returns the OID value of the element associated with key or null string ("") if no element is found.']}),"\n",(0,s.jsx)(t.h3,{id:"getobjectidat",children:"GetObjectIdAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectIdAt(key As %String, force As %Integer = 0) As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Finds and returns the ID value of the element associated with key."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"GetObjectIdAt"}),' returns the ID value of the element associated with key or null string ("") if no element is found.']}),"\n",(0,s.jsx)(t.h3,{id:"getnext",children:"GetNext"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetNext(ByRef key As %String) As %RegisteredObject\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OREF value of the element at the location after key in the array. If key is a null string (""), it returns the OREF value of the first element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the end of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectnext",children:"GetObjectNext"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectNext(ByRef key As %String) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OID value of the element at the location after key in the array. If key is a null string (""), it returns the OID value of the first element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the end of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectidnext",children:"GetObjectIdNext"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectIdNext(ByRef key As %String) As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the ID value of the element at the location after key in the array. If key is a null string (""), it returns the ID value of the first element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the end of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"getprevious",children:"GetPrevious"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetPrevious(ByRef key As %String) As %RegisteredObject\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OREF value of the element at the location before key in the array. If key is a null string (""), it returns the OREF value of the last element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the beginning of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectprevious",children:"GetObjectPrevious"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectPrevious(ByRef key As %String) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OID value of the element at the location before key in the array. If key is a null string (""), it returns the OID value of the last element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the beginning of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectidprevious",children:"GetObjectIdPrevious"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectIdPrevious(ByRef key As %String) As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the ID value of the element at the location before key in the array. If key is a null string (""), it returns the ID value of the last element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the beginning of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"removeat",children:"RemoveAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method RemoveAt(key As %String, Output success As %Boolean) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:"Removes the element associated with key in the array."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"RemoveAt"}),' returns the OID value of the removed element or null string ("") if no element was removed. It also has a success output argument that returns true if the item was removed and false if it was not.']}),"\n",(0,s.jsx)(t.h3,{id:"setat",children:"SetAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SetAt(oref As %RegisteredObject, key As %String) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Sets the OREF value of the element associated with key to element."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"setobjectat",children:"SetObjectAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SetObjectAt(oid As %ObjectIdentity, key As %String) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Sets the OID value of the element associated with key to element."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"setobjectidat",children:"SetObjectIdAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SetObjectIdAt(id As %String, key As %String) As %Status [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Sets the ID value of the element associated with key to element."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"unswizzleat",children:"%UnSwizzleAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %UnSwizzleAt(key As %String, force As %Integer = 0) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Unswizzles (removes from memory) the element associated with key in the array."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"onconstructclone",children:"%OnConstructClone"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %OnConstructClone(oref As %RegisteredObject, deep As %Boolean = 0, ByRef cloned As %String) As %Status [ Private ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"isdefined",children:"IsDefined"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method IsDefined(key As %String) As %Boolean [ CodeMode = expression, Final ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"define",children:"Define"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Define(key As %String) As %Boolean [ CodeMode = expression, Final ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"next",children:"Next"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method Next(key As %String = "") As %String [ CodeMode = expression, Final ]\n'})}),"\n",(0,s.jsx)(t.h3,{id:"previous",children:"Previous"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method Previous(key As %String = "") As %String [ CodeMode = expression, Final ]\n'})}),"\n",(0,s.jsx)(t.h3,{id:"serialize",children:"Serialize"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method Serialize(force As %Integer = 0) As %String(MAXLEN="")\n'})}),"\n",(0,s.jsx)(t.p,{children:"Serialize() constructs a serialized form of the collection as a string"}),"\n",(0,s.jsx)(t.h3,{id:"deserialize",children:"DeSerialize"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method DeSerialize(serialized As %String(MAXLEN="")) As %Status\n'})})]})}function c(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>a});var s=n(96540);const r={},i=s.createContext(r);function l(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);