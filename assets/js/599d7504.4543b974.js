"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[38578],{77600:(e,n,s)=>{s.r(n),s.d(n,{contentTitle:()=>i,default:()=>c,frontMatter:()=>r,toc:()=>l});var t=s(74848),a=s(28453);const r={pagination_prev:null,pagination_next:null},i="%ZEN.Controller",l=[{value:"Parameters",id:"parameters",level:2},{value:"DOMAIN",id:"domain",level:3},{value:"Methods",id:"methods",level:2},{value:"OnEndSession",id:"onendsession",level:3},{value:"OnPreHTTP",id:"onprehttp",level:3},{value:"OnPostHTTP",id:"onposthttp",level:3},{value:"OnPreHyperEvent",id:"onprehyperevent",level:3},{value:"OnPostHyperEvent",id:"onposthyperevent",level:3},{value:"%Cleanup",id:"cleanup",level:3},{value:"%DrawComponentHTML",id:"drawcomponenthtml",level:3},{value:"%NotifyComponents",id:"notifycomponents",level:3},{value:"%MaterializeComposites",id:"materializecomposites",level:3},{value:"%InvokeFormSubmitCallback",id:"invokeformsubmitcallback",level:3},{value:"%InvokeFormSubmitHandler",id:"invokeformsubmithandler",level:3},{value:"InvokeClassMethod",id:"invokeclassmethod",level:3},{value:"InvokeInstanceMethod",id:"invokeinstancemethod",level:3},{value:"%DeserializePage",id:"deserializepage",level:3},{value:"%BeginChangeTracking",id:"beginchangetracking",level:3},{value:"%EndChangeTracking",id:"endchangetracking",level:3},{value:"%ChangeNS",id:"changens",level:3},{value:"%SetNS",id:"setns",level:3},{value:"%GetOREF",id:"getoref",level:3},{value:"%EscapeJS",id:"escapejs",level:3},{value:"%BeginJSTranslation",id:"beginjstranslation",level:3},{value:"%EndJSTranslation",id:"endjstranslation",level:3},{value:"%GetStackTrace",id:"getstacktrace",level:3}];function o(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"zencontroller",children:"%ZEN.Controller"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Class %ZEN.Controller [ Abstract, Deprecated, Final, System = 3 ]\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This utility class provides a centralized place for managing events between the client and the server.",(0,t.jsx)(n.br,{}),"\nThere are no user-callable methods within this class."]}),"\n",(0,t.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsx)(n.h3,{id:"domain",children:"DOMAIN"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:'Parameter DOMAIN = "%Utility";\n'})}),"\n",(0,t.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(n.h3,{id:"onendsession",children:"OnEndSession"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod OnEndSession()\n"})}),"\n",(0,t.jsx)(n.p,{children:"Called when the session is about to be deleted."}),"\n",(0,t.jsx)(n.h3,{id:"onprehttp",children:"OnPreHTTP"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod OnPreHTTP(pPageClass As %String, pClientCache As %Boolean, pAutoNS As %Boolean = 0, pResource As %String = "", pContentType As %String = "", pIframeallowed As %Boolean = 1) As %Boolean [ ServerOnly = 1 ]\n'})}),"\n",(0,t.jsx)(n.p,{children:"PreHTTP handler shared by all ZEN pages."}),"\n",(0,t.jsx)(n.h3,{id:"onposthttp",children:"OnPostHTTP"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod OnPostHTTP(pPageClass As %String) [ ServerOnly = 1 ]\n"})}),"\n",(0,t.jsx)(n.p,{children:"PostHTTP handler shared by all ZEN pages."}),"\n",(0,t.jsx)(n.h3,{id:"onprehyperevent",children:"OnPreHyperEvent"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod OnPreHyperEvent(pPageClass As %String, pMethod As %String, pAutoNS As %Boolean = 0, pResource As %String = "") As %Boolean [ ServerOnly = 1 ]\n'})}),"\n",(0,t.jsx)(n.p,{children:"PreHyperEvent handler shared by all ZEN pages."}),"\n",(0,t.jsx)(n.h3,{id:"onposthyperevent",children:"OnPostHyperEvent"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod OnPostHyperEvent(pPageClass As %String) As %Boolean [ ServerOnly = 1 ]\n"})}),"\n",(0,t.jsx)(n.p,{children:"PostHyperEvent handler shared by all ZEN pages."}),"\n",(0,t.jsx)(n.h3,{id:"cleanup",children:"%Cleanup"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %Cleanup() [ Internal, ServerOnly = 1 ]\n"})}),"\n",(0,t.jsx)(n.p,{children:"Clean up %variables used by Zen (called when Preserve=1 is in effect)."}),"\n",(0,t.jsx)(n.h3,{id:"drawcomponenthtml",children:"%DrawComponentHTML"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod %DrawComponentHTML(pComponent As %ZEN.Component.component, pStyle As %String = "") [ Final, Internal ]\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Internal method.",(0,t.jsx)(n.br,{}),"\nFor design mode, draw enclosing div element and then draw contents within it for a component."]}),"\n",(0,t.jsx)(n.h3,{id:"notifycomponents",children:"%NotifyComponents"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %NotifyComponents() As %Status [ Internal ]\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Internal method.",(0,t.jsx)(n.br,{}),"\nInvokes the %OnAddToPageAfter callback for any components that are interested."]}),"\n",(0,t.jsx)(n.h3,{id:"materializecomposites",children:"%MaterializeComposites"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %MaterializeComposites() As %Status\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Internal method.",(0,t.jsx)(n.br,{}),"\nThis method tests if there are any unmaterialized composite elements on the current page. If any are present they will be materialized (their children are created)."]}),"\n",(0,t.jsx)(n.h3,{id:"invokeformsubmitcallback",children:"%InvokeFormSubmitCallback"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %InvokeFormSubmitCallback(pClass As %String, pMethod As %String, pSubmit As %ZEN.Submit) As %Status\n"})}),"\n",(0,t.jsx)(n.p,{children:"Invoke the OnSubmitForm callback for a form."}),"\n",(0,t.jsx)(n.h3,{id:"invokeformsubmithandler",children:"%InvokeFormSubmitHandler"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %InvokeFormSubmitHandler(pSubmit As %ZEN.Submit) As %Status\n"})}),"\n",(0,t.jsx)(n.p,{children:"For a bound form, invoke the submit handler for the associated DataModel class."}),"\n",(0,t.jsx)(n.h3,{id:"invokeclassmethod",children:"InvokeClassMethod"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod InvokeClassMethod(pPageClass As %String, pClass As %String, pMethod As %String, pRetType As %String, pSyncFlag As %Boolean, pHeader As %String, pBody As %String, pSpec As %String = "", pArgs As %String = "", pNamespace As %String = "", pThreadId As %Integer = 0) As %String\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This method is called from the client when it wants to invoke a class method.",(0,t.jsx)(n.br,{}),"\npPageClass is the class name of the page invoking the method.",(0,t.jsx)(n.br,{}),"\npClass is the class name.",(0,t.jsx)(n.br,{}),"\npMethod is the method name.",(0,t.jsx)(n.br,{}),'\npRetType is the client type of the return type (or "").',(0,t.jsx)(n.br,{}),"\npHeader is the header section of the serial state.",(0,t.jsx)(n.br,{}),"\npBody is the body section of the serial state.",(0,t.jsx)(n.br,{}),'\npSpec is the method signature: "L,L,O" (L = Literal, B = Boolean, O = Object).',(0,t.jsx)(n.br,{}),"\npArgs is the serialized set of arguments. ($C(4) delimited).",(0,t.jsx)(n.br,{}),"\npNamespace is the namespace to run in."]}),"\n",(0,t.jsx)(n.h3,{id:"invokeinstancemethod",children:"InvokeInstanceMethod"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod InvokeInstanceMethod(pPageClass As %String, pObjIndex As %Integer, pMethod As %String, pRetType As %String, pSyncFlag As %Boolean, pHeader As %String, pBody As %String, pSpec As %String = "", pArgs As %String = "", pNamespace As %String = "", pThreadId As %Integer = 0)\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This method is called from the client when it wants to invoke an instance method for a component. pPageClass is the class name of the page invoking the method.",(0,t.jsx)(n.br,{}),"\npObjIndex is the index of *this* object.",(0,t.jsx)(n.br,{}),"\npMethod is the method name.",(0,t.jsx)(n.br,{}),'\npRetType is the client type of the return type (or "").',(0,t.jsx)(n.br,{}),"\npHeader is the header section of the serial state.",(0,t.jsx)(n.br,{}),"\npBody is the body section of the serial state.",(0,t.jsx)(n.br,{}),'\npSpec is the method signature: "L,L,O" (L = Literal, B = Boolean, O = Object).',(0,t.jsx)(n.br,{}),"\npArgs is the serialized set of arguments. ($C(4) delimited).",(0,t.jsx)(n.br,{}),"\npNamespace is the namespace to run in."]}),"\n",(0,t.jsx)(n.h3,{id:"deserializepage",children:"%DeserializePage"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %DeserializePage(pHeader As %String, pBody As %String, Output pObjects) As %Status\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Takes the serialized state of a set of client components and recreates the set of server-side objects.",(0,t.jsx)(n.br,{}),"\nOn return, pObjects is array of objects subscripted by component index.",(0,t.jsx)(n.br,{}),"\nAs a side-effect it will set %page."]}),"\n",(0,t.jsx)(n.h3,{id:"beginchangetracking",children:"%BeginChangeTracking"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %BeginChangeTracking() As %Integer\n"})}),"\n",(0,t.jsx)(n.p,{children:"Start capturing changes to objects."}),"\n",(0,t.jsx)(n.h3,{id:"endchangetracking",children:"%EndChangeTracking"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod %EndChangeTracking(pMaxIndex As %Integer, pMode As %String = "", pTrace As %String = "")\n'})}),"\n",(0,t.jsx)(n.p,{children:'Stop capturing changes to objects; Generate JS to sync client to server changes. If pMode is "page" then this is called at page render time. pTrace is provided for diagnostic purposes.'}),"\n",(0,t.jsx)(n.h3,{id:"changens",children:"%ChangeNS"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %ChangeNS(pNS As %String) As %Status\n"})}),"\n",(0,t.jsx)(n.p,{children:"Change namespace for the context of this page (see the AUTONS parameter)"}),"\n",(0,t.jsx)(n.h3,{id:"setns",children:"%SetNS"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %SetNS(pNS As %String = {$namespace}) As %Status\n"})}),"\n",(0,t.jsx)(n.p,{children:"Specify a target namespace for any links we generate"}),"\n",(0,t.jsx)(n.h3,{id:"getoref",children:"%GetOREF"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %GetOREF(orefint As %Integer) As %RegisteredObject\n"})}),"\n",(0,t.jsx)(n.p,{children:"Internal helper method: convert integer to oref [Previously private]"}),"\n",(0,t.jsx)(n.h3,{id:"escapejs",children:"%EscapeJS"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %EscapeJS(pString As %String) As %String [ Internal ]\n"})}),"\n",(0,t.jsx)(n.p,{children:"Escape (some) unprintable characters in pString."}),"\n",(0,t.jsx)(n.h3,{id:"beginjstranslation",children:"%BeginJSTranslation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %BeginJSTranslation() As %String\n"})}),"\n",(0,t.jsx)(n.p,{children:"This method begins JS translation of Write commands. Returns a token that should be passed along to %EndJSTranslation"}),"\n",(0,t.jsx)(n.h3,{id:"endjstranslation",children:"%EndJSTranslation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %EndJSTranslation(pToken As %String)\n"})}),"\n",(0,t.jsx)(n.p,{children:"This method ends JS translation of Write commands."}),"\n",(0,t.jsx)(n.h3,{id:"getstacktrace",children:"%GetStackTrace"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %GetStackTrace(pIgnoreTop As %Integer = 0) As %String\n"})}),"\n",(0,t.jsx)(n.p,{children:"Returns a stack trace, pass pIgnoreTop if you want to skip any stack levels at the top. If you want the stack from the most recent error or exception, then pass -1 for pIgnoreTop, otherwise $ECODE is cleared and $STACK gives the current stack. This method is not called anywhere, but is available for debugging."})]})}function c(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>l});var t=s(96540);const a={},r=t.createContext(a);function i(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);