"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[75470],{81936:(e,t,s)=>{s.r(t),s.d(t,{contentTitle:()=>c,default:()=>o,frontMatter:()=>a,toc:()=>i});var n=s(74848),r=s(28453);const a={pagination_prev:null,pagination_next:null},c="%ML.DeferredStatement",i=[{value:"Properties",id:"properties",level:2},{value:"SQL",id:"sql",level:3},{value:"SQLCOUNT",id:"sqlcount",level:3},{value:"Args",id:"args",level:3},{value:"%SQLCODE",id:"sqlcode",level:3},{value:"%Message",id:"message",level:3},{value:"Methods",id:"methods",level:2},{value:"%Prepare",id:"prepare",level:3},{value:"%Execute",id:"execute",level:3},{value:"%ExecDirect",id:"execdirect",level:3},{value:"%Next",id:"next",level:3}];function l(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"mldeferredstatement",children:"%ML.DeferredStatement"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Class %ML.DeferredStatement Extends %RegisteredObject [ System = 4 ]\n"})}),"\n",(0,n.jsx)(t.p,{children:"Deferred version of a %SQL.Statement. This class is a facade for %SQL.Statement and as such implements the %SQL.Statement interface"}),"\n",(0,n.jsx)(t.h2,{id:"properties",children:"Properties"}),"\n",(0,n.jsx)(t.h3,{id:"sql",children:"SQL"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property SQL As %String [ MultiDimensional ];\n"})}),"\n",(0,n.jsx)(t.p,{children:"SQL statement"}),"\n",(0,n.jsx)(t.h3,{id:"sqlcount",children:"SQLCOUNT"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property SQLCOUNT As %String [ MultiDimensional ];\n"})}),"\n",(0,n.jsx)(t.p,{children:"SQL statement to count result set rows"}),"\n",(0,n.jsx)(t.h3,{id:"args",children:"Args"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property Args As %String [ MultiDimensional ];\n"})}),"\n",(0,n.jsx)(t.p,{children:"Any query args"}),"\n",(0,n.jsx)(t.h3,{id:"sqlcode",children:"%SQLCODE"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property %SQLCODE As %Library.Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(t.p,{children:"%SQLCODE indicates whether or not the statement was executed successfully. If %SQLCODE is not negative (greater than or equal to zero) then the statement was successfully executed. Otherwise, the value of %SQLCODE contains the error code and the %Message property might contain more information about the error."}),"\n",(0,n.jsx)(t.h3,{id:"message",children:"%Message"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property %Message As %Library.String(MAXLEN = 256);\n"})}),"\n",(0,n.jsx)(t.p,{children:"%Message contains additional information about an error reported as a negative value in %SQLCODE. Additional information is not always available."}),"\n",(0,n.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(t.h3,{id:"prepare",children:"%Prepare"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method %Prepare(ByRef %statement As %String) As %Status\n"})}),"\n",(0,n.jsx)(t.p,{children:"Facade for %SQL.Statement:%Prepare()"}),"\n",(0,n.jsx)(t.h3,{id:"execute",children:"%Execute"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method %Execute(%parm...) As %SQL.StatementResult\n"})}),"\n",(0,n.jsx)(t.p,{children:"Facade for %SQL.Statement:%Execute Note, returns $THIS as it's not a real resultset, but it'll get passed into the ML provider."}),"\n",(0,n.jsx)(t.h3,{id:"execdirect",children:"%ExecDirect"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'ClassMethod %ExecDirect(ByRef StmtHandle As %SQL.Statement = {$$$NULLOREF}, ByRef %statement As %RawString = "", ByRef %statementcount As %RawString = "", %parm...) As %SQL.StatementResult\n'})}),"\n",(0,n.jsx)(t.p,{children:"Facade for %SQL.Statement:%ExecDirect Note, returns $THIS as it's not a real resultset, but it'll get passed into the ML provider."}),"\n",(0,n.jsx)(t.h3,{id:"next",children:"%Next"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method %Next(ByRef sc As %Status) As %Integer\n"})}),"\n",(0,n.jsx)(t.p,{children:"No-op implementation of this"})]})}function o(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>c,x:()=>i});var n=s(96540);const r={},a=n.createContext(r);function c(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);