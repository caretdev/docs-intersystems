"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[15353],{11876:(e,s,n)=>{n.r(s),n.d(s,{contentTitle:()=>a,default:()=>d,frontMatter:()=>r,toc:()=>l});var i=n(74848),t=n(28453);const r={pagination_prev:null,pagination_next:null},a="%SAML.Assertion",l=[{value:"Parameters",id:"parameters",level:2},{value:"XMLFORMAT",id:"xmlformat",level:3},{value:"NAMESPACE",id:"namespace",level:3},{value:"ELEMENTQUALIFIED",id:"elementqualified",level:3},{value:"XMLPREFIX",id:"xmlprefix",level:3},{value:"XMLSEQUENCE",id:"xmlsequence",level:3},{value:"Properties",id:"properties",level:2},{value:"Issuer",id:"issuer",level:3},{value:"Signature",id:"signature",level:3},{value:"Subject",id:"subject",level:3},{value:"Conditions",id:"conditions",level:3},{value:"Advice",id:"advice",level:3},{value:"Statement",id:"statement",level:3},{value:"WSSecuritySignature",id:"wssecuritysignature",level:3},{value:"SAMLID",id:"samlid",level:3},{value:"IssueInstant",id:"issueinstant",level:3},{value:"Version",id:"version",level:3},{value:"NodeId",id:"nodeid",level:3},{value:"Text",id:"text",level:3},{value:"X509Credentials",id:"x509credentials",level:3},{value:"PrefixList",id:"prefixlist",level:3},{value:"Methods",id:"methods",level:2},{value:"X509CredentialsGet",id:"x509credentialsget",level:3},{value:"GetX509Credentials",id:"getx509credentials",level:3},{value:"XMLNew",id:"xmlnew",level:3},{value:"Create",id:"create",level:3},{value:"CreateX509",id:"createx509",level:3},{value:"ValidateTokenRef",id:"validatetokenref",level:3},{value:"InitializeForService",id:"initializeforservice",level:3},{value:"Perform",id:"perform",level:3},{value:"Reset",id:"reset",level:3},{value:"ValidateElement",id:"validateelement",level:3}];function c(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"samlassertion",children:"%SAML.Assertion"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Class %SAML.Assertion Extends (%SOAP.WST.AbstractToken, %SOAP.Security.Element, %SAML.AssertionReference) [ Inheritance = right, System = 4 ]\n"})}),"\n",(0,i.jsx)(s.p,{children:"SAML Assert Token for SOAP Security header."}),"\n",(0,i.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsx)(s.h3,{id:"xmlformat",children:"XMLFORMAT"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter XMLFORMAT = "literal";\n'})}),"\n",(0,i.jsx)(s.h3,{id:"namespace",children:"NAMESPACE"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter NAMESPACE = "urn:oasis:names:tc:SAML:2.0:assertion";\n'})}),"\n",(0,i.jsx)(s.h3,{id:"elementqualified",children:"ELEMENTQUALIFIED"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter ELEMENTQUALIFIED = 0;\n"})}),"\n",(0,i.jsx)(s.h3,{id:"xmlprefix",children:"XMLPREFIX"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter XMLPREFIX = "saml";\n'})}),"\n",(0,i.jsx)(s.h3,{id:"xmlsequence",children:"XMLSEQUENCE"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter XMLSEQUENCE = 1;\n"})}),"\n",(0,i.jsx)(s.p,{children:"Need to distinguish the 2 different possible Signature elements."}),"\n",(0,i.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,i.jsx)(s.h3,{id:"issuer",children:"Issuer"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Property Issuer As %SAML.NameID(XMLREF = 1) [ Required ];\n"})}),"\n",(0,i.jsx)(s.h3,{id:"signature",children:"Signature"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property Signature As %XML.Security.Signature(REFELEMENTQUALIFIED = 1, REFNAMESPACE = "http://www.w3.org/2000/09/xmldsig#", XMLREF = 1);\n'})}),"\n",(0,i.jsx)(s.h3,{id:"subject",children:"Subject"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Property Subject As %SAML.Subject(XMLREF = 1);\n"})}),"\n",(0,i.jsx)(s.h3,{id:"conditions",children:"Conditions"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Property Conditions As %SAML.Conditions(XMLREF = 1);\n"})}),"\n",(0,i.jsx)(s.h3,{id:"advice",children:"Advice"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property Advice As list Of %SAML.AssertionReference(REFELEMENTQUALIFIED = 1, XMLREF = 1, XMLTYPECONSTRAINT = "choice");\n'})}),"\n",(0,i.jsx)(s.h3,{id:"statement",children:"Statement"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property Statement As list Of %SAML.Statement(XMLPROJECTION = "element", XMLREF = 1, XMLTYPECONSTRAINT = "choice");\n'})}),"\n",(0,i.jsx)(s.h3,{id:"wssecuritysignature",children:"WSSecuritySignature"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property WSSecuritySignature As %XML.Security.Signature(REFELEMENTQUALIFIED = 1, REFNAMESPACE = "http://www.w3.org/2000/09/xmldsig#", XMLNAME = "Signature", XMLREF = 1) [ Internal ];\n'})}),"\n",(0,i.jsx)(s.h3,{id:"samlid",children:"SAMLID"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property SAMLID As %String(MAXLEN = "", XMLNAME = "ID", XMLPROJECTION = "attribute") [ Required ];\n'})}),"\n",(0,i.jsx)(s.h3,{id:"issueinstant",children:"IssueInstant"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property IssueInstant As %xsd.dateTime(XMLPROJECTION = "attribute") [ Required ];\n'})}),"\n",(0,i.jsx)(s.h3,{id:"version",children:"Version"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property Version As %String(MAXLEN = "", XMLPROJECTION = "attribute") [ Required ];\n'})}),"\n",(0,i.jsx)(s.h3,{id:"nodeid",children:"NodeId"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property NodeId As %String(XMLPROJECTION = "none") [ Internal ];\n'})}),"\n",(0,i.jsx)(s.p,{children:"Save the node id of this element in the tree during import."}),"\n",(0,i.jsx)(s.h3,{id:"text",children:"Text"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property Text As %String(XMLPROJECTION = "none") [ Internal ];\n'})}),"\n",(0,i.jsx)(s.p,{children:"Save the text this element in the tree during import."}),"\n",(0,i.jsx)(s.h3,{id:"x509credentials",children:"X509Credentials"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property X509Credentials As %RawString(XMLPROJECTION = "none") [ Internal ];\n'})}),"\n",(0,i.jsx)(s.p,{children:"If SubjectConfirmation is based on X509 certificate, this is the X509 certificate class. This property is read-only."}),"\n",(0,i.jsx)(s.h3,{id:"prefixlist",children:"PrefixList"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Property PrefixList As %String(MAXLEN = "", XMLPROJECTION = "none") [ Internal ];\n'})}),"\n",(0,i.jsx)(s.p,{children:"The optional prefix list to be used for inclusive namespace prefix when creating WSSecuritySignature. The PrefixList that is specified for this SAML assertion as a list of NMTOKENS."}),"\n",(0,i.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,i.jsx)(s.h3,{id:"x509credentialsget",children:"X509CredentialsGet"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Method X509CredentialsGet() As %SYS.X509Credentials [ Internal ]\n"})}),"\n",(0,i.jsx)(s.h3,{id:"getx509credentials",children:"GetX509Credentials"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Method GetX509Credentials() As %SYS.X509Credentials [ CodeMode = expression ]\n"})}),"\n",(0,i.jsx)(s.p,{children:"Get the X.509 credentials associated with this Security header element on input."}),"\n",(0,i.jsx)(s.h3,{id:"xmlnew",children:"XMLNew"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod XMLNew(document As %XML.Document, nodeId As %Integer, containerOref As %RegisteredObject = "") As %RegisteredObject\n'})}),"\n",(0,i.jsx)(s.p,{children:"Save the node if when getting a new class instance."}),"\n",(0,i.jsx)(s.h3,{id:"create",children:"Create"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Create() As %SAML.Assertion\n"})}),"\n",(0,i.jsx)(s.p,{children:"Create an unsigned SAML Asssertion"}),"\n",(0,i.jsx)(s.h3,{id:"createx509",children:"CreateX509"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod CreateX509(credentials As %SYS.X509Credentials, referenceOption As %Integer, prefixList As %String = "") As %SAML.Assertion\n'})}),"\n",(0,i.jsxs)(s.p,{children:["Create an SAML Asssertion with WS-Security Signature based on X.509 credentials.",(0,i.jsx)(s.br,{}),"\nprefixList that is specified as a list of NMTOKENS for signing this SAML assertion."]}),"\n",(0,i.jsx)(s.h3,{id:"validatetokenref",children:"ValidateTokenRef"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Method ValidateTokenRef(service As %SOAP.WebBase, ByRef tokenType As %String, ByRef credentials As %SYS.X509Credentials) As %String [ Internal ]\n"})}),"\n",(0,i.jsx)(s.p,{children:'Validate and get the credentials from the Assertion\'s SubjectConfirmationData element with holder-of-key method. If valid, set credentials argument and return "". If not valid, return error code.'}),"\n",(0,i.jsx)(s.h3,{id:"initializeforservice",children:"InitializeForService"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Method InitializeForService(service As %SOAP.WebBase, header As %SOAP.Security.Header) As %Status [ Internal ]\n"})}),"\n",(0,i.jsx)(s.p,{children:"Initialize the signature in the SAML assertion."}),"\n",(0,i.jsx)(s.h3,{id:"perform",children:"Perform"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Method Perform(messageStream As %BinaryStream, header As %SOAP.Security.Header) As %Status [ Internal ]\n"})}),"\n",(0,i.jsx)(s.p,{children:"Complete the Signature element by adding the Reference elements to the SignedInfo based on the SignatureOptions and computing the signature value."}),"\n",(0,i.jsx)(s.h3,{id:"reset",children:"Reset"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:"Method Reset() [ Internal ]\n"})}),"\n",(0,i.jsx)(s.p,{children:"Reset the SAML assertion."}),"\n",(0,i.jsx)(s.h3,{id:"validateelement",children:"ValidateElement"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-objectscript-class",children:'Method ValidateElement(document As %XML.Document, service As %SOAP.WebBase, mimeAttachments As %Net.MIMEPart = "") As %String [ Internal ]\n'})}),"\n",(0,i.jsx)(s.p,{children:"Validate the SAML assertion. If invalid return an error code."})]})}function d(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>l});var i=n(96540);const t={},r=i.createContext(t);function a(e){const s=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);