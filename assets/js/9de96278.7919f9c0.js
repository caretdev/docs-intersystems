"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[38951],{54858:(e,s,n)=>{n.r(s),n.d(s,{contentTitle:()=>t,default:()=>o,frontMatter:()=>a,toc:()=>c});var r=n(74848),l=n(28453);const a={pagination_prev:null,pagination_next:null},t="%ZEN.Report.aggregate",c=[{value:"Properties",id:"properties",level:2},{value:"type",id:"type",level:3},{value:"class",id:"class",level:3},{value:"format",id:"format",level:3},{value:"escape",id:"escape",level:3},{value:"excelFormula",id:"excelformula",level:3},{value:"uniqueId",id:"uniqueid",level:3},{value:"excelName",id:"excelname",level:3},{value:"excelNumberFormat",id:"excelnumberformat",level:3},{value:"filter",id:"filter",level:3},{value:"preprocessValue",id:"preprocessvalue",level:3},{value:"postprocessResult",id:"postprocessresult",level:3},{value:"ignoreNLS",id:"ignorenls",level:3},{value:"runtimeMode",id:"runtimemode",level:3},{value:"Methods",id:"methods",level:2},{value:"%PreProcessValue",id:"preprocessvalue-1",level:3},{value:"%PostProcessValue",id:"postprocessvalue",level:3}];function i(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"zenreportaggregate",children:"%ZEN.Report.aggregate"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Class %ZEN.Report.aggregate Extends valueNode [ Deprecated, System = 3 ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Defines an aggregate element within a ZEN Report."}),"\n",(0,r.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(s.h3,{id:"type",children:"type"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Property type As %ZEN.Datatype.string(MAXLEN = 50, VALUELIST = ",COUNT,SUM,AVG,MIN,MAX,CUSTOM,PLACEHOLDER,EXPRESSION");\n'})}),"\n",(0,r.jsx)(s.p,{children:"Type of aggregate to calculate."}),"\n",(0,r.jsx)(s.h3,{id:"class",children:"class"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Property class As %ZEN.Datatype.className;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"format",children:"format"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Property format As %ZEN.Datatype.string;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"escape",children:"escape"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Property escape As %ZEN.Datatype.string(VALUELIST = ",xml,none,noneifspace") [ InitialExpression = "xml" ];\n'})}),"\n",(0,r.jsx)(s.p,{children:"escape can be nonspace in which case any text with line-feed or space characters is not XML spaced or none in which case no characters are XML spaced but all are enclosed in CDATA or xml in which case the text is XML escaped this controls elements and attributes in groups"}),"\n",(0,r.jsx)(s.h3,{id:"excelformula",children:"excelFormula"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Property excelFormula As %ZEN.Datatype.string;\n"})}),"\n",(0,r.jsx)(s.p,{children:"In Excel mode, have ZEN Reports use this formula to calculate aggregate =formula(cellbeginnings:cellend)"}),"\n",(0,r.jsx)(s.h3,{id:"uniqueid",children:"uniqueId"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Property uniqueId As %ZEN.Datatype.string;\n"})}),"\n",(0,r.jsx)(s.p,{children:"Unique id for aggregate. Doesn't matter what it is as long as it is unique Doesn't need to be set unless one is using EXPRESSION aggregate that refers to other unique aggregates Other unique aggregates have values in %agg(..uniqueId)"}),"\n",(0,r.jsx)(s.h3,{id:"excelname",children:"excelName"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Property excelName As %ZEN.Datatype.string;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"excelnumberformat",children:"excelNumberFormat"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Property excelNumberFormat As %ZEN.Datatype.string;\n"})}),"\n",(0,r.jsx)(s.p,{children:'if non-null is display number format of aggregate value, only effective when mode="xlsx"'}),"\n",(0,r.jsx)(s.h3,{id:"filter",children:"filter"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Property filter As %ZEN.Datatype.integer [ InitialExpression = 1 ];\n"})}),"\n",(0,r.jsx)(s.p,{children:"When filter is 0, element is skipped"}),"\n",(0,r.jsx)(s.h3,{id:"preprocessvalue",children:"preprocessValue"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Property preprocessValue As %ZEN.Datatype.boolean;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"postprocessresult",children:"postprocessResult"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Property postprocessResult As %ZEN.Datatype.boolean;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"ignorenls",children:"ignoreNLS"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Property ignoreNLS As %ZEN.Datatype.boolean;\n"})}),"\n",(0,r.jsx)(s.p,{children:"Don't process NLS concerns in the aggregate (if null we pick up default from report parameter AGGREGATESIGNORENLS)"}),"\n",(0,r.jsx)(s.h3,{id:"runtimemode",children:"runtimeMode"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Property runtimeMode As %Integer(XMLPROJECTION = "none");\n'})}),"\n",(0,r.jsx)(s.p,{children:"internal property used to communicate with custom aggregates"}),"\n",(0,r.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(s.h3,{id:"preprocessvalue-1",children:"%PreProcessValue"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod %PreProcessValue(value As %String, preprocessValue As %Boolean, runtimeMode As %Integer, ignoreNLS As %Boolean)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"postprocessvalue",children:"%PostProcessValue"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod %PostProcessValue(result As %String, postprocessResult As %Boolean, runtimeMode As %Integer, ignoreNLS As %Boolean)\n"})})]})}function o(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>c});var r=n(96540);const l={},a=r.createContext(l);function t(e){const s=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),r.createElement(a.Provider,{value:s},e.children)}}}]);