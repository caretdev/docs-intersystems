"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[74136],{98752:(e,n,s)=>{s.r(n),s.d(n,{contentTitle:()=>l,default:()=>i,frontMatter:()=>a,toc:()=>c});var r=s(74848),t=s(28453);const a={pagination_prev:null,pagination_next:null},l="%CSP.Broker",c=[{value:"Parameters",id:"parameters",level:2},{value:"CHARSET",id:"charset",level:3},{value:"Methods",id:"methods",level:2},{value:"OnPreHTTP",id:"onprehttp",level:3},{value:"callPreHyperEvent",id:"callprehyperevent",level:3},{value:"OnPage",id:"onpage",level:3},{value:"OnPostHTTP",id:"onposthttp",level:3},{value:"GetEvent",id:"getevent",level:3},{value:"XecuteStr",id:"xecutestr",level:3},{value:"CSPEvent",id:"cspevent",level:3},{value:"CSPJSEvent",id:"cspjsevent",level:3},{value:"InsertErrorHeader",id:"inserterrorheader",level:3},{value:"InsertErrorEnd",id:"inserterrorend",level:3}];function o(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"cspbroker",children:"%CSP.Broker"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Class %CSP.Broker Extends %CSP.Page [ Abstract, System = 3 ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"This class is used internally by InterSystems IRIS. You should not make direct use of it within your applications. There is no guarantee made about either the behavior or future operation of this class."}),"\n",(0,r.jsx)(n.p,{children:"The %CSP.Broker object serves as an event handler for CSP requests."}),"\n",(0,r.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(n.h3,{id:"charset",children:"CHARSET"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'Parameter CHARSET [ Internal ] = "utf-8";\n'})}),"\n",(0,r.jsx)(n.p,{children:"Default result to be written in UTF-8."}),"\n",(0,r.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(n.h3,{id:"onprehttp",children:"OnPreHTTP"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod OnPreHTTP() As %Boolean [ Internal ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"OnPreHTTP to setup response headers."}),"\n",(0,r.jsx)(n.h3,{id:"callprehyperevent",children:"callPreHyperEvent"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod callPreHyperEvent(class As %String, cls As %String, method As %String) [ Internal, Private, ProcedureBlock = 0 ]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"onpage",children:"OnPage"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod OnPage() As %Status [ Internal ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Compute and serve the hyperevent response."}),"\n",(0,r.jsx)(n.h3,{id:"onposthttp",children:"OnPostHTTP"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod OnPostHTTP() [ Internal ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Signal trapped error"}),"\n",(0,r.jsx)(n.h3,{id:"getevent",children:"GetEvent"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod GetEvent(event As %String, ByRef cls As %String, ByRef member As %String) As %Status [ Internal, Private ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Parse the request event."}),"\n",(0,r.jsx)(n.h3,{id:"xecutestr",children:"XecuteStr"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod XecuteStr(event, ByRef code As %String, wantreturnval As %Boolean) As %String [ Internal, Private ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"String to execute to run the desired method."}),"\n",(0,r.jsx)(n.h3,{id:"cspevent",children:"CSPEvent"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod CSPEvent(%class As %String, %method As %String) As %Status [ Internal, Private, PublicList = rs ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handles events generated by the Java CSPBroker.class. Input parameters can be found in the %request object (an instance of %CSP.Request), as follows:"}),"\n",(0,r.jsxs)(n.p,{children:["WEVENT class.method Invoke 'method' of 'class'",(0,r.jsx)(n.br,{}),"\nWARGC integer Number of arguments",(0,r.jsx)(n.br,{}),"\nWARG_1..WARG_n value Value of argument 'n'"]}),"\n",(0,r.jsx)(n.p,{children:"Output is written back to the [HTML/HTTP] stream, as follows:"}),"\n",(0,r.jsxs)(n.p,{children:["WEBCHD Session handle",(0,r.jsx)(n.br,{}),"\n#status Status code (see below)",(0,r.jsx)(n.br,{}),"\n[error msg] Error message (if status contains 'E')",(0,r.jsx)(n.br,{}),"\njavascript output Zero or more lines of Javascript output",(0,r.jsx)(n.br,{}),"\n...",(0,r.jsx)(n.br,{}),"\n[return value] Return value of event function (if present)",(0,r.jsx)(n.br,{}),"\nValid status codes are:"]}),"\n",(0,r.jsxs)(n.p,{children:["E Error condidition follows",(0,r.jsx)(n.br,{}),"\nR Last line contains return value"]}),"\n",(0,r.jsx)(n.h3,{id:"cspjsevent",children:"CSPJSEvent"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod CSPJSEvent(%class As %String, %method As %String) As %Status [ Internal, Private ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handles events generated by the JavaScript event IFrame method. Input parameters can be found in the %request object (an instance of %CSP.Request), as follows:"}),"\n",(0,r.jsxs)(n.p,{children:["WJSEVENT class.method Invoke 'method' of 'class'",(0,r.jsx)(n.br,{}),"\nWARGC integer Number of arguments",(0,r.jsx)(n.br,{}),"\nWARG_1..WARG_n value Value of argument 'n'"]}),"\n",(0,r.jsx)(n.p,{children:"Output is written back to the [HTML/HTTP] stream as a JavaScript document. The variable CSPPage refers to the page that called this method."}),"\n",(0,r.jsx)(n.h3,{id:"inserterrorheader",children:"InsertErrorHeader"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod InsertErrorHeader() [ Internal ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Output the beginning of an error response"}),"\n",(0,r.jsx)(n.h3,{id:"inserterrorend",children:"InsertErrorEnd"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod InsertErrorEnd() [ Internal ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Output the end of an error response"})]})}function i(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var r=s(96540);const t={},a=r.createContext(t);function l(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);