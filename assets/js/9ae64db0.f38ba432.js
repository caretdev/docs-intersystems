"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[35894],{29820:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>l,default:()=>d,frontMatter:()=>a,toc:()=>i});var r=n(74848),s=n(28453);const a={pagination_prev:null,pagination_next:null},l="OAuth2.Server.Registration",i=[{value:"Parameters",id:"parameters",level:2},{value:"HTTP200OK",id:"http200ok",level:3},{value:"HTTP201CREATED",id:"http201created",level:3},{value:"HTTP204NOCONTENT",id:"http204nocontent",level:3},{value:"HTTP400BADREQUEST",id:"http400badrequest",level:3},{value:"HTTP401UNAUTHORIZED",id:"http401unauthorized",level:3},{value:"HTTP500INTERNALSERVERERROR",id:"http500internalservererror",level:3},{value:"INVALIDMETADATA",id:"invalidmetadata",level:3},{value:"Methods",id:"methods",level:2},{value:"RegisterClient",id:"registerclient",level:3},{value:"ReadClient",id:"readclient",level:3},{value:"UpdateClient",id:"updateclient",level:3},{value:"DeleteClient",id:"deleteclient",level:3},{value:"AuthenticateRequest",id:"authenticaterequest",level:3},{value:"Common",id:"common",level:3},{value:"ReturnClientMetadata",id:"returnclientmetadata",level:3},{value:"GetMetadataFromRequest",id:"getmetadatafromrequest",level:3},{value:"ValidateMetadata",id:"validatemetadata",level:3},{value:"UpdateClientMetadata",id:"updateclientmetadata",level:3},{value:"StatusError",id:"statuserror",level:3},{value:"ReturnError",id:"returnerror",level:3},{value:"GetJWKS",id:"getjwks",level:3},{value:"AddClientSecretToJWKS",id:"addclientsecrettojwks",level:3},{value:"ReturnJWKS",id:"returnjwks",level:3}];function c(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"oauth2serverregistration",children:"OAuth2.Server.Registration"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Class OAuth2.Server.Registration Extends %RegisteredObject [ System = 4 ]\n"})}),"\n",(0,r.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(t.h3,{id:"http200ok",children:"HTTP200OK"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter HTTP200OK As STRING = "200 OK";\n'})}),"\n",(0,r.jsx)(t.h3,{id:"http201created",children:"HTTP201CREATED"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter HTTP201CREATED As STRING = "201 Created";\n'})}),"\n",(0,r.jsx)(t.h3,{id:"http204nocontent",children:"HTTP204NOCONTENT"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter HTTP204NOCONTENT As STRING = "204 No Content";\n'})}),"\n",(0,r.jsx)(t.h3,{id:"http400badrequest",children:"HTTP400BADREQUEST"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter HTTP400BADREQUEST As STRING = "400 Bad Request";\n'})}),"\n",(0,r.jsx)(t.h3,{id:"http401unauthorized",children:"HTTP401UNAUTHORIZED"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter HTTP401UNAUTHORIZED As STRING = "401 Unauthorized";\n'})}),"\n",(0,r.jsx)(t.h3,{id:"http500internalservererror",children:"HTTP500INTERNALSERVERERROR"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter HTTP500INTERNALSERVERERROR As STRING = "500 Internal Server Error";\n'})}),"\n",(0,r.jsx)(t.h3,{id:"invalidmetadata",children:"INVALIDMETADATA"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter INVALIDMETADATA As STRING = "invalid_client_metadata";\n'})}),"\n",(0,r.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(t.h3,{id:"registerclient",children:"RegisterClient"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod RegisterClient() As %Status [ Internal ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Process Dynamic Registration request"}),"\n",(0,r.jsx)(t.h3,{id:"readclient",children:"ReadClient"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod ReadClient() As %Status [ Internal, ServerOnly = 1 ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Read the client metadata for a dynamically registered client"}),"\n",(0,r.jsx)(t.h3,{id:"updateclient",children:"UpdateClient"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod UpdateClient() As %Status [ Internal, ServerOnly = 1 ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Update the client metadata for a dynamically registered client"}),"\n",(0,r.jsx)(t.h3,{id:"deleteclient",children:"DeleteClient"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod DeleteClient() As %Status [ Internal, ServerOnly = 1 ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Process client delete request"}),"\n",(0,r.jsx)(t.h3,{id:"authenticaterequest",children:"AuthenticateRequest"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod AuthenticateRequest(Output client As OAuth2.Server.Client) As %OAuth2.Error [ Private ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Verify the client_id and registration_access_token, and perform common setup tasks"}),"\n",(0,r.jsx)(t.h3,{id:"common",children:"Common"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod Common() As %OAuth2.Error [ Private ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Perform common setup tasks: 1) set up headers 2) require TLS 3) ensure that OAuth2 Server has been configured"}),"\n",(0,r.jsx)(t.h3,{id:"returnclientmetadata",children:"ReturnClientMetadata"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod ReturnClientMetadata(client As OAuth2.Server.Client, isNew As %Boolean = 0) As %OAuth2.Error [ Private ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Update client values from metadata, save client, and output metadata to client"}),"\n",(0,r.jsx)(t.h3,{id:"getmetadatafromrequest",children:"GetMetadataFromRequest"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod GetMetadataFromRequest(Output metadata As OAuth2.Client.Metadata) As %OAuth2.Error [ Private ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Read the metadata sent from client"}),"\n",(0,r.jsx)(t.h3,{id:"validatemetadata",children:"ValidateMetadata"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod ValidateMetadata(client As OAuth2.Server.Client, metadata As OAuth2.Client.Metadata, isNew As %Boolean = 0) As %OAuth2.Error [ Private ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Validate the metadata supplied by the user, and update the client object accordingly If this returns an error, the client should NOT be saved."}),"\n",(0,r.jsx)(t.h3,{id:"updateclientmetadata",children:"UpdateClientMetadata"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod UpdateClientMetadata(client As OAuth2.Server.Client) As %OAuth2.Error [ Private ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Update the client metadata response for the specified client"}),"\n",(0,r.jsx)(t.h3,{id:"statuserror",children:"StatusError"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod StatusError(sc As %Status) As %OAuth2.Error [ Internal ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Return an internal server error"}),"\n",(0,r.jsx)(t.h3,{id:"returnerror",children:"ReturnError"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod ReturnError(error As %OAuth2.Error) [ Internal, ServerOnly = 1 ]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Return error response"}),"\n",(0,r.jsx)(t.h3,{id:"getjwks",children:"GetJWKS"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod GetJWKS(uri As %String, sslConfiguration As %String, Output jwks As %String, Output expires As %Integer) As %Status\n"})}),"\n",(0,r.jsx)(t.p,{children:"Get the JWKS from jwks_uri"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"uri"})," - the value of the jwks_uri"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"sslconfiguration"})," - the name of an SSL Configuration to use to communicate with the remote server"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"jwks"})," (output) - the jwks retrieved from the server"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"expires"})," (output) - The JWKS expiration. This is based on the Cache-Control header sent from the remote server. Possible values are:\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"-1"})," - no expiration"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"0"})," - the JWKS cannot be cached"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"a positive integer"})," - The time in seconds from beginning of the Unix epoch at which the JWKS will expire\n",(0,r.jsx)(t.strong,{children:"Returns:"}),"  A status code indicating success or failure."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"addclientsecrettojwks",children:"AddClientSecretToJWKS"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod AddClientSecretToJWKS(JWKS As %String, clientSecret As %String, Output updatedJWKS As %String) As %Status\n"})}),"\n",(0,r.jsx)(t.p,{children:"Add the client secret to the public JWKS"}),"\n",(0,r.jsx)(t.h3,{id:"returnjwks",children:"ReturnJWKS"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod ReturnJWKS() As %Status\n"})}),"\n",(0,r.jsx)(t.p,{children:"Return this server's public JWKS"})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>i});var r=n(96540);const s={},a=r.createContext(s);function l(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);