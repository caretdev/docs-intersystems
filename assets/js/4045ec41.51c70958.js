"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[55479],{7111:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>l,default:()=>a,frontMatter:()=>r,toc:()=>o});var s=n(74848),i=n(28453);const r={pagination_prev:null,pagination_next:null},l="%Collection.ListOfObj",o=[{value:"Parameters",id:"parameters",level:2},{value:"IdCollection",id:"idcollection",level:3},{value:"Properties",id:"properties",level:2},{value:"Size",id:"size",level:3},{value:"Methods",id:"methods",level:2},{value:"SizeSet",id:"sizeset",level:3},{value:"SizeGet",id:"sizeget",level:3},{value:"IsDefined",id:"isdefined",level:3},{value:"Find",id:"find",level:3},{value:"FindObjectId",id:"findobjectid",level:3},{value:"FindOref",id:"findoref",level:3},{value:"GetAt",id:"getat",level:3},{value:"GetObjectAt",id:"getobjectat",level:3},{value:"GetObjectIdAt",id:"getobjectidat",level:3},{value:"GetNext",id:"getnext",level:3},{value:"GetObjectNext",id:"getobjectnext",level:3},{value:"GetObjectIdNext",id:"getobjectidnext",level:3},{value:"GetPrevious",id:"getprevious",level:3},{value:"GetObjectPrevious",id:"getobjectprevious",level:3},{value:"GetObjectIdPrevious",id:"getobjectidprevious",level:3},{value:"Insert",id:"insert",level:3},{value:"InsertObject",id:"insertobject",level:3},{value:"InsertObjectId",id:"insertobjectid",level:3},{value:"InsertAt",id:"insertat",level:3},{value:"InsertObjectAt",id:"insertobjectat",level:3},{value:"InsertObjectIdAt",id:"insertobjectidat",level:3},{value:"RemoveAt",id:"removeat",level:3},{value:"SetAt",id:"setat",level:3},{value:"SetObjectAt",id:"setobjectat",level:3},{value:"SetObjectIdAt",id:"setobjectidat",level:3},{value:"%UnSwizzleAt",id:"unswizzleat",level:3},{value:"%OnConstructClone",id:"onconstructclone",level:3},{value:"Count",id:"count",level:3},{value:"Next",id:"next",level:3},{value:"Previous",id:"previous",level:3},{value:"Serialize",id:"serialize",level:3},{value:"DeSerialize",id:"deserialize",level:3}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"collectionlistofobj",children:"%Collection.ListOfObj"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Class %Collection.ListOfObj Extends (%Collection.AbstractListOfObj, Super) [ Inheritance = right, System = 2 ]\n"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"For information on this class"}),", see ",(0,s.jsx)(t.a,{href:"/csp/docbook/Doc.View.cls?FIND=CLASSES+%25Collection.ListOfObj",children:"Working with Collections"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"The %Collection.ListOfObj class represents a list of references to objects, each of which is associated with a numeric position in the list. The first element in the list is stored at position 1. The objects referred to must be registered. They can be either persistent objects or non-id objects."}),"\n",(0,s.jsxs)(t.p,{children:['Internally, a %Collection.ListOfObj object contains two lists: one for holding the OID values for the objects referred to (or their serialized state in the case of a list of non-id objects); and another for holding the OREF values for any objects that have been explicitly referred to, and hence "swizzled" into memory. Swizzling (loading an object into memory and generating an OREF value for it) happens automatically whenever the user refers to an object within the list. For example, if list is an %Collection.ListOfObj object containing a list of ',(0,s.jsx)(t.strong,{children:"Doctor"})," objects (that is a list of OID values for ",(0,s.jsx)(t.strong,{children:"Doctor"})," objects stored in the database) then the following code fragment will automatically load the Doctor object at location 7 in the list into memory and generate an OREF value referring to the in-memory version of the ",(0,s.jsx)(t.strong,{children:"Doctor"})," object. This OREF value can then be used to access the properties and methods of the ",(0,s.jsx)(t.strong,{children:"Doctor"})," object: ",(0,s.jsx)(t.code,{children:"Set doc=list.GetAt(7) Write doc.Name"})," Alternatively, we could use cascading dot syntax: ",(0,s.jsx)(t.code,{children:"Set name=list.GetAt(7).Name"})," These %Collection classes can only be used when you have a collection property of another object as they rely on storing the data inside the parent object, they cannot be used as 'standalone' collections, for this use the %ListOfObjects."]}),"\n",(0,s.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsx)(t.h3,{id:"idcollection",children:"IdCollection"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Parameter IdCollection As BOOLEAN = 0;\n"})}),"\n",(0,s.jsx)(t.p,{children:"If true then in the container we have an array of id's rather than an array of oid's"}),"\n",(0,s.jsx)(t.h2,{id:"properties",children:"Properties"}),"\n",(0,s.jsx)(t.h3,{id:"size",children:"Size"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Property Size As %Integer [ Calculated ];\n"})}),"\n",(0,s.jsx)(t.p,{children:"Size is the number of elements contained in the list."}),"\n",(0,s.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(t.h3,{id:"sizeset",children:"SizeSet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SizeSet(newvalue As %Integer) As %Status [ Abstract ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"sizeget",children:"SizeGet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SizeGet() As %Integer [ CodeMode = expression, Final ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"isdefined",children:"IsDefined"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method IsDefined(key As %Integer) As %Boolean [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Returns true (1) if a value is defined at location key, otherwise false (0)."}),"\n",(0,s.jsx)(t.h3,{id:"find",children:"Find"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Find(element As %ObjectIdentity, key As %Integer) As %String\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Starting from, but not including, position key, ",(0,s.jsx)(t.strong,{children:"Find"})," finds the next element in the list whose OID value equals element. If key is a null string, ",(0,s.jsx)(t.strong,{children:"Find"})," starts at the beginning of the list."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Find"}),' returns the position of the found element or null string ("") if no element was found.']}),"\n",(0,s.jsx)(t.h3,{id:"findobjectid",children:"FindObjectId"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method FindObjectId(id As %String, key As %Integer) As %String\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Starting from, but not including, position key, ",(0,s.jsx)(t.strong,{children:"FindObjectId"})," finds the next element in the list whose ObjectId equals id. If key is a null string, ",(0,s.jsx)(t.strong,{children:"Find"})," starts at the beginning of the list."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Find"}),' returns the position of the found element or null string ("") if no element was found.']}),"\n",(0,s.jsx)(t.h3,{id:"findoref",children:"FindOref"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method FindOref(oref As %RegisteredObject, key As %Integer = "", id As %String = "") As %String\n'})}),"\n",(0,s.jsx)(t.p,{children:"Starting from, but not including, location key, finds the next element in the array whose Oref value equals oref."}),"\n",(0,s.jsx)(t.p,{children:'If key is a null string (""), the search starts at the beginning of the array.'}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"FindOref"}),' returns the key associated with the found element or null string ("") if no element is found. Unswizzled references are compared to oref.%Oid() and if equal, swizzling will occur.']}),"\n",(0,s.jsx)(t.h3,{id:"getat",children:"GetAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetAt(key As %Integer) As %RegisteredObject\n"})}),"\n",(0,s.jsx)(t.p,{children:"Finds and returns the OREF value referring to the object at position key in the list."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"GetAt"}),' returns the value of the element at location key or null string ("") if no element is found.']}),"\n",(0,s.jsx)(t.h3,{id:"getobjectat",children:"GetObjectAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectAt(key As %Integer, force As %Integer = 0) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:"Finds and returns the OID value referring to the object at position key in the list."}),"\n",(0,s.jsx)(t.p,{children:'Returns the value of the element at location key or null string ("") if no element is found.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectidat",children:"GetObjectIdAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectIdAt(key As %Integer, force As %Integer = 0) As %String [ CodeMode = expression, Final ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Finds and returns the ID value referring to the object at position key in the list."}),"\n",(0,s.jsx)(t.p,{children:'Returns the value of the element at location key or null string ("") if no element is found.'}),"\n",(0,s.jsx)(t.h3,{id:"getnext",children:"GetNext"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetNext(ByRef key As %Integer) As %RegisteredObject\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OREF value referring to the object at the position after key in the list. If key is a null string (""), it returns the OREF value of the first element in the list.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the position value of the returned element or null string ("") if key is at the end of the list.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectnext",children:"GetObjectNext"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectNext(ByRef key As %Integer) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OID value referring to the object at the position after key in the list. If key is a null string (""), it returns the OID value of the first element in the list.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the position value of the returned element or null string ("") if key is at the end of the list.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectidnext",children:"GetObjectIdNext"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method GetObjectIdNext(ByRef key As %Integer = "") As %String [ CodeMode = expression, Final ]\n'})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the ID value referring to the object at the position after key in the list. If key is a null string (""), it returns the ID value of the first element in the list.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the position value of the returned element or null string ("") if key is at the end of the list.'}),"\n",(0,s.jsx)(t.h3,{id:"getprevious",children:"GetPrevious"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetPrevious(ByRef key As %Integer) As %RegisteredObject\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OREF value referring to the object at the position before key in the list. If key is a null string (""), it returns the OREF value of the last element in the list.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the position value of the returned element or null string ("") if key is at the beginning of the list.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectprevious",children:"GetObjectPrevious"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectPrevious(ByRef key As %Integer) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OID value referring to the object at the position before key in the list. If key is a null string (""), it returns the OID value of the last element in the list.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the position value of the returned element or null string ("") if key is at the beginning of the list.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectidprevious",children:"GetObjectIdPrevious"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectIdPrevious(ByRef key As %Integer) As %String [ CodeMode = expression, Final ]\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the ID value referring to the object at the position before key in the list. If key is a null string (""), it returns the ID value of the last element in the list.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the position value of the returned element or null string ("") if key is at the beginning of the list.'}),"\n",(0,s.jsx)(t.h3,{id:"insert",children:"Insert"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Insert(oref As %RegisteredObject) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Inserts an element with OREF value oref at the end of the list."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"insertobject",children:"InsertObject"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method InsertObject(oid As %ObjectIdentity) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Inserts an element with OID value oid at the end of the list."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"insertobjectid",children:"InsertObjectId"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method InsertObjectId(id As %String) As %Status [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Inserts an element with ID value id at the end of the list."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"insertat",children:"InsertAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method InsertAt(oref As %RegisteredObject, key As %Integer) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Inserts an element with OREF value oref at position key."}),"\n",(0,s.jsx)(t.p,{children:"To make room for the new element, the elements previously at or following position key are moved up by one position."}),"\n",(0,s.jsxs)(t.p,{children:["key must be in the following range: ",(0,s.jsx)(t.code,{children:"1 <= index <= Count() + 1"})," Returns a %Status value indicating success or failure."]}),"\n",(0,s.jsx)(t.h3,{id:"insertobjectat",children:"InsertObjectAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method InsertObjectAt(oid As %ObjectIdentity, key As %Integer) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Inserts an element with OID value oid at position key."}),"\n",(0,s.jsx)(t.p,{children:"To make room for the new element, the elements previously at or following position key are moved up by one position."}),"\n",(0,s.jsxs)(t.p,{children:["key must be in the following range: ",(0,s.jsx)(t.code,{children:"1 <= index <= Count() + 1"})," Returns a %Status value indicating success or failure."]}),"\n",(0,s.jsx)(t.h3,{id:"insertobjectidat",children:"InsertObjectIdAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method InsertObjectIdAt(id As %String, key As %Integer) As %Status [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Inserts an element with ID value id at position key."}),"\n",(0,s.jsx)(t.p,{children:"To make room for the new element, the elements previously at or following position key are moved up by one position."}),"\n",(0,s.jsxs)(t.p,{children:["key must be in the following range: ",(0,s.jsx)(t.code,{children:"1 <= index <= Count() + 1"})," Returns a %Status value indicating success or failure."]}),"\n",(0,s.jsx)(t.h3,{id:"removeat",children:"RemoveAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method RemoveAt(key As %Integer, Output success As %Boolean) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:"Removes the element at position key in the list. The elements following position key are moved to fill in the resulting gap."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"RemoveAt"}),' returns the OID value of the removed element or null string ("") if no element was removed. It also has a success output argument that returns true if the item was removed and false if it was not.']}),"\n",(0,s.jsx)(t.h3,{id:"setat",children:"SetAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SetAt(oref As %RegisteredObject, key As %Integer) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Sets the OREF value of the element at position key to oref."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"setobjectat",children:"SetObjectAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SetObjectAt(oid As %ObjectIdentity, key As %Integer) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Sets the OID value of the element at position key to oid."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"setobjectidat",children:"SetObjectIdAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SetObjectIdAt(id As %String, key As %Integer) As %Status [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Sets the ID value of the element at position key to id."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"unswizzleat",children:"%UnSwizzleAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %UnSwizzleAt(key As %Integer, force As %Integer = 0) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Unswizzles (removes from memory) the individual element at position key in the list."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"onconstructclone",children:"%OnConstructClone"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %OnConstructClone(oref As %RegisteredObject, deep As %Boolean = 0, ByRef cloned As %String) As %Status [ Private ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"count",children:"Count"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Count() As %Integer [ CodeMode = expression, Final ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"next",children:"Next"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Next(key As %Integer = 0) As %Integer [ CodeMode = expression, Final ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"previous",children:"Previous"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Previous(key As %Integer = 0) As %Integer [ CodeMode = expression, Final ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"serialize",children:"Serialize"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method Serialize(force As %Integer = 0) As %String(MAXLEN="")\n'})}),"\n",(0,s.jsx)(t.p,{children:"Serialize() constructs a serialized form of the collection as a string"}),"\n",(0,s.jsx)(t.h3,{id:"deserialize",children:"DeSerialize"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method DeSerialize(serialized As %String(MAXLEN="")) As %Status\n'})})]})}function a(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>o});var s=n(96540);const i={},r=s.createContext(i);function l(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);