"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[23429],{55278:(e,l,a)=>{a.r(l),a.d(l,{contentTitle:()=>o,default:()=>c,frontMatter:()=>t,toc:()=>r});var s=a(74848),n=a(28453);const t={pagination_prev:null,pagination_next:null},o="%Library.Collate",r=[{value:"Methods",id:"methods",level:2},{value:"GetLocalNumber",id:"getlocalnumber",level:3},{value:"GetLocalName",id:"getlocalname",level:3},{value:"SetLocalNumber",id:"setlocalnumber",level:3},{value:"SetLocalName",id:"setlocalname",level:3},{value:"DisplayToLogical",id:"displaytological",level:3},{value:"LogicalToDisplay",id:"logicaltodisplay",level:3},{value:"IsValid",id:"isvalid",level:3},{value:"GetSystemDefaultName",id:"getsystemdefaultname",level:3},{value:"GetSystemDefaultNumber",id:"getsystemdefaultnumber",level:3},{value:"IsValidName",id:"isvalidname",level:3},{value:"IsValidNumber",id:"isvalidnumber",level:3},{value:"MakeArray",id:"makearray",level:3},{value:"CollationListExecute",id:"collationlistexecute",level:3},{value:"CollationListFetch",id:"collationlistfetch",level:3},{value:"CollationListClose",id:"collationlistclose",level:3}];function i(e){const l={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.header,{children:(0,s.jsx)(l.h1,{id:"librarycollate",children:"%Library.Collate"})}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"Class %Library.Collate Extends %Library.Integer [ System = 2 ]\n"})}),"\n",(0,s.jsx)(l.p,{children:"Datatype to handle validation/display of system collations"}),"\n",(0,s.jsx)(l.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(l.h3,{id:"getlocalnumber",children:"GetLocalNumber"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod GetLocalNumber() As %Integer\n"})}),"\n",(0,s.jsx)(l.p,{children:"Return the number of the collation used in local arrays by the current process (e.g. 5)"}),"\n",(0,s.jsx)(l.h3,{id:"getlocalname",children:"GetLocalName"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod GetLocalName() As %String\n"})}),"\n",(0,s.jsx)(l.p,{children:"Return the name of the collation used in local arrays by the current process"}),"\n",(0,s.jsx)(l.h3,{id:"setlocalnumber",children:"SetLocalNumber"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod SetLocalNumber(col As %Integer) As %Status\n"})}),"\n",(0,s.jsxs)(l.p,{children:["Set the collation used by the current process in local arrays",(0,s.jsx)(l.br,{}),"\ncol = collation number (e.g. 5)"]}),"\n",(0,s.jsx)(l.h3,{id:"setlocalname",children:"SetLocalName"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod SetLocalName(col As %String) As %Status\n"})}),"\n",(0,s.jsxs)(l.p,{children:["Set the collation used by the current process in local arrays",(0,s.jsx)(l.br,{}),"\ncol = collation name"]}),"\n",(0,s.jsx)(l.h3,{id:"displaytological",children:"DisplayToLogical"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod DisplayToLogical(CollationName As %String, Flag As %Integer = 0) As %Integer [ ServerOnly = 0 ]\n"})}),"\n",(0,s.jsxs)(l.p,{children:["Convert external collation name or abbreviation to internal number.",(0,s.jsx)(l.br,{}),"\nFlag = 0 - Name to number (default)",(0,s.jsx)(l.br,{}),"\nFlag = 1 - Abbreviation to number",(0,s.jsx)(l.br,{}),"\nFlag = 2 - Name or Abbreviation to number"]}),"\n",(0,s.jsx)(l.h3,{id:"logicaltodisplay",children:"LogicalToDisplay"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod LogicalToDisplay(CollationNumber As %Integer, Flag As %Integer = 0) As %String [ ServerOnly = 0 ]\n"})}),"\n",(0,s.jsxs)(l.p,{children:["Convert internal collation number to external name or abbreviation.",(0,s.jsx)(l.br,{}),"\nFlag = 0 - Number to name (default)",(0,s.jsx)(l.br,{}),"\nFlag = 1 - Number to abbreviation",(0,s.jsx)(l.br,{}),"\nFlag = 2 - Show Old collations"]}),"\n",(0,s.jsx)(l.h3,{id:"isvalid",children:"IsValid"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod IsValid(%Val As %RawString) As %Status [ CodeMode = expression, Internal, ServerOnly = 0 ]\n"})}),"\n",(0,s.jsx)(l.h3,{id:"getsystemdefaultname",children:"GetSystemDefaultName"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod GetSystemDefaultName() As %String\n"})}),"\n",(0,s.jsx)(l.p,{children:"Return the System default collation name."}),"\n",(0,s.jsx)(l.h3,{id:"getsystemdefaultnumber",children:"GetSystemDefaultNumber"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod GetSystemDefaultNumber() As %String\n"})}),"\n",(0,s.jsx)(l.p,{children:"Return the System default collation number."}),"\n",(0,s.jsx)(l.h3,{id:"isvalidname",children:"IsValidName"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod IsValidName(CollationName As %String, Flag As %Integer = 0, Loaded As %Boolean = 1) As %Boolean [ Internal ]\n"})}),"\n",(0,s.jsxs)(l.p,{children:["Verifies that the collation name is valid, and loaded",(0,s.jsx)(l.br,{}),"\nFlag = 0 - Validate name (default)",(0,s.jsx)(l.br,{}),"\nFlag = 1 - Validate abbreviation",(0,s.jsx)(l.br,{}),"\nFlag = 2 - Validate name or abbreviation",(0,s.jsx)(l.br,{}),"\nLoaded = 0 - Don't validate the table is loaded",(0,s.jsx)(l.br,{}),"\nLoaded = 1 - Validate the table is loaded"]}),"\n",(0,s.jsx)(l.h3,{id:"isvalidnumber",children:"IsValidNumber"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod IsValidNumber(CollationNumber As %Integer, Loaded As %Boolean = 1) As %Boolean [ Internal ]\n"})}),"\n",(0,s.jsxs)(l.p,{children:["Verifies that the collation number is valid.",(0,s.jsx)(l.br,{}),"\nLoaded = 0 - Don't validate the table is loaded",(0,s.jsx)(l.br,{}),"\nLoaded = 1 - Validate the table is loaded"]}),"\n",(0,s.jsx)(l.h3,{id:"makearray",children:"MakeArray"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod MakeArray(ByRef Array As %Binary, IsLoaded As %Boolean = 1, OldCollations As %Boolean = 0, Format As %Integer = 1) As %Status [ Internal ]\n"})}),"\n",(0,s.jsxs)(l.p,{children:["Creates an array with the desired collations",(0,s.jsx)(l.br,{}),"\nHelper method used by other methods and ^COLLATE",(0,s.jsx)(l.br,{}),"\nParameters:"]}),"\n",(0,s.jsxs)(l.ul,{children:["\n",(0,s.jsx)(l.li,{children:"Array = Name of the array"}),"\n",(0,s.jsx)(l.li,{children:"IsLoaded = 0: all collations, 1: only loaded collations"}),"\n",(0,s.jsx)(l.li,{children:"OldCollations = 0: only new collations, 1: include old collations"}),"\n",(0,s.jsx)(l.li,{children:'Format=0: Array(num)="status;num;name"'}),"\n",(0,s.jsx)(l.li,{children:"Format=1: Array(name)=$LB(name,abbrv,num,status)"}),"\n",(0,s.jsx)(l.li,{children:'Format=2: Array(num)="name"'}),"\n"]}),"\n",(0,s.jsx)(l.h3,{id:"collationlistexecute",children:"CollationListExecute"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod CollationListExecute(ByRef qHandle As %Binary, IsLoaded As %Boolean = 1, OldCollations As %Boolean = 0) As %Status [ Internal ]\n"})}),"\n",(0,s.jsxs)(l.p,{children:["Returns a list of collations",(0,s.jsx)(l.br,{}),"\nPass IsLoaded=1 to only return loaded collations"]}),"\n",(0,s.jsx)(l.h3,{id:"collationlistfetch",children:"CollationListFetch"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod CollationListFetch(ByRef qHandle As %Binary, ByRef Row As %List, ByRef AtEnd As %Integer = 0) As %Status [ Internal ]\n"})}),"\n",(0,s.jsx)(l.h3,{id:"collationlistclose",children:"CollationListClose"}),"\n",(0,s.jsx)(l.pre,{children:(0,s.jsx)(l.code,{className:"language-objectscript-class",children:"ClassMethod CollationListClose(ByRef qHandle As %Binary) As %Status [ Internal, PlaceAfter = CollationListExecute ]\n"})})]})}function c(e={}){const{wrapper:l}={...(0,n.R)(),...e.components};return l?(0,s.jsx)(l,{...e,children:(0,s.jsx)(i,{...e})}):i(e)}},28453:(e,l,a)=>{a.d(l,{R:()=>o,x:()=>r});var s=a(96540);const n={},t=s.createContext(n);function o(e){const l=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(l):{...l,...e}}),[l,e])}function r(e){let l;return l=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(t.Provider,{value:l},e.children)}}}]);