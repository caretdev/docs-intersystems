"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[37797],{97004:(e,s,n)=>{n.r(s),n.d(s,{contentTitle:()=>l,default:()=>d,frontMatter:()=>a,toc:()=>i});var t=n(74848),r=n(28453);const a={pagination_prev:null,pagination_next:null},l="%CSP.Login",i=[{value:"Parameters",id:"parameters",level:2},{value:"HandleCorsRequest;",id:"handlecorsrequest",level:3},{value:"STYLESHEET;",id:"stylesheet",level:3},{value:"LOGINTITLE",id:"logintitle",level:3},{value:"FAVORITEICON",id:"favoriteicon",level:3},{value:"DOMAIN",id:"domain",level:3},{value:"Methods",id:"methods",level:2},{value:"OnPage",id:"onpage",level:3},{value:"OnLoginPage",id:"onloginpage",level:3},{value:"DrawHEAD",id:"drawhead",level:3},{value:"DrawTitle",id:"drawtitle",level:3},{value:"DrawSTTitle",id:"drawsttitle",level:3},{value:"DrawTitleSection",id:"drawtitlesection",level:3},{value:"OnErrorSetup",id:"onerrorsetup",level:3},{value:"OnSecurityTokenPage",id:"onsecuritytokenpage",level:3},{value:"DrawSTHEAD",id:"drawsthead",level:3},{value:"DrawCSS3STYLE",id:"drawcss3style",level:3},{value:"DrawSTYLE",id:"drawstyle",level:3},{value:"ProcessCorsRequest",id:"processcorsrequest",level:3},{value:"OnHandleOptionsRequest",id:"onhandleoptionsrequest",level:3},{value:"HandleDefaultOptionsRequest",id:"handledefaultoptionsrequest",level:3},{value:"OnHandleCorsRequest",id:"onhandlecorsrequest",level:3},{value:"HandleDefaultCorsRequest",id:"handledefaultcorsrequest",level:3},{value:"SupportedVerbs",id:"supportedverbs",level:3},{value:"OnPreHTTP",id:"onprehttp",level:3}];function o(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"csplogin",children:"%CSP.Login"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Class %CSP.Login Extends %CSP.Page [ System = 3 ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Provide a default login and security-token pages for CSP applications. User can override the look of this page by creating a subclass and overriding the DrawTitle method and the LOGINTITLE parameters."}),"\n",(0,t.jsx)(s.p,{children:"CORS processing for CSP pages that do not inherit from %CSP.REST is also provided here. To turn on CORS assign the application's login page to be a subclass %CSP.Login that has the HandleCorsRequest parameter = 1. In addition, OnHandleCorsRequest and/or OnHandleOptionsRequest methods may be overridden in order to override the default behavior for the application."}),"\n",(0,t.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsx)(s.h3,{id:"handlecorsrequest",children:"HandleCorsRequest;"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter HandleCorsRequest;\n"})}),"\n",(0,t.jsx)(s.p,{children:"This parameter influences the CORS support for the CSP application that has this login page assigned. If set to true (1) then CORS processing is ON. Otherwise CORS processing is OFF."}),"\n",(0,t.jsx)(s.h3,{id:"stylesheet",children:"STYLESHEET;"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter STYLESHEET;\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Name of stylesheet used for login page.",(0,t.jsx)(s.br,{}),"\nNot used by default page: styles come from the DrawSTYLE method."]}),"\n",(0,t.jsx)(s.h3,{id:"logintitle",children:"LOGINTITLE"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter LOGINTITLE = "Login Page";\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Title displayed for login page.",(0,t.jsx)(s.br,{}),"\nUsers can override this value to customize the login page."]}),"\n",(0,t.jsx)(s.h3,{id:"favoriteicon",children:"FAVORITEICON"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter FAVORITEICON As COSEXPRESSION = "$$$ISCFAVORITEICON";\n'})}),"\n",(0,t.jsx)(s.p,{children:"Home favorite icon."}),"\n",(0,t.jsx)(s.h3,{id:"domain",children:"DOMAIN"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter DOMAIN = "%UtilityLogin";\n'})}),"\n",(0,t.jsx)(s.p,{children:"Login page localization domain"}),"\n",(0,t.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(s.h3,{id:"onpage",children:"OnPage"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPage() As %Status\n"})}),"\n",(0,t.jsx)(s.p,{children:"Output the default login page as HTML"}),"\n",(0,t.jsx)(s.h3,{id:"onloginpage",children:"OnLoginPage"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnLoginPage() As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"drawhead",children:"DrawHEAD"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod DrawHEAD(pTitle = "")\n'})}),"\n",(0,t.jsxs)(s.p,{children:["Draw the HEAD section of the login page.",(0,t.jsx)(s.br,{}),"\nUsers can override this method to customize the login page."]}),"\n",(0,t.jsx)(s.h3,{id:"drawtitle",children:"DrawTitle"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DrawTitle(pTitle As %String)\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Draw the title section of the login page.",(0,t.jsx)(s.br,{}),"\npTitle is the title for the page.",(0,t.jsx)(s.br,{}),"\nUsers can override this method to customize the login page."]}),"\n",(0,t.jsx)(s.h3,{id:"drawsttitle",children:"DrawSTTitle"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DrawSTTitle(pTitle As %String)\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Draw the title section of the security token page.",(0,t.jsx)(s.br,{}),"\npTitle is the title for the page.",(0,t.jsx)(s.br,{}),"\nUsers can override this method to customize the security token page."]}),"\n",(0,t.jsx)(s.h3,{id:"drawtitlesection",children:"DrawTitleSection"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DrawTitleSection(ByRef msgs As %String)\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Draw the title section of the page.",(0,t.jsx)(s.br,{}),"\npTitle is the title for the page.",(0,t.jsx)(s.br,{}),"\nUsers can override this method to customize the page title section."]}),"\n",(0,t.jsx)(s.h3,{id:"onerrorsetup",children:"OnErrorSetup"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnErrorSetup(ByRef skipheader As %Boolean) As %Boolean [ ProcedureBlock = 1 ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"onsecuritytokenpage",children:"OnSecurityTokenPage"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnSecurityTokenPage() As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"drawsthead",children:"DrawSTHEAD"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DrawSTHEAD()\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Draw the HEAD section of the security token page.",(0,t.jsx)(s.br,{}),"\nUsers can override this method to customize the security token page."]}),"\n",(0,t.jsx)(s.h3,{id:"drawcss3style",children:"DrawCSS3STYLE"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DrawCSS3STYLE()\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Draw the style definitions for the login page.",(0,t.jsx)(s.br,{}),"\nUsers can override this method to customize the login page."]}),"\n",(0,t.jsx)(s.h3,{id:"drawstyle",children:"DrawSTYLE"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DrawSTYLE()\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Draw the style definitions for the login page.",(0,t.jsx)(s.br,{}),"\nUsers can override this method to customize the login page."]}),"\n",(0,t.jsx)(s.h3,{id:"processcorsrequest",children:"ProcessCorsRequest"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod ProcessCorsRequest(url As %String, requireCors As %String = "") As %Status [ Internal, Private ]\n'})}),"\n",(0,t.jsx)(s.p,{children:"Determine if this request requires CORS processing and if so, dispatch to OnHandleCorsRequest"}),"\n",(0,t.jsx)(s.h3,{id:"onhandleoptionsrequest",children:"OnHandleOptionsRequest"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnHandleOptionsRequest(url As %String) As %Status\n"})}),"\n",(0,t.jsx)(s.p,{children:"This methods provides handling of the options request for this CSP application. Note carefully: If authentication is required then this method will be called before login and as such will have only limited privileges."}),"\n",(0,t.jsx)(s.h3,{id:"handledefaultoptionsrequest",children:"HandleDefaultOptionsRequest"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod HandleDefaultOptionsRequest(url As %String) As %Status [ Internal, Private ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Handle an OPTIONS request for this CSP application"}),"\n",(0,t.jsx)(s.h3,{id:"onhandlecorsrequest",children:"OnHandleCorsRequest"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnHandleCorsRequest(url As %String) As %Status\n"})}),"\n",(0,t.jsx)(s.p,{children:"This is the CORS request handler. User should override this method in their login page if they don't want the default behavior."}),"\n",(0,t.jsx)(s.h3,{id:"handledefaultcorsrequest",children:"HandleDefaultCorsRequest"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod HandleDefaultCorsRequest(url As %String) As %Status [ Internal, Private ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Provide reasonable default handling for a CORS-enabled request for those who 'JUST WANT IT TO WORK'. The allowlist must be populated and the origin must be found in the allowlist for CORS headers to be added to the response."}),"\n",(0,t.jsx)(s.h3,{id:"supportedverbs",children:"SupportedVerbs"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SupportedVerbs(url, Output verbs As %String) As %Status\n"})}),"\n",(0,t.jsx)(s.p,{children:"By default all methods are supported."}),"\n",(0,t.jsx)(s.h3,{id:"onprehttp",children:"OnPreHTTP"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPreHTTP() As %Boolean [ ServerOnly = 1 ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Determine if we need login CSRF tokens and if so add them. If a login page subclass overrides this method it should call this implementation to ensure we set the login CSRF tokens if needed."})]})}function d(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>i});var t=n(96540);const r={},a=t.createContext(r);function l(e){const s=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(a.Provider,{value:s},e.children)}}}]);