"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[66190],{14591:(e,n,s)=>{s.r(n),s.d(n,{contentTitle:()=>o,default:()=>a,frontMatter:()=>i,toc:()=>c});var t=s(74848),r=s(28453);const i={pagination_prev:null,pagination_next:null},o="%Net.DB.Connection",c=[{value:"Properties",id:"properties",level:2},{value:"Host",id:"host",level:3},{value:"Port",id:"port",level:3},{value:"Namespace",id:"namespace",level:3},{value:"Timeout",id:"timeout",level:3},{value:"IsConnected",id:"isconnected",level:3},{value:"Type",id:"type",level:3},{value:"RemoteIPAddress",id:"remoteipaddress",level:3},{value:"RemoteProtocol",id:"remoteprotocol",level:3},{value:"RemoteUnicode",id:"remoteunicode",level:3},{value:"RemoteLocale",id:"remotelocale",level:3},{value:"RemoteJobNumber",id:"remotejobnumber",level:3},{value:"BufferSize",id:"buffersize",level:3},{value:"TCPDevice",id:"tcpdevice",level:3},{value:"SHMFileName",id:"shmfilename",level:3},{value:"SHMSize",id:"shmsize",level:3},{value:"SHMWaitFlag",id:"shmwaitflag",level:3},{value:"SHMTimeout",id:"shmtimeout",level:3},{value:"Device",id:"device",level:3},{value:"MessageId",id:"messageid",level:3},{value:"Methods",id:"methods",level:2},{value:"CreateIris",id:"createiris",level:3},{value:"Close",id:"close",level:3},{value:"IsClosed",id:"isclosed",level:3},{value:"%OnNew",id:"onnew",level:3},{value:"NextMessageId",id:"nextmessageid",level:3},{value:"Connect",id:"connect",level:3},{value:"Disconnect",id:"disconnect",level:3},{value:"%OnClose",id:"onclose",level:3}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"netdbconnection",children:"%Net.DB.Connection"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Class %Net.DB.Connection Extends %RegisteredObject\n"})}),"\n",(0,t.jsx)(n.p,{children:"This class implements the IRIS Native API for Object Script Connection interface. This class should never be instantiated directly, only through %Net.DB.DataSource using the CreateMethod() function."}),"\n",(0,t.jsx)(n.p,{children:"The public interface for this class includes only those items specified here. All other members are internal."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Host"}),(0,t.jsx)(n.th,{children:"property"}),(0,t.jsx)(n.th,{children:"The host specified when establishing the connection"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Port"}),(0,t.jsx)(n.td,{children:"property"}),(0,t.jsx)(n.td,{children:"The port that this connection is connected."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Namespace"}),(0,t.jsx)(n.td,{children:"property"}),(0,t.jsx)(n.td,{children:"The namespace that this connection is connected."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Timeout"}),(0,t.jsx)(n.td,{children:"property"}),(0,t.jsx)(n.td,{children:"The timeout value specified establishing the connection"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"IsClosed"}),(0,t.jsx)(n.td,{children:"method"}),(0,t.jsx)(n.td,{children:"Returns true if this connection instance is no longer connected."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Close"}),(0,t.jsx)(n.td,{children:"method"}),(0,t.jsx)(n.td,{children:"Close this connection."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"CreateIris"}),(0,t.jsx)(n.td,{children:"method"}),(0,t.jsx)(n.td,{children:"Returns an instance of %Net.DB.Iris."})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,t.jsx)(n.h3,{id:"host",children:"Host"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property Host As %String;\n"})}),"\n",(0,t.jsx)(n.h3,{id:"port",children:"Port"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property Port As %Integer;\n"})}),"\n",(0,t.jsx)(n.h3,{id:"namespace",children:"Namespace"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property Namespace As %String;\n"})}),"\n",(0,t.jsx)(n.h3,{id:"timeout",children:"Timeout"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property Timeout As %Integer [ InitialExpression = 5 ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"isconnected",children:"IsConnected"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property IsConnected As %Boolean [ InitialExpression = 0, Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"type",children:"Type"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property Type As %String [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"remoteipaddress",children:"RemoteIPAddress"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property RemoteIPAddress As %String [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"remoteprotocol",children:"RemoteProtocol"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property RemoteProtocol As %Integer [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"remoteunicode",children:"RemoteUnicode"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property RemoteUnicode As %Boolean [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"remotelocale",children:"RemoteLocale"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property RemoteLocale As %String [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"remotejobnumber",children:"RemoteJobNumber"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property RemoteJobNumber As %String [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"buffersize",children:"BufferSize"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property BufferSize As %Integer [ InitialExpression = {1024*1024}, Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"tcpdevice",children:"TCPDevice"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property TCPDevice As %String [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"shmfilename",children:"SHMFileName"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property SHMFileName As %String [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"shmsize",children:"SHMSize"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property SHMSize As %Integer [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"shmwaitflag",children:"SHMWaitFlag"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property SHMWaitFlag As %Boolean [ InitialExpression = 1, Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"shmtimeout",children:"SHMTimeout"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property SHMTimeout As %Integer [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"device",children:"Device"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property Device As %String [ Internal ];\n"})}),"\n",(0,t.jsx)(n.h3,{id:"messageid",children:"MessageId"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property MessageId As %Integer [ InitialExpression = 1, Internal ];\n"})}),"\n",(0,t.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(n.h3,{id:"createiris",children:"CreateIris"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Method CreateIris()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"close",children:"Close"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Method Close() As %Boolean\n"})}),"\n",(0,t.jsx)(n.h3,{id:"isclosed",children:"IsClosed"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Method IsClosed() As %Boolean\n"})}),"\n",(0,t.jsx)(n.h3,{id:"onnew",children:"%OnNew"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Method %OnNew(remoteHost, remotePort, remoteNamespace, bufferSize, timeout, shmFileName, shmSize, shmWaitFlag, shmTimeout) As %Status [ Internal ]\n"})}),"\n",(0,t.jsx)(n.p,{children:'Constructor. parameters: remoteHost [required] "SHM" for shared memory, host address for TCP (plan to allow full shared memory host string to overwrite the other arguments in the future, but this is not supported yet) remotePort [required] port number for TCP connection remoteNamespace [required] namespace to connect to on server bufferSize [optional] TCP buffer size, and also the shared memory size if not specified separately. defaults to 2^20 bytes. timeout [optional] TCP device open timeout, and also the shared memory device timeout if not specified separately. defaults to 5 seconds. shmFileName [optional] name of physical file. defaults to empty string, indicating virtual page file. shmSize [optional] shared memory size. defaults to the TCP buffer size if not specified. shmWaitFlag [optional] controls logging on/off = 1/0. default is logging on = 1. possibly controls other options also, but not sure. shmTimeout [optional] time to wait for shared memory device to open. defaults to the TCP timeout if not specified.'}),"\n",(0,t.jsx)(n.p,{children:"Examples:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'(1) connect and disconnect over TCP/IP \tset conn = ##class(%Net.DB.Connection).%New("127.0.0.1",56773,"USER") \tset tSC = conn.Connect("_SYSTEM","SYS") \tset tSC = conn.Disconnect()  \t(2) connect and disconnect over shared memory \tset conn = ##class(%Net.DB.Connection).%New("SHM",56773,"USER") \tset tSC = conn.Connect("_SYSTEM","SYS") \tset tSC = conn.Disconnect() \n'})}),"\n",(0,t.jsx)(n.h3,{id:"nextmessageid",children:"NextMessageId"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Method NextMessageId() As %Integer [ Final, Internal ]\n"})}),"\n",(0,t.jsx)(n.p,{children:"Increments the MessageId property and returns the value."}),"\n",(0,t.jsx)(n.h3,{id:"connect",children:"Connect"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:'Method Connect(username As %String = "", password As %String = "", autoCommit As %Integer = 1, isolationLevel As %Integer = 2, clientSQLOptions As %Integer = 1, licenseIPAddress As %String = "") As %Status [ Internal ]\n'})}),"\n",(0,t.jsx)(n.p,{children:"Connects to another InterSystems IRIS process via the DBSRV routine. Sends two messages: handshake (HS), connect (CN). parameters: username [required] server username password [required] server password autoCommit [optional] 1=yes,2=no. default is 1=yes. isolationLevel [optional] READ_VERIFIED=3,READ_COMMITTED=2,READ_UNCOMMITTED=1. default is 2=READ_COMMITTED. clientSQLOptions [optional] options supported by client, only for protocol 57+. fastSelect=1,fastInsert=2,Sharding=4,Parallel=8. default is 1=fastSelect only. licenseIPAddress [optional] IP address to use for license ID. only applies to TCP/IP connections."}),"\n",(0,t.jsx)(n.h3,{id:"disconnect",children:"Disconnect"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Method Disconnect() As %Status [ Internal ]\n"})}),"\n",(0,t.jsx)(n.p,{children:"Disconnects from another InterSystems IRIS process via the DBSRV routine. Sends one disconnect message (DC)."}),"\n",(0,t.jsx)(n.h3,{id:"onclose",children:"%OnClose"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Method %OnClose() As %Status [ Internal ]\n"})})]})}function a(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var t=s(96540);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);