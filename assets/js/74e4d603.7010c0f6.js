"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[84548],{28764:(e,s,n)=>{n.r(s),n.d(s,{contentTitle:()=>i,default:()=>d,frontMatter:()=>l,toc:()=>a});var r=n(74848),t=n(28453);const l={pagination_prev:null,pagination_next:null},i="%CSP.PageLookup",a=[{value:"Parameters",id:"parameters",level:2},{value:"CHARSET",id:"charset",level:3},{value:"PRIVATE",id:"private",level:3},{value:"ENCODED",id:"encoded",level:3},{value:"DEFAULTCAPTION",id:"defaultcaption",level:3},{value:"PREDICATELIST",id:"predicatelist",level:3},{value:"NOMATCH",id:"nomatch",level:3},{value:"SEARCHBTN",id:"searchbtn",level:3},{value:"CANCELBTN",id:"cancelbtn",level:3},{value:"CLEARBTN",id:"clearbtn",level:3},{value:"FINDMSG1",id:"findmsg1",level:3},{value:"FINDMSG2",id:"findmsg2",level:3},{value:"FOUNDMSG1;",id:"foundmsg1",level:3},{value:"FOUNDMSG2",id:"foundmsg2",level:3},{value:"SHOWNMSG1",id:"shownmsg1",level:3},{value:"SHOWNMSG2",id:"shownmsg2",level:3},{value:"NOCRITERIA",id:"nocriteria",level:3},{value:"Methods",id:"methods",level:2},{value:"PageName",id:"pagename",level:3},{value:"OnPage",id:"onpage",level:3},{value:"GetPropType",id:"getproptype",level:3},{value:"GetPropSqlName",id:"getpropsqlname",level:3},{value:"ShowNoCriteria",id:"shownocriteria",level:3},{value:"ShowScripts",id:"showscripts",level:3},{value:"ShowStyleSheet",id:"showstylesheet",level:3},{value:"ShowTitle",id:"showtitle",level:3},{value:"ShowCaption",id:"showcaption",level:3},{value:"ShowForm",id:"showform",level:3},{value:"ShowCriteria",id:"showcriteria",level:3},{value:"ShowPredicates",id:"showpredicates",level:3},{value:"ShowSelectChoices",id:"showselectchoices",level:3},{value:"ShowOneChoice",id:"showonechoice",level:3},{value:"ShowSort",id:"showsort",level:3},{value:"ShowResults",id:"showresults",level:3},{value:"BuildSelectStatement",id:"buildselectstatement",level:3},{value:"CreateResultSet",id:"createresultset",level:3}];function c(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"csppagelookup",children:"%CSP.PageLookup"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Class %CSP.PageLookup Extends %CSP.Page [ Not ProcedureBlock, System = 3 ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"CSP page that provides a standard lookup for wizard-generated forms. It expects the following input:"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:(0,r.jsx)(s.strong,{children:"CLASSNAME"})}),(0,r.jsx)(s.th,{children:"Name of class to perform lookup on."}),(0,r.jsx)(s.th,{})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"OBJID"})}),(0,r.jsx)(s.td,{children:"ID of current instance."}),(0,r.jsx)(s.td,{})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"SELECT"})}),(0,r.jsx)(s.td,{children:"A comma-delimited list of fields to display in the search result table. Each field is of the form 'property alias|desc' where alias and"}),(0,r.jsx)(s.td,{children:"desc are optional. If not specified, the WHERE list is used as the SELECT list."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"WHERE"})}),(0,r.jsx)(s.td,{children:"A comma-delimited list of fields to search on. Each field is of the form 'property alias|desc' where alias and"}),(0,r.jsx)(s.td,{children:"desc are optional."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"ORDER"})}),(0,r.jsx)(s.td,{children:"A comma-delimited list of fields used to sort the search results. Each field is of the form 'property |desc' where"}),(0,r.jsx)(s.td,{children:"desc is optional."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"MAXROWS"})}),(0,r.jsx)(s.td,{children:"Maximum rows to display; if missing don't execute query."}),(0,r.jsx)(s.td,{})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"TARGET"})}),(0,r.jsx)(s.td,{children:"URL of page to return to with results."}),(0,r.jsx)(s.td,{})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"CAPTION"})}),(0,r.jsx)(s.td,{children:"Caption for search window."}),(0,r.jsx)(s.td,{})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"OPTIONS"})}),(0,r.jsx)(s.td,{children:"Comma separated list of feature codes. These include popup, create, and clear."}),(0,r.jsx)(s.td,{})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"OBJIDATTR"})}),(0,r.jsx)(s.td,{children:"The name of the OBJID attribute for the associated form."}),(0,r.jsx)(s.td,{})]})]})]}),"\n",(0,r.jsx)(s.p,{children:"Note: For range operations the value in the WHERE parameter contains two values delimited by &."}),"\n",(0,r.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(s.h3,{id:"charset",children:"CHARSET"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter CHARSET = "utf-8";\n'})}),"\n",(0,r.jsx)(s.p,{children:"Make default charset for the page UTF-8."}),"\n",(0,r.jsx)(s.h3,{id:"private",children:"PRIVATE"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter PRIVATE = 1;\n"})}),"\n",(0,r.jsx)(s.p,{children:"Override PRIVATE from %CSP.Page"}),"\n",(0,r.jsx)(s.h3,{id:"encoded",children:"ENCODED"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter ENCODED = 1;\n"})}),"\n",(0,r.jsx)(s.p,{children:"Override ENCODED from %CSP.Page"}),"\n",(0,r.jsx)(s.h3,{id:"defaultcaption",children:"DEFAULTCAPTION"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter DEFAULTCAPTION = "IRIS Search";\n'})}),"\n",(0,r.jsx)(s.p,{children:"Caption displayed if none specified (for normal mode)."}),"\n",(0,r.jsx)(s.h3,{id:"predicatelist",children:"PREDICATELIST"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter PREDICATELIST = "equals,not equal to,starts with,between,less than,greater than,contains,select";\n'})}),"\n",(0,r.jsx)(s.p,{children:"List of values displayed in search predicate combo box."}),"\n",(0,r.jsx)(s.h3,{id:"nomatch",children:"NOMATCH"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter NOMATCH = "No matching items found.";\n'})}),"\n",(0,r.jsx)(s.p,{children:"No matching items message."}),"\n",(0,r.jsx)(s.h3,{id:"searchbtn",children:"SEARCHBTN"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter SEARCHBTN = "Search";\n'})}),"\n",(0,r.jsx)(s.p,{children:"Caption for Search Button."}),"\n",(0,r.jsx)(s.h3,{id:"cancelbtn",children:"CANCELBTN"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter CANCELBTN = "Cancel";\n'})}),"\n",(0,r.jsx)(s.p,{children:"Caption for Cancel Button."}),"\n",(0,r.jsx)(s.h3,{id:"clearbtn",children:"CLEARBTN"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter CLEARBTN = "Clear";\n'})}),"\n",(0,r.jsx)(s.p,{children:"Caption for Clear Button."}),"\n",(0,r.jsx)(s.h3,{id:"findmsg1",children:"FINDMSG1"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter FINDMSG1 = "Find all instances of ";\n'})}),"\n",(0,r.jsx)(s.p,{children:'First half of "Find all" message.'}),"\n",(0,r.jsx)(s.h3,{id:"findmsg2",children:"FINDMSG2"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter FINDMSG2 = " that meet the following conditions:";\n'})}),"\n",(0,r.jsx)(s.p,{children:'Second half of "Find all" message.'}),"\n",(0,r.jsx)(s.h3,{id:"foundmsg1",children:"FOUNDMSG1;"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter FOUNDMSG1;\n"})}),"\n",(0,r.jsx)(s.p,{children:'First half of "Items Found" message.'}),"\n",(0,r.jsx)(s.h3,{id:"foundmsg2",children:"FOUNDMSG2"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter FOUNDMSG2 = " matching item(s) found.";\n'})}),"\n",(0,r.jsx)(s.p,{children:'Second half of "Items Found" message.'}),"\n",(0,r.jsx)(s.h3,{id:"shownmsg1",children:"SHOWNMSG1"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter SHOWNMSG1 = "The first ";\n'})}),"\n",(0,r.jsx)(s.p,{children:'First half of "Items Shown" message.'}),"\n",(0,r.jsx)(s.h3,{id:"shownmsg2",children:"SHOWNMSG2"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter SHOWNMSG2 = " are displayed below:";\n'})}),"\n",(0,r.jsx)(s.p,{children:'Second half of "Items Shown" message.'}),"\n",(0,r.jsx)(s.h3,{id:"nocriteria",children:"NOCRITERIA"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter NOCRITERIA = "At least one search condition must be specified.  Search not executed.";\n'})}),"\n",(0,r.jsx)(s.p,{children:"Error message to display when no criteria are specified for a search and the search button is pressed."}),"\n",(0,r.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(s.h3,{id:"pagename",children:"PageName"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod PageName() As %String [ CodeMode = generator ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"URL Name of this class"}),"\n",(0,r.jsx)(s.h3,{id:"onpage",children:"OnPage"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPage() As %Status [ Final ]\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Event handler for ",(0,r.jsx)(s.strong,{children:"PAGE"})," event: this is invoked in order to display a csp page."]}),"\n",(0,r.jsx)(s.h3,{id:"getproptype",children:"GetPropType"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetPropType(classname As %String, prop As %String) As %List [ Final ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Returns the type (SQL Category) of property prop for class classname."}),"\n",(0,r.jsx)(s.h3,{id:"getpropsqlname",children:"GetPropSqlName"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetPropSqlName(classname As %String, prop As %String, ByRef column As %String) As %Status [ Final ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Returns the SQL name of property prop for class classname in field."}),"\n",(0,r.jsx)(s.h3,{id:"shownocriteria",children:"ShowNoCriteria"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowNoCriteria() [ Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display an error message when search criteria must be specified before a search is requested (OPTIONS=CriteriaRequired) and no criteria are specified."}),"\n",(0,r.jsx)(s.h3,{id:"showscripts",children:"ShowScripts"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowScripts() [ Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display the client scripts for the lookup page."}),"\n",(0,r.jsx)(s.p,{children:"This has to be called within the HEAD section of the document."}),"\n",(0,r.jsx)(s.h3,{id:"showstylesheet",children:"ShowStyleSheet"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowStyleSheet() [ Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display the HTML Style Sheet for the lookup page."}),"\n",(0,r.jsx)(s.p,{children:"This has to be called within the HEAD section of the document."}),"\n",(0,r.jsx)(s.h3,{id:"showtitle",children:"ShowTitle"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowTitle() [ Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display the title for a lookup page."}),"\n",(0,r.jsx)(s.h3,{id:"showcaption",children:"ShowCaption"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowCaption() [ Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display the caption for a lookup page."}),"\n",(0,r.jsx)(s.h3,{id:"showform",children:"ShowForm"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowForm(classname As %String, where As %List, select As %List, currval As %String) [ Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display the criteria form for a lookup page."}),"\n",(0,r.jsx)(s.p,{children:"where is $list of criteria, each element is $LB(name,pred,val,alias)"}),"\n",(0,r.jsx)(s.p,{children:"select is $list of fields that can be sorted on"}),"\n",(0,r.jsx)(s.p,{children:"currval is current sort field"}),"\n",(0,r.jsx)(s.h3,{id:"showcriteria",children:"ShowCriteria"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowCriteria(classname As %String, where As %List) [ Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display the criteria form for a lookup page."}),"\n",(0,r.jsx)(s.p,{children:"where is $list of criteria, each element is $LB(name,pred,val...)"}),"\n",(0,r.jsx)(s.h3,{id:"showpredicates",children:"ShowPredicates"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowPredicates(name As %String, pred As %String, showOptions As %Boolean) [ Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display a list of predicates in a SELECT box."}),"\n",(0,r.jsx)(s.h3,{id:"showselectchoices",children:"ShowSelectChoices"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowSelectChoices(classname As %String, name As %String, initval As %String, pred As %String) [ Private, ProcedureBlock = 1 ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display the choices for a select predicate."}),"\n",(0,r.jsx)(s.h3,{id:"showonechoice",children:"ShowOneChoice"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowOneChoice(val As %String, id As %String, initval As %String) [ Private, ProcedureBlock = 1 ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display a choice option."}),"\n",(0,r.jsx)(s.h3,{id:"showsort",children:"ShowSort"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowSort(select As %List, currval As %String) [ Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Display the sort options for a lookup page."}),"\n",(0,r.jsx)(s.p,{children:"select is a list of selected fields."}),"\n",(0,r.jsx)(s.h3,{id:"showresults",children:"ShowResults"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod ShowResults(classname As %String, select As %List, where As %List, sort As %List, maxrows As %Integer, showcount As %Boolean = 1, idname As %String = "") As %Status [ Private ]\n'})}),"\n",(0,r.jsx)(s.p,{children:"Display the results of the lookup in an HTML table."}),"\n",(0,r.jsx)(s.h3,{id:"buildselectstatement",children:"BuildSelectStatement"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod BuildSelectStatement(class As %String, proplist As %List, ByRef statement As %String, getcount As %Boolean = 0, idname As %String = "", select As %String = "SELECT", Output idfield As %Integer) As %Status\n'})}),"\n",(0,r.jsx)(s.p,{children:"Constructs a SELECT statement for the property list proplist."}),"\n",(0,r.jsx)(s.h3,{id:"createresultset",children:"CreateResultSet"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod CreateResultSet(class As %String, restrict As %List, return As %List, orderby As %List, getcount As %Boolean, ByRef resultset As %ResultSet, ByRef rcount As %Integer, idname As %String = "", ByRef idfield As %Integer) As %Status\n'})}),"\n",(0,r.jsx)(s.p,{children:"Constructs a query using the input values, opens a %ResultSet object using this query and returns it via resultset."}),"\n",(0,r.jsx)(s.p,{children:"class"}),"\n",(0,r.jsx)(s.p,{children:"The name of the class to perform the lookup on."}),"\n",(0,r.jsx)(s.p,{children:"restrict"}),"\n",(0,r.jsx)(s.p,{children:"A list of restrictions as $lb(property,value)."}),"\n",(0,r.jsx)(s.p,{children:"return"}),"\n",(0,r.jsx)(s.p,{children:"A $list of properties to return in the resultset."}),"\n",(0,r.jsx)(s.p,{children:"orderby"}),"\n",(0,r.jsx)(s.p,{children:"A list of $lb(property,ASC|DESC) that specify the order of the result set."}),"\n",(0,r.jsx)(s.p,{children:"getcount"}),"\n",(0,r.jsx)(s.p,{children:"If true, the query should fetch the number of rows in the result."}),"\n",(0,r.jsx)(s.p,{children:"resultset"}),"\n",(0,r.jsx)(s.p,{children:"Returns a %ResultSet object by reference."}),"\n",(0,r.jsx)(s.p,{children:"rcount"}),"\n",(0,r.jsx)(s.p,{children:"Returns number of selected rows by reference. -1 indicates that the row count is in column 1 of the result set."}),"\n",(0,r.jsx)(s.p,{children:"Returns a %Status indicating success or failure."})]})}function d(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>a});var r=n(96540);const t={},l=r.createContext(t);function i(e){const s=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(l.Provider,{value:s},e.children)}}}]);