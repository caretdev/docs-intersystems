"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[76519],{85374:(e,s,t)=>{t.r(s),t.d(s,{contentTitle:()=>a,default:()=>c,frontMatter:()=>i,toc:()=>l});var n=t(74848),r=t(28453);const i={pagination_prev:null,pagination_next:null},a="%CSP.Page",l=[{value:"Parameters",id:"parameters",level:2},{value:"ENCODED",id:"encoded",level:3},{value:"PRIVATE",id:"private",level:3},{value:"CSPFILE;",id:"cspfile",level:3},{value:"CSPURL;",id:"cspurl",level:3},{value:"CSPINCLUDES",id:"cspincludes",level:3},{value:"CONTENTTYPE;",id:"contenttype",level:3},{value:"CHARSET;",id:"charset",level:3},{value:"NOCHARSETCONVERT;",id:"nocharsetconvert",level:3},{value:"CONVERTINPUTSTREAM",id:"convertinputstream",level:3},{value:"ERRORPAGE;",id:"errorpage",level:3},{value:"EXPIRES",id:"expires",level:3},{value:"TIMINGSLOTS",id:"timingslots",level:3},{value:"PAGETIMING",id:"pagetiming",level:3},{value:"DOMAIN;",id:"domain",level:3},{value:"CSPXHTML;",id:"cspxhtml",level:3},{value:"CSPSTRICT;",id:"cspstrict",level:3},{value:"SECURITYRESOURCE",id:"securityresource",level:3},{value:"UseSession",id:"usesession",level:3},{value:"Methods",id:"methods",level:2},{value:"IsPrivate",id:"isprivate",level:3},{value:"Page",id:"page",level:3},{value:"ShowError",id:"showerror",level:3},{value:"ThrowError",id:"throwerror",level:3},{value:"OnPreHTTP",id:"onprehttp",level:3},{value:"OnPreHyperEvent",id:"onprehyperevent",level:3},{value:"OnPostHyperEvent",id:"onposthyperevent",level:3},{value:"OnHTTPHeader",id:"onhttpheader",level:3},{value:"OnPage",id:"onpage",level:3},{value:"OnPostHTTP",id:"onposthttp",level:3},{value:"OnPageError",id:"onpageerror",level:3},{value:"Link",id:"link",level:3},{value:"Encrypt",id:"encrypt",level:3},{value:"EncryptBroker",id:"encryptbroker",level:3},{value:"Decrypt",id:"decrypt",level:3},{value:"EscapeURL",id:"escapeurl",level:3},{value:"UnescapeURL",id:"unescapeurl",level:3},{value:"EscapeHTML",id:"escapehtml",level:3},{value:"UnescapeHTML",id:"unescapehtml",level:3},{value:"QuoteJS",id:"quotejs",level:3},{value:"RewriteURL",id:"rewriteurl",level:3},{value:"Include",id:"include",level:3},{value:"HyperEventHead",id:"hypereventhead",level:3},{value:"HyperEventBody",id:"hypereventbody",level:3},{value:"HyperEventFrame",id:"hypereventframe",level:3},{value:"HyperEventCall",id:"hypereventcall",level:3},{value:"InsertHiddenFields",id:"inserthiddenfields",level:3},{value:"InsertHiddenField",id:"inserthiddenfield",level:3},{value:"ConvertParameter",id:"convertparameter",level:3},{value:"StartTimer",id:"starttimer",level:3},{value:"StopTimer",id:"stoptimer",level:3}];function o(e){const s={a:"a",br:"br",code:"code",em:"em",form:"form",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"csppage",children:"%CSP.Page"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Class %CSP.Page Extends %Library.Base [ Abstract, System = 3 ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:["The %CSP.Page object serves as an event handler for CSP requests. All .csp pages by default derive from %CSP.Page, although you can override this using the ",(0,n.jsx)(s.a,{href:"CSP:CLASS",children:"CSP:CLASS"})," tag. CSP Servlets can be created by deriving a class from %CSP.Page, see %CSP.StreamServer as an example."]}),"\n",(0,n.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsx)(s.h3,{id:"encoded",children:"ENCODED"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter ENCODED = 0;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Controls how the query parameters for this page are passed, it can be set to one of the following:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"ENCODED=0"})," - Query parameters are not encrypted"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"ENCODED=1"})," - Query parameters are encrypted and passed within CSPToken"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"ENCODED=2"})," - Same as '1' except any unencrypted parameters are removed from the %request object before calling the Page method. This ensures that only encrypted parameter are available in the %CSP.Request object."]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"private",children:"PRIVATE"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter PRIVATE = 0;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Controls the access to the page, it can be set to one of the following:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"PRIVATE=0"})," - Page can be linked to/bookmarked"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"PRIVATE=1"})," - Can only be referenced from another CSP page\nThe user needs initially to enter the site through a PUBLIC page."]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"cspfile",children:"CSPFILE;"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter CSPFILE;\n"})}),"\n",(0,n.jsx)(s.p,{children:"If this page was compiled from a .csp file, then this parameter contains the filename used for compilation."}),"\n",(0,n.jsx)(s.h3,{id:"cspurl",children:"CSPURL;"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter CSPURL;\n"})}),"\n",(0,n.jsxs)(s.p,{children:["This parameter is used to make sure that if multiple CSP applications are mapped to the same namespace that the CSP engine can correctly identify which class corresponds with which URL. If 'LockCSPName' is true (the default, defined in the CSP application) then you can only access this page if the url exactly matches this 'CSPURL'. You can set this parameter to \"\" if you wish to disable this check for this class. This check is applied for all CSP urls (cls/csp/zen).",(0,n.jsx)(s.br,{}),"\nIf this page was compiled from a .csp file, then this parameter is automatically set to contain the url of this file used for compilation."]}),"\n",(0,n.jsx)(s.h3,{id:"cspincludes",children:"CSPINCLUDES"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter CSPINCLUDES [ Internal ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Used to keep track of include files this page uses for dependency checking if this page is still up to date. Only relevant for .csp files and not for class based pages."}),"\n",(0,n.jsx)(s.h3,{id:"contenttype",children:"CONTENTTYPE;"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter CONTENTTYPE;\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Specifies the default content type for the page. This can be overriden using the <CSP:CONTENT TYPE=> tag, or by setting the ",(0,n.jsx)(s.strong,{children:"%response"}),".ContentType property in the OnPreHTTP method. The default value if this parameter is not set is text/html."]}),"\n",(0,n.jsx)(s.h3,{id:"charset",children:"CHARSET;"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter CHARSET;\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Specifies the default character set for the page. This can be overriden using the <CSP:CONTENT CHARSET=> tag, or by setting the ",(0,n.jsx)(s.strong,{children:"%response"}),".CharSet property in the OnPreHTTP method. If this parameter is not specified, then for the default charset is utf-8."]}),"\n",(0,n.jsx)(s.h3,{id:"nocharsetconvert",children:"NOCHARSETCONVERT;"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter NOCHARSETCONVERT;\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Specifies if we wish to turn off charset conversion for this page. Normally CSP uses the tables built into InterSystems IRIS to convert between different charset's, however if you do not have a charset available you may wish to turn this off to avoid getting the error page saying that this charset is not installed. Then the data will be output and read in using RAW mode. This can be overridden using the <CSP:CONTENT NOCHARSETCONVERT=1> tag, or by setting the ",(0,n.jsx)(s.strong,{children:"%response"}),".NoCharSetConvert property in the OnPreHTTP method."]}),"\n",(0,n.jsx)(s.h3,{id:"convertinputstream",children:"CONVERTINPUTSTREAM"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter CONVERTINPUTSTREAM = 0;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Specifies if input %request.Content or %request.MimeData values are converted from their original character set on input. By default (0) we do not modify these and receive them as a binary stream which may need to be converted manually later. If 1 then if there is a 'charset' value in the request Content-Type or mime section we will convert from this charset when the input data is text based. For either json or xml data with no charset this will convert from utf-8 or honor the BOM if one is present."}),"\n",(0,n.jsx)(s.h3,{id:"errorpage",children:"ERRORPAGE;"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter ERRORPAGE;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Specify a custom error page to call if there are any problems with generating this page. If this is not specified it will use the default error page specified for this CSP application, and if this is not specified it will use the system default error page. For example this could be set to '/csp/samples/error.csp' to display the sample error page."}),"\n",(0,n.jsx)(s.h3,{id:"expires",children:"EXPIRES"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter EXPIRES = -1;\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Specified the default value for the %response.Expires.",(0,n.jsx)(s.br,{}),"\nIt can be set to one of the following values:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"-1"}),": Expire immediately, this is the default for a CSP page"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"0"}),": Expire immediately, this also sets the 'no-store' option so using the back button will request a new page"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:'""'}),": Never expire (no HTTP Expires header is sent)"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"nnnnn"}),": Number of seconds from now when the object should expire"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Thu, 29 Oct 1998 17:04:19 GMT"}),": Absolute time at which the object should expire"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"ddddd,sssss"}),": Absolute time the object should expire in $ZTimeStamp format. Note that this must be specified in the GMT timezone\nNote that setting this header also effects the 'Cache-Control' and 'Pragma' headers. If the page is set to expire immediately then it will send a 'Cache-Control: no-cache' and 'Pragma: no-cache' to prevent any caches from storing the page. If the page is set to never expires then it will not send any 'Cache-Control' or 'Pragma' headers. If you set an expires date then it will not modify the 'Cache-Control' or 'Pragma' headers so if they are set they will be sent as specified and if you did not set them then nothing will be sent for these headers."]}),"\n"]}),"\n",(0,n.jsx)(s.h3,{id:"timingslots",children:"TIMINGSLOTS"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter TIMINGSLOTS = 48;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Used by the timing to decide how many slots a day should be divided up into. The default is to record the timings over half an hour (48 slots per day). If you need more detail you can modify this value in the superclass."}),"\n",(0,n.jsx)(s.h3,{id:"pagetiming",children:"PAGETIMING"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter PAGETIMING = 0;\n"})}),"\n",(0,n.jsx)(s.p,{children:"If this parameter is true then we automatically record timing statistics of how long it takes to produce this page. It is off by default."}),"\n",(0,n.jsx)(s.h3,{id:"domain",children:"DOMAIN;"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter DOMAIN;\n"})}),"\n",(0,n.jsx)(s.p,{children:"The default domain for csp:text, span and div tags. This parameter is used to specify the subset of localized messages to be used on this page."}),"\n",(0,n.jsx)(s.h3,{id:"cspxhtml",children:"CSPXHTML;"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter CSPXHTML;\n"})}),"\n",(0,n.jsx)(s.p,{children:"The CSPXHTML parameter is set to 1, if the DOCTYPE indicates that this is an XHTML page."}),"\n",(0,n.jsx)(s.h3,{id:"cspstrict",children:"CSPSTRICT;"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter CSPSTRICT;\n"})}),"\n",(0,n.jsx)(s.p,{children:"The CSPSTRICT parameter is set to 1, if the DOCTYPE indicates that this is a strict or frameset XHTML or HTML 4 page."}),"\n",(0,n.jsx)(s.h3,{id:"securityresource",children:"SECURITYRESOURCE"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter SECURITYRESOURCE As STRING;\n"})}),"\n",(0,n.jsxs)(s.p,{children:["This is a comma-delimited list of system Resources and associated permissions. A user must hold the specified permissions on all of the specified resources in order to view this page.",(0,n.jsx)(s.br,{}),"\nThe format of each item in the list should be as follows:",(0,n.jsx)(s.br,{}),"\nResource[:Permission]",(0,n.jsx)(s.br,{}),"\nPermission is optional, and defaults to USE if not supplied. If it is supplied, it should be one of USE, READ or WRITE. You can also specify or grouping using the '|' character, so 'R1,R2|R3,R3|R4' means you must have resource R1 and one of R2 or R3 and one of R3 or R4. So if you have R1,R3 it will pass, if you have R1,R4 it will not as it does not meet the R2|R3 condition. So the '|' or condition takes precedence over the ',' and condition."]}),"\n",(0,n.jsx)(s.h3,{id:"usesession",children:"UseSession"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter UseSession As BOOLEAN = 1;\n"})}),"\n",(0,n.jsx)(s.p,{children:"This parameter controls the CSP session support. By default CSP will use a persistent session which holds a license until the session is ended or times out. If you override this then this CSP page will use a transient session which is never persisted."}),"\n",(0,n.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(s.h3,{id:"isprivate",children:"IsPrivate"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod IsPrivate() As %Boolean [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Returns 1 if this page is in fact a private page (see PRIVATE)."}),"\n",(0,n.jsx)(s.h3,{id:"page",children:"Page"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Page(skipheader As %Boolean = 1) As %Status [ CodeMode = generator, GenerateAfter = (OnPreHTTP, OnPostHTTP, OnErrorSetup), ServerOnly = 1 ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Process a request to serve a CSPPage. This method is invoked by the ",(0,n.jsx)(s.em,{children:"CSP Server"}),". In turn, this method invokes:"]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.strong,{children:"OnPreHTTP()"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.strong,{children:"OnPage()"})}),"\n",(0,n.jsx)(s.li,{children:(0,n.jsx)(s.strong,{children:"OnPostHTTP()"})}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["Note that OnPostHTTP() always gets run, even if there was an error.",(0,n.jsx)(s.br,{}),"\nskipheader will skip the running of the OnPreHTTP() method."]}),"\n",(0,n.jsx)(s.h3,{id:"showerror",children:"ShowError"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShowError(sc As %Status) [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Display a %Status error code to the CSP Page."}),"\n",(0,n.jsx)(s.h3,{id:"throwerror",children:"ThrowError"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ThrowError(sc As %Status) [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Passed a %Status code this goes to the error page passing this status code"}),"\n",(0,n.jsx)(s.h3,{id:"onprehttp",children:"OnPreHTTP"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPreHTTP() As %Boolean [ Abstract, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Event handler for ",(0,n.jsx)(s.strong,{children:"PreHTTP"})," event: this is invoked before the HTTP headers for a CSP page have been sent. All changes to the %CSP.Response class, such as adding cookies, HTTP headers, setting the content type etc. must be made from within the OnPreHTTP() method. Also changes to the state of the CSP application such as changing %session.EndSession or %session.AppTimeout must be made within the OnPreHTTP() method. It is prefered that changes to %session.Preserve are also made in the OnPreHTTP() method as this is more efficient, although it is supported in any section of the page. Return ",(0,n.jsx)(s.strong,{children:"0"})," to prevent OnPage from being called."]}),"\n",(0,n.jsx)(s.h3,{id:"onprehyperevent",children:"OnPreHyperEvent"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPreHyperEvent(class As %String, method As %String) As %Status [ CodeMode = expression, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Event handler which is invoked before a hyperevent method is called on this page. This gives you a chance to modify the behavior of every hyperevent call within this page. Return an error code to prevent the hyperevent from being called."}),"\n",(0,n.jsx)(s.h3,{id:"onposthyperevent",children:"OnPostHyperEvent"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPostHyperEvent(class As %String, method As %String) As %Status [ CodeMode = expression, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Event handler which is invoked after a hyperevent method is called on this page."}),"\n",(0,n.jsx)(s.h3,{id:"onhttpheader",children:"OnHTTPHeader"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnHTTPHeader(ByRef OutputBody As %Boolean) As %Status [ Abstract, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Event handler for ",(0,n.jsx)(s.strong,{children:"PAGE"})," event: this is invoked in order to send HTTP headers. The default action is to invoke the WriteHTTPHeader() of the %CSP.Response which generates HTTP 1.0 standard headers. Set OutputBody to 0 to prevent prevent OnPage from being called, leave it unchanged otherwise. Returns a %Status code."]}),"\n",(0,n.jsx)(s.h3,{id:"onpage",children:"OnPage"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPage() As %Status [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Event handler for ",(0,n.jsx)(s.strong,{children:"PAGE"})," event: this is invoked in order to generate the content of a csp page."]}),"\n",(0,n.jsx)(s.h3,{id:"onposthttp",children:"OnPostHTTP"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPostHTTP() [ Abstract, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Event handler for ",(0,n.jsx)(s.strong,{children:"POSTPAGE"})," event: this is invoked after the data for the CSP page has been sent to the browser from the the InterSystems IRIS server."]}),"\n",(0,n.jsx)(s.h3,{id:"onpageerror",children:"OnPageError"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPageError(ByRef sc As %Status) [ Abstract, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Event handler for any error that occurs on the page. If an error occurs and this method is defined it calls this method passing it the error code by reference. You may change the error code if wished, if you set it to $$$OK then it will cancel the error and the CSP error page will not be displayed."}),"\n",(0,n.jsx)(s.h3,{id:"link",children:"Link"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Link(link As %String, ByRef query As %String, addQ As %Boolean = 0) As %String [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Tranforms the link specified by link into a URL and returns it as a string."}),"\n",(0,n.jsx)(s.p,{children:"The URL may be encrypted."}),"\n",(0,n.jsx)(s.p,{children:'The array, query, contains an optional set of name-value pairs which are added to the URL. For example \'Set query("name")="data"\''}),"\n",(0,n.jsx)(s.p,{children:"If the optional argument addQ is true, then a ? or &, as appropriate, is added to end of the URL"}),"\n",(0,n.jsx)(s.h3,{id:"encrypt",children:"Encrypt"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Encrypt(data As %Binary) As %String [ CodeMode = expression, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Encrypts the input string using the %session.Key value that is unique to this user session. The output string is a string that can be included in HTML and in URLs as it does not contain any characters that need to be escaped in these environments. It can be decrypted with the Decrypt."}),"\n",(0,n.jsx)(s.p,{children:"Note that the data must not contain any unicode characters as the encryption function just takes a byte stream. If you wish to encrypt unicode data then the simplest way is to form a $listbuild of the string first to convert it into a byte stream."}),"\n",(0,n.jsx)(s.p,{children:"This function should only be used to encrypt server side data, do not make this function available from a client or allow data passed from a client say as a url parameter to be encrypted and returned to the client. If you do this will break the CSP security model as a client will be able to ask the server to encrypt any value they choose and so the server can not rely on the decrypted values as a client will be able to create and pass any encrypted value they want. Also you only want to encrypt data which is valid for this entire session, so be aware that data that page a.csp encrypted could be copied by a client and inserted into a request for page b.csp."}),"\n",(0,n.jsx)(s.h3,{id:"encryptbroker",children:"EncryptBroker"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod EncryptBroker(data As %Binary) As %String [ CodeMode = expression, Internal, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.h3,{id:"decrypt",children:"Decrypt"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Decrypt(data As %String) As %Binary [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Decrypts the input string using the %session.Key value that is unique to this user session. The input string is the string provided by the Encrypt method, the output is the decoded string."}),"\n",(0,n.jsx)(s.h3,{id:"escapeurl",children:"EscapeURL"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod EscapeURL(in As %String, charset As %String) As %String [ CodeMode = expression, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method converts the in input URL string into Escaped URL string. Note that '/' is not escaped which is consistent with rfc3986. The conversion first encodes the string using the current devices charset and then url encodes the result. If you pass in charset then we will use this rather than the current devices charset for the encoding."}),"\n",(0,n.jsx)(s.h3,{id:"unescapeurl",children:"UnescapeURL"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod UnescapeURL(in As %String, charset As %String) As %String [ CodeMode = expression, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method converts the in Escaped URL string back to its original form. The conversion first unescapes the URL then decodes the string using the current devices charset. If you pass in charset then we will use this rather than the current devices charset for the decoding."}),"\n",(0,n.jsx)(s.h3,{id:"escapehtml",children:"EscapeHTML"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod EscapeHTML(in) As %String [ CodeMode = expression, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method converts input HTML text into Escaped HTML text."}),"\n",(0,n.jsx)(s.h3,{id:"unescapehtml",children:"UnescapeHTML"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod UnescapeHTML(in) As %String [ CodeMode = expression, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method converts Escaped HTML text into normal HTML text"}),"\n",(0,n.jsx)(s.h3,{id:"quotejs",children:"QuoteJS"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod QuoteJS(in) As %String [ CodeMode = expression, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method converts input string into quoted JavaScript literal"}),"\n",(0,n.jsx)(s.h3,{id:"rewriteurl",children:"RewriteURL"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod RewriteURL(url As %String) As %String [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method will rewrite a URL to use #url()# if needed"}),"\n",(0,n.jsx)(s.h3,{id:"include",children:"Include"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Include(url As %String) [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Include another csp page or file in the output at this point. If the url ends in either 'csp' or 'cls' then it will call the csp or cls class to generate output skipping the output of the HTML headers. If the url is a file then it uses the stream server to output this file. This url can be a relative path in which case it will be resolved based on the current page url first. This is called by the <csp:include Page=\"page.csp\"> tag."}),"\n",(0,n.jsx)(s.p,{children:"You can pass additional parameters to the included page by adding them to the url to call. These parameters will only exist for the included page and the %request object is restored when it returns to the calling page. For example:"}),"\n",(0,n.jsx)(s.p,{children:'<csp:include Page="page.csp?PARAM=VALUE">'}),"\n",(0,n.jsx)(s.h3,{id:"hypereventhead",children:"HyperEventHead"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod HyperEventHead(iframeOnly As %Boolean, strict As %Boolean = 0, optionalBroker As %Boolean) As %String [ CodeMode = expression, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method returns the string that needs to be written to the current device during generation of the  section in order to use HyperEvents. See HyperEventCall for details. This is not needed if you are using #server, #vbserver or #call calls from a .csp page as this is automatically inserted, it is only required when generating the class or the HyperEvent calls directly. The iframeonly argument is now ignored since #call and #server now both use XMLHttpRequest. However, the iframeonly argument is kept for compatibility. Passing the argument strict=1 will create strict HTML 4 format of script tag."}),"\n",(0,n.jsx)(s.h3,{id:"hypereventbody",children:"HyperEventBody"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod HyperEventBody() As %String [ CodeMode = expression, Deprecated, Internal, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method is deprecated since Java applet based hyperevents are no longer supported."}),"\n",(0,n.jsx)(s.h3,{id:"hypereventframe",children:"HyperEventFrame"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod HyperEventFrame(strict As %Boolean) As %String [ CodeMode = expression, Deprecated, Internal, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method is deprecated since iframe based hyperevents are no longer supported."}),"\n",(0,n.jsx)(s.h3,{id:"hypereventcall",children:"HyperEventCall"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod HyperEventCall(methodName As %String, args As %String, type As %Integer = 0, mobile As %Boolean = 0) As %String [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method returns the string that needs to be written to the current device in order to insert a HyperEvent into a CSP page that is defined via a class. This method is the hand written class equivalent of using #call(...)#, #server(...)# or #vbserver(...)# in a CSP page."}),"\n",(0,n.jsx)(s.p,{children:"The methodName argument defines the method to call in the same format as #server: either ..method or package.class.method."}),"\n",(0,n.jsx)(s.p,{children:"The args argument defines the runtime JavaScript arguments to be passed to the ObjectScript method as a comma separated string."}),"\n",(0,n.jsx)(s.p,{children:'The type argument is 0 if you wish to use a #server(...)# style HyperEvent (this is the default), 1 if you wish to use a #call(...) style HyperEvent. Note that browsers are deprecating the synchronous #server(...)# style XMLHttpRequest so application should transition to using type=1. If the argument is 0 then it will use double quotes for the JavaScript which is the behaviour of #vbserver in a csp page, this will work correctly in both JavaScript and VBScript but you need to be aware that it will quote its parameter with ".'}),"\n",(0,n.jsx)(s.p,{children:"In order to use this method, HyperEventHead must be used in the  section."}),"\n",(0,n.jsx)(s.p,{children:"An example of an OnPage method for your page using a #call(...)# style HyperEvent:"}),"\n",(0,n.jsx)(s.p,{children:'` Write "'}),"\n",(0,n.jsx)(s.p,{children:'",! Write "",! Write "'}),"\n",(0,n.jsx)(s.p,{children:'",! Write "My New CSP Page!",! Write "'}),"\n",(0,n.jsx)(s.p,{children:'",! Write "",! Write "",! Write "",! Write "'}),"\n",(0,n.jsx)(s.p,{children:'",! Write "'}),"\n",(0,n.jsx)(s.p,{children:'",! Write "'}),"\n",(0,n.jsx)(s.p,{children:'",! Quit $$$OK `'}),"\n",(0,n.jsx)(s.h3,{id:"inserthiddenfields",children:"InsertHiddenFields"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod InsertHiddenFields(url As %String, ByRef query As %String) As %String [ CodeMode = expression, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Return the string containing the hidden form tags. You pass it the url URL of the target page that this form is submitted to (the action=xxx attribute)."}),"\n",(0,n.jsx)(s.p,{children:"The array, query, contains an optional set of name-value pairs which are also output as hidden input fields. This is normally called automatically directly after the "}),(0,n.jsxs)(s.form,{children:[" tag to insert any hidden input tags that are required. However if you generate a form programatically then you may need to call this function just after you output the  tag.",(0,n.jsx)(s.p,{}),"\n",(0,n.jsx)(s.h3,{id:"inserthiddenfield",children:"InsertHiddenField"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod InsertHiddenField(url As %String, name As %String, value As %String, extra As %String = "") As %String [ ServerOnly = 1 ]\n'})}),"\n",(0,n.jsxs)(s.p,{children:["Inserts a '",(0,n.jsx)(s.input,{type:"hidden",name:"Name",value:"Value"}),"' tag into the current document. If the target url you are submitting to (url) is encoded then this will encrypt the data in this hidden link. In this way it is similar to the Link. The extra are any extra attributes to add to the tag."]}),"\n",(0,n.jsx)(s.p,{children:"For example: `"}),"\n",(0,n.jsx)(s.p,{children:'#(..InsertHiddenField("target.csp","Name","Value"))#'}),"\n",(0,n.jsx)(s.p,{children:"`"}),"\n",(0,n.jsx)(s.h3,{id:"convertparameter",children:"ConvertParameter"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ConvertParameter(url As %String, ByRef name As %String, ByRef value As %String) As %Status [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"You pass this the url of the page you are going to and a name and value parameter and it will return the name and value encrypted if the target page is encoded."}),"\n",(0,n.jsx)(s.h3,{id:"starttimer",children:"StartTimer"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod StartTimer(name As %String) [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Used to get performance information on your CSP pages. This is called to start the timing of a block of code. The name specifies the type of component we are timing, for example we automatically call this with 'Page' at the start and end of the rendering of the CSP page. The idea is that you can call this at the start and end of any block of code to log information on how long this is taking."}),"\n",(0,n.jsx)(s.p,{children:"This is a default implementation of what sort of information to log, however you can subclass this and StopTimer to enhance the information that is logged."}),"\n",(0,n.jsx)(s.h3,{id:"stoptimer",children:"StopTimer"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod StopTimer(name As %String) [ ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Used to time performance information on your CSP pages. This is called to stop the timing of a block of code. The name specifies the type of component to time. See StartTimer for more information on this."}),"\n"]})]})}function c(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>a,x:()=>l});var n=t(96540);const r={},i=n.createContext(r);function a(e){const s=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);