"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[51407],{47557:(e,s,t)=>{t.r(s),t.d(s,{contentTitle:()=>l,default:()=>o,frontMatter:()=>n,toc:()=>c});var a=t(74848),r=t(28453);const n={pagination_prev:null,pagination_next:null},l="%CSP.UI.Portal.SQL.Utils",c=[{value:"Parameters",id:"parameters",level:2},{value:"DOMAIN",id:"domain",level:3},{value:"Methods",id:"methods",level:2},{value:"SQLExecuteQuery",id:"sqlexecutequery",level:3},{value:"GetQueryParameters",id:"getqueryparameters",level:3},{value:"GetError",id:"geterror",level:3},{value:"GetViewInfo2",id:"getviewinfo2",level:3},{value:"InitCollectStats",id:"initcollectstats",level:3},{value:"StartCollectStats",id:"startcollectstats",level:3},{value:"EndCollectStats",id:"endcollectstats",level:3},{value:"DrawResult",id:"drawresult",level:3},{value:"DrawResultSet",id:"drawresultset",level:3},{value:"DrawOutputColumns",id:"drawoutputcolumns",level:3},{value:"DrawMessages",id:"drawmessages",level:3},{value:"DrawTabs",id:"drawtabs",level:3},{value:"DrawTabBox",id:"drawtabbox",level:3},{value:"LoadSchemas",id:"loadschemas",level:3},{value:"LoadTables",id:"loadtables",level:3},{value:"ReverseSchema",id:"reverseschema",level:3},{value:"GetConfigSQLProperties",id:"getconfigsqlproperties",level:3},{value:"SaveConfigSQLProperties",id:"saveconfigsqlproperties",level:3}];function i(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"cspuiportalsqlutils",children:"%CSP.UI.Portal.SQL.Utils"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"Class %CSP.UI.Portal.SQL.Utils Extends %RegisteredObject [ Abstract, System = 4 ]\n"})}),"\n",(0,a.jsx)(s.p,{children:"Utilities used by Management Portal SQL."}),"\n",(0,a.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,a.jsx)(s.h3,{id:"domain",children:"DOMAIN"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter DOMAIN = "%Utility";\n'})}),"\n",(0,a.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,a.jsx)(s.h3,{id:"sqlexecutequery",children:"SQLExecuteQuery"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod SQLExecuteQuery(pText As %String(MAXLEN=""), ByRef pClassName As %String, pRuntimeMode As %Integer = 2, pDialect As %String = "Cache", pObjectSelectMode As %Boolean = 0, %caller As %String = "", ByRef tDiskRead, ByRef StatementType As %Integer = 0, ByRef AccStat, ByRef pSessionData, pQueryID As %Integer, ByRef pRuntimeClassName As %String) As %SQL.StatementResult\n'})}),"\n",(0,a.jsx)(s.p,{children:'Method to return SQL statement object and class name. Called by multiple SQL UI pages. When %caller is passed in as "SMP" then the system will prevent the DDL API from checking the DDLAllowed flag for the class (used by modifying view)'}),"\n",(0,a.jsx)(s.h3,{id:"getqueryparameters",children:"GetQueryParameters"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod GetQueryParameters(pText As %String(MAXLEN=""), pRuntimeMode As %Integer = 2, pDialect As %String = "Cache", pObjectSelectMode As %Boolean = 0, ByRef tPromptCount As %Integer) As %String\n'})}),"\n",(0,a.jsx)(s.p,{children:"Method to return number of parameters that user needs to provide for input in order to execute the query. Return number of Parameters within query text. 0 means none."}),"\n",(0,a.jsx)(s.h3,{id:"geterror",children:"GetError"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod GetError(pResult As %SQL.StatementResult, ByRef pMessages As %String(MAXLEN=""))\n'})}),"\n",(0,a.jsx)(s.p,{children:"GetError will return the HTML for an invalid SQLCODE."}),"\n",(0,a.jsx)(s.h3,{id:"getviewinfo2",children:"GetViewInfo2"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetViewInfo2(Schema As %String, ViewName As %String, Output Owner As %String, Output ReadOnly As %Boolean, Output CheckOption As %String) As %Status\n"})}),"\n",(0,a.jsx)(s.p,{children:"Given schema name and view name, return view info"}),"\n",(0,a.jsx)(s.h3,{id:"initcollectstats",children:"InitCollectStats"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod InitCollectStats(ByRef AccStat) As %Status [ Internal ]\n"})}),"\n",(0,a.jsx)(s.h3,{id:"startcollectstats",children:"StartCollectStats"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod StartCollectStats(ByRef CurStat) [ Internal ]\n"})}),"\n",(0,a.jsx)(s.h3,{id:"endcollectstats",children:"EndCollectStats"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod EndCollectStats(ByRef CurStat, ByRef CurAcc) [ Internal ]\n"})}),"\n",(0,a.jsx)(s.h3,{id:"drawresult",children:"DrawResult"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DrawResult(pResult As %SQL.StatementResult, pDrawTab As %Boolean = 0, pShowRowNum As %Boolean, ByRef AccStat, pMaxRows As %Integer = 1000, pQueryID As %Integer = -1)\n"})}),"\n",(0,a.jsx)(s.p,{children:"***** The following methods are used to draw query results. Multiple resultsets and call statements are handled. ***** ***** The caller should have already obtained a SQL statement result using SQLExecuteQuery in this class. ***** ***** See method DrawHTML in %CSP.UI.Portal.SQL.Home and %CSP.UI.Portal.SQL.PrintQuery ***** DrawResult will draw all of the result information returned in the statement result object."}),"\n",(0,a.jsx)(s.h3,{id:"drawresultset",children:"DrawResultSet"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod DrawResultSet(pPtr As %Integer, pResult As %SQL.StatementResult, pDrawTab As %Boolean, pShowRowNum As %Boolean, ByRef pMessages As %String(MAXLEN=""), ByRef AccStat, pMaxRows As %Integer = 1000, pQueryID As %Integer = -1)\n'})}),"\n",(0,a.jsx)(s.p,{children:"Draw html for one resultset."}),"\n",(0,a.jsx)(s.h3,{id:"drawoutputcolumns",children:"DrawOutputColumns"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod DrawOutputColumns(pPtr As %Integer = 0, pResult As %SQL.StatementResult, pDrawTab As %Boolean, ByRef pMessages As %String(MAXLEN=""), pQueryID As %Integer = -1)\n'})}),"\n",(0,a.jsx)(s.h3,{id:"drawmessages",children:"DrawMessages"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod DrawMessages(pPtr As %Integer = 1, pDrawTab As %Boolean, ByRef pMessages As %String(MAXLEN=""), pQueryID As %Integer = -1)\n'})}),"\n",(0,a.jsx)(s.p,{children:"Messages passed in should already been HTML escaped."}),"\n",(0,a.jsx)(s.h3,{id:"drawtabs",children:"DrawTabs"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DrawTabs(totalResultsets, pOutputValues As %Integer = 0, pQueryID As %Integer = -1)\n"})}),"\n",(0,a.jsx)(s.p,{children:"Control method to draw tab group. This is only used on the SQL Home page for Execute Query tab."}),"\n",(0,a.jsx)(s.h3,{id:"drawtabbox",children:"DrawTabBox"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DrawTabBox(tabClass As %String, tabCaption As %String, tabIndex As %Integer, totalTabs As %Integer, pQueryID As %Integer = -1)\n"})}),"\n",(0,a.jsx)(s.p,{children:"Draws each tab in tab group button"}),"\n",(0,a.jsx)(s.h3,{id:"loadschemas",children:"LoadSchemas"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LoadSchemas(pWizard, pDSN, pTableType, pSchemaFilter) As %String\n"})}),"\n",(0,a.jsx)(s.p,{children:"***** End of Group Methods for DrawResult ***** List schemas based on cache gateway connection - you must have a DSN (configuration name) passed in. This method is Jobbed from the wizard page."}),"\n",(0,a.jsx)(s.h3,{id:"loadtables",children:"LoadTables"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LoadTables(pWizard, pDSN, pSchema, pTableType, pFilter) As %String\n"})}),"\n",(0,a.jsx)(s.h3,{id:"reverseschema",children:"ReverseSchema"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ReverseSchema(schema) As %String\n"})}),"\n",(0,a.jsx)(s.h3,{id:"getconfigsqlproperties",children:"GetConfigSQLProperties"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetConfigSQLProperties(ByRef Properties As %String) As %Status\n"})}),"\n",(0,a.jsx)(s.p,{children:"Method for UI to get SQL Configuration Settings. Return Properties array."}),"\n",(0,a.jsx)(s.h3,{id:"saveconfigsqlproperties",children:"SaveConfigSQLProperties"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SaveConfigSQLProperties(proxy As %ZEN.proxyObject) As %ZEN.proxyObject\n"})}),"\n",(0,a.jsx)(s.p,{children:"Method for UI to save SQL configuration settings. ZEN proxy object is passed in with user selected values."})]})}function o(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(i,{...e})}):i(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>l,x:()=>c});var a=t(96540);const r={},n=a.createContext(r);function l(e){const s=a.useContext(n);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),a.createElement(n.Provider,{value:s},e.children)}}}]);