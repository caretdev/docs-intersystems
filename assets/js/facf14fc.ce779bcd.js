"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[56033],{65163:(e,s,n)=>{n.r(s),n.d(s,{contentTitle:()=>a,default:()=>c,frontMatter:()=>r,toc:()=>i});var t=n(74848),l=n(28453);const r={pagination_prev:null,pagination_next:null},a="%OAuth2.Utils",i=[{value:"Methods",id:"methods",level:2},{value:"Base64UrlEncode",id:"base64urlencode",level:3},{value:"Base64UrlDecode",id:"base64urldecode",level:3},{value:"TimeInSeconds",id:"timeinseconds",level:3},{value:"TimeInH",id:"timeinh",level:3},{value:"IsAlgSymmetric",id:"isalgsymmetric",level:3},{value:"IsAlgRSA",id:"isalgrsa",level:3},{value:"IsAlgEC",id:"isalgec",level:3},{value:"GetSupportedAlgorithms",id:"getsupportedalgorithms",level:3},{value:"UpdatePrivateJWKS",id:"updateprivatejwks",level:3},{value:"FindLastKid",id:"findlastkid",level:3},{value:"GetSecurityParams",id:"getsecurityparams",level:3},{value:"CommaToList",id:"commatolist",level:3},{value:"ListToComma",id:"listtocomma",level:3},{value:"CheckScope",id:"checkscope",level:3},{value:"NormalizeScope",id:"normalizescope",level:3},{value:"SelectLanguage",id:"selectlanguage",level:3},{value:"GetDefaultSessionId",id:"getdefaultsessionid",level:3},{value:"ObjectToJSON",id:"objecttojson",level:3},{value:"LogError",id:"logerror",level:3},{value:"LogCSPRequest",id:"logcsprequest",level:3},{value:"LogHTTPRequest",id:"loghttprequest",level:3},{value:"LogHTTPResponse",id:"loghttpresponse",level:3},{value:"LogServerToken",id:"logservertoken",level:3},{value:"LogServerScope",id:"logserverscope",level:3},{value:"LogArray",id:"logarray",level:3},{value:"LogJSON",id:"logjson",level:3},{value:"DisplayLog",id:"displaylog",level:3},{value:"GetJSONvalue",id:"getjsonvalue",level:3},{value:"GetJSONResponse",id:"getjsonresponse",level:3}];function o(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"oauth2utils",children:"%OAuth2.Utils"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Class %OAuth2.Utils Extends %RegisteredObject [ System = 3 ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Utility methods for OAuth 2.0 support. This class is used internally by InterSystems IRIS. You should not make direct use of it within your applications. There is no guarantee made about either the behavior or future operation of this class."}),"\n",(0,t.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(s.h3,{id:"base64urlencode",children:"Base64UrlEncode"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Base64UrlEncode(bin As %Binary) As %String [ CodeMode = expression ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Encode binary value using base64url encoding"}),"\n",(0,t.jsx)(s.h3,{id:"base64urldecode",children:"Base64UrlDecode"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Base64UrlDecode(text As %String) As %Binary [ CodeMode = expression ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Decode base64url encoded string"}),"\n",(0,t.jsx)(s.h3,{id:"timeinseconds",children:"TimeInSeconds"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod TimeInSeconds(time As %String, interval As %Integer = 0) As %Integer [ Internal ]\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Convert $h value to seconds since start of the Unix epoch,",(0,t.jsx)(s.br,{}),"\ntime is $h value.",(0,t.jsx)(s.br,{}),"\ninterval is interval to be added in seconds."]}),"\n",(0,t.jsx)(s.h3,{id:"timeinh",children:"TimeInH"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod TimeInH(time As %Integer) As %String [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Convert seconds since start of the Unix epoch to $h format."}),"\n",(0,t.jsx)(s.h3,{id:"isalgsymmetric",children:"IsAlgSymmetric"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod IsAlgSymmetric(alg As %String) As %Boolean [ Deprecated ]\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Check if apecified algorithm is symmetric This method is deprecated. Use the ",(0,t.jsx)(s.strong,{children:"IsAlgSymmetric"})," method in %Net.JSON.JWA instead."]}),"\n",(0,t.jsx)(s.h3,{id:"isalgrsa",children:"IsAlgRSA"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod IsAlgRSA(alg As %String) As %Boolean [ Deprecated ]\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Check if specified algorithm is RSA algorithm This method is deprecated. Use the ",(0,t.jsx)(s.strong,{children:"IsAlgRSA"})," method in %Net.JSON.JWA instead."]}),"\n",(0,t.jsx)(s.h3,{id:"isalgec",children:"IsAlgEC"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod IsAlgEC(alg As %String) As %Boolean [ Deprecated ]\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Check if specified algorithm is EC algorithm This method is deprecated. Use the ",(0,t.jsx)(s.strong,{children:"IsAlgEC"})," method in %Net.JSON.JWA instead."]}),"\n",(0,t.jsx)(s.h3,{id:"getsupportedalgorithms",children:"GetSupportedAlgorithms"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetSupportedAlgorithms(Output sigalgs As %List, Output encalgs As %List, Output keyalgs As %List)\n"})}),"\n",(0,t.jsx)(s.h3,{id:"updateprivatejwks",children:"UpdatePrivateJWKS"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod UpdatePrivateJWKS(ByRef privateJWKS As %String, ByRef publicJWKS As %String) As %Status [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Update the private JWKS for client or authorization server with a new private/public key pair or each supported algorithm. UpdatePrivateJWKS is used to initially create the JWKS or to do key rotation."}),"\n",(0,t.jsx)(s.h3,{id:"findlastkid",children:"FindLastKid"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod FindLastKid(jwks As %String) As %Integer\n"})}),"\n",(0,t.jsx)(s.h3,{id:"getsecurityparams",children:"GetSecurityParams"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetSecurityParams(ops As %DynamicObject, Output securityParams) [ Internal ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"commatolist",children:"CommaToList"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CommaToList(str As %String) As %List\n"})}),"\n",(0,t.jsx)(s.p,{children:"Convert a comma separated list to a $list"}),"\n",(0,t.jsx)(s.h3,{id:"listtocomma",children:"ListToComma"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ListToComma(list As %List) As %String\n"})}),"\n",(0,t.jsx)(s.p,{children:"Convert a $list to comman separated list"}),"\n",(0,t.jsx)(s.h3,{id:"checkscope",children:"CheckScope"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CheckScope(tokenScope As %String, scope As %String) As %OAuth2.Error\n"})}),"\n",(0,t.jsx)(s.p,{children:"Check that scope is subset of valid scopes for this token"}),"\n",(0,t.jsx)(s.h3,{id:"normalizescope",children:"NormalizeScope"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod NormalizeScope(scope As %String) As %String [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Normalize scope"}),"\n",(0,t.jsx)(s.h3,{id:"selectlanguage",children:"SelectLanguage"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SelectLanguage(uiLocales As %String, domain As %String) As %String\n"})}),"\n",(0,t.jsxs)(s.p,{children:["Select the language for Authentication Class localization.",(0,t.jsx)(s.br,{}),"\nuiLocales is the value of the ui_locales request parameter.",(0,t.jsx)(s.br,{}),"\nThe return value is the selected language code.",(0,t.jsx)(s.br,{}),'\nCall looks like: Set language=##class(%OAuth2.Utils).SelectLanguage(properties.RequestProperties.GetAt("ui_locales"),domain)']}),"\n",(0,t.jsx)(s.h3,{id:"getdefaultsessionid",children:"GetDefaultSessionId"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetDefaultSessionId(ByRef sessionId As %String) As %String [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Get the default sessionId if none is specified."}),"\n",(0,t.jsx)(s.h3,{id:"objecttojson",children:"ObjectToJSON"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ObjectToJSON(object As %DynamicAbstractObject) As %Status\n"})}),"\n",(0,t.jsx)(s.p,{children:"Output JSON object to the current device"}),"\n",(0,t.jsx)(s.h3,{id:"logerror",children:"LogError"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LogError(methodName As %String, server As %Boolean, sc As %Status, data As %String) [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Log an OAuth 2.0 error"}),"\n",(0,t.jsx)(s.h3,{id:"logcsprequest",children:"LogCSPRequest"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LogCSPRequest(methodName As %String, server As %Boolean) [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Log details of HTTP request received by CSP"}),"\n",(0,t.jsx)(s.h3,{id:"loghttprequest",children:"LogHTTPRequest"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LogHTTPRequest(methodName As %String, server As %Boolean, httpRequest As %Net.HttpRequest, method As %String, url As %String, ByRef formData, logLevel As %Integer = 3) [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Log details of HTTP request to be made"}),"\n",(0,t.jsx)(s.h3,{id:"loghttpresponse",children:"LogHTTPResponse"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LogHTTPResponse(methodName As %String, server As %Boolean, httpRequest As %Net.HttpRequest, logLevel As %Integer = 3) [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Log details of HTTP response"}),"\n",(0,t.jsx)(s.h3,{id:"logservertoken",children:"LogServerToken"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LogServerToken(methodName As %String, token As OAuth2.Server.AccessToken) [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Log a server token"}),"\n",(0,t.jsx)(s.h3,{id:"logserverscope",children:"LogServerScope"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LogServerScope(methodName As %String, token As OAuth2.Server.AccessToken) [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Log a server token"}),"\n",(0,t.jsx)(s.h3,{id:"logarray",children:"LogArray"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LogArray(methodName As %String, server As %Boolean, desc As %String, ByRef array) [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Log a local array"}),"\n",(0,t.jsx)(s.h3,{id:"logjson",children:"LogJSON"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LogJSON(methodName As %String, server As %Boolean, desc As %String, json As %DynamicObject) [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Log a JSON object"}),"\n",(0,t.jsx)(s.h3,{id:"displaylog",children:"DisplayLog"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod DisplayLog(file As %String = "oauth2.log", testMode As %Boolean = 0) [ Internal ]\n'})}),"\n",(0,t.jsx)(s.p,{children:"Display ^ISCLOG"}),"\n",(0,t.jsx)(s.h3,{id:"getjsonvalue",children:"GetJSONvalue"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetJSONvalue(prop As %String, type As %String) As %String [ Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Needed for internal code generators."}),"\n",(0,t.jsx)(s.h3,{id:"getjsonresponse",children:"GetJSONResponse"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetJSONResponse(httpRequest As %Net.HttpRequest, Output json As %DynamicObject, Output error As %OAuth2.Error) As %Status [ Final, Internal ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Get the response object Called by OAuth2.Response and %SYS.OAuth2.AccessToken"})]})}function c(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>i});var t=n(96540);const l={},r=t.createContext(l);function a(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);