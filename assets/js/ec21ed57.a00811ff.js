"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[19795],{63845:(e,s,t)=>{t.r(s),t.d(s,{contentTitle:()=>l,default:()=>o,frontMatter:()=>a,toc:()=>c});var n=t(74848),r=t(28453);const a={pagination_prev:null,pagination_next:null},l="%Atelier.REST",c=[{value:"Parameters",id:"parameters",level:2},{value:"DOMAIN",id:"domain",level:3},{value:"Methods",id:"methods",level:2},{value:"Http500",id:"http500",level:3},{value:"ReportHttpStatusCode",id:"reporthttpstatuscode",level:3},{value:"GetClientServerHash",id:"getclientserverhash",level:3},{value:"SetClientServerHash",id:"setclientserverhash",level:3},{value:"ServeDoc",id:"servedoc",level:3},{value:"ServeXml",id:"servexml",level:3},{value:"RenderResponseBody",id:"renderresponsebody",level:3},{value:"Page",id:"page",level:3}];function i(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"atelierrest",children:"%Atelier.REST"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Class %Atelier.REST Extends %CSP.REST\n"})}),"\n",(0,n.jsx)(s.p,{children:"This class implements a custom response format and serves as the basis for all Atelier REST APIs"}),"\n",(0,n.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsx)(s.h3,{id:"domain",children:"DOMAIN"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter DOMAIN = "%Utility";\n'})}),"\n",(0,n.jsx)(s.p,{children:"%Atelier.REST classes are unlikely to actually define messages with $$$Text %Utility seems like a catch-all, and should have all languages defined, so the %session/%response language can be set properly."}),"\n",(0,n.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(s.h3,{id:"http500",children:"Http500"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Http500(pE As %Exception.AbstractException) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"Use our special format Http500 handler"}),"\n",(0,n.jsx)(s.h3,{id:"reporthttpstatuscode",children:"ReportHttpStatusCode"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ReportHttpStatusCode(pHttpStatus, pSC As %Status = {$$$OK}) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"User our special format handler for other status codes"}),"\n",(0,n.jsx)(s.h3,{id:"getclientserverhash",children:"GetClientServerHash"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetClientServerHash() As %String [ CodeMode = expression, Internal ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Get the clients version of the server hash"}),"\n",(0,n.jsx)(s.h3,{id:"setclientserverhash",children:"SetClientServerHash"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SetClientServerHash(pHash As %String)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Set the clients version of the server hash"}),"\n",(0,n.jsx)(s.h3,{id:"servedoc",children:"ServeDoc"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod ServeDoc(pDocName As %String, pStatus As %Status, pMsgArray As %DynamicArray, ByRef pResArray As %String, pTimeStamp As %String = "", pUpToDate As %Boolean, pExtensionContent As %DynamicObject) As %Status\n'})}),"\n",(0,n.jsx)(s.p,{children:"This private helper method server wraps the message and document and returns it to the caller"}),"\n",(0,n.jsx)(s.h3,{id:"servexml",children:"ServeXml"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod ServeXml(pDocName As %String, pStatus As %Status, pMsgArray As %DynamicArray, pStream As %Stream, pTimeStamp As %String = "") As %Status\n'})}),"\n",(0,n.jsx)(s.p,{children:"This private helper method server wraps the message and document and returns it to the caller"}),"\n",(0,n.jsx)(s.h3,{id:"renderresponsebody",children:"RenderResponseBody"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod RenderResponseBody(pStatus As %Status, pMsgPart As %DynamicArray, pResPart As %DynamicObject) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"Render the three-part Response Body which contains an status, console, and a result part"}),"\n",(0,n.jsx)(s.h3,{id:"page",children:"Page"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Page(skipheader As %Boolean = 1) As %Status [ ProcedureBlock = 0 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Sets the response's localization domain (something that %CSP.REST should do, in theory) and then invokes default super class behavior"})]})}function o(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(i,{...e})}):i(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>l,x:()=>c});var n=t(96540);const r={},a=n.createContext(r);function l(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);