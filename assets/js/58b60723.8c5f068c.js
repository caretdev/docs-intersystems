"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[62462],{40533:(e,s,t)=>{t.r(s),t.d(s,{contentTitle:()=>r,default:()=>o,frontMatter:()=>a,toc:()=>l});var n=t(74848),i=t(28453);const a={pagination_prev:null,pagination_next:null},r="%SYS.Task.Definition",l=[{value:"Parameters",id:"parameters",level:2},{value:"PROPERTYVALIDATION",id:"propertyvalidation",level:3},{value:"DOMAIN",id:"domain",level:3},{value:"TaskName",id:"taskname",level:3},{value:"RESOURCE",id:"resource",level:3},{value:"Properties",id:"properties",level:2},{value:"%RunDate",id:"rundate",level:3},{value:"%RunTime",id:"runtime",level:3},{value:"Methods",id:"methods",level:2},{value:"OnTask",id:"ontask",level:3},{value:"GetSettings",id:"getsettings",level:3},{value:"SetSettings",id:"setsettings",level:3},{value:"OnSubmit",id:"onsubmit",level:3},{value:"GetTaskName",id:"gettaskname",level:3},{value:"GetPropertyName",id:"getpropertyname",level:3},{value:"GetCollectionType",id:"getcollectiontype",level:3},{value:"CheckPermission",id:"checkpermission",level:3},{value:"GetResource",id:"getresource",level:3}];function c(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"systaskdefinition",children:"%SYS.Task.Definition"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Class %SYS.Task.Definition Extends %RegisteredObject [ System = 4 ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:["This class defines a task that can be executed by the Task Manager. To create a new task, create a subclass and override the OnTask method.",(0,n.jsx)(s.br,{}),'\nAll public properties whose name does not start with a "%" are treated as user-configurable "settings" for this task.']}),"\n",(0,n.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsx)(s.h3,{id:"propertyvalidation",children:"PROPERTYVALIDATION"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter PROPERTYVALIDATION = 2;\n"})}),"\n",(0,n.jsx)(s.h3,{id:"domain",children:"DOMAIN"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter DOMAIN = "%Utility";\n'})}),"\n",(0,n.jsx)(s.p,{children:"Default Localization Domain"}),"\n",(0,n.jsx)(s.h3,{id:"taskname",children:"TaskName"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter TaskName As STRING;\n"})}),"\n",(0,n.jsx)(s.p,{children:"This defines the user-visible name of this task. It is defined in the subclasses."}),"\n",(0,n.jsx)(s.h3,{id:"resource",children:"RESOURCE"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter RESOURCE As STRING;\n"})}),"\n",(0,n.jsx)(s.p,{children:'This specifies a security resource and optional permission. Access to the resource will be required to create, modify or run a task of this type. The format is ":". If  is ommited, "USE" is implied. Note that this parameter cannot be overridden using the COSEXPRESSION parameter type.'}),"\n",(0,n.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,n.jsx)(s.h3,{id:"rundate",children:"%RunDate"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property %RunDate As %Date;\n"})}),"\n",(0,n.jsx)(s.h3,{id:"runtime",children:"%RunTime"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property %RunTime As %Time;\n"})}),"\n",(0,n.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(s.h3,{id:"ontask",children:"OnTask"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method OnTask() As %Status\n"})}),"\n",(0,n.jsxs)(s.p,{children:["This method is responsible for executing the task.",(0,n.jsx)(s.br,{}),'\nAt the scheduled time, the Task Manager creates an instance of this object, sets any property values using the stored "Settings" for the task, and then invokes this method to execute the task.',(0,n.jsx)(s.br,{}),"\nIn order to execute a real task, override this method in a subclass."]}),"\n",(0,n.jsx)(s.h3,{id:"getsettings",children:"GetSettings"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method GetSettings() As %List [ CodeMode = objectgenerator, Final ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Return a serialized list of user-defined Property values for an instance of this Task as a $List. This serialized list is stored in %SYS.Task.Settings for the scheduled Task and used by the Task Manager to set the Properties before OnTask() is run.",(0,n.jsx)(s.br,{}),"\nThe serialized state is of the form: $LB(name,val,name,val)"]}),"\n",(0,n.jsx)(s.h3,{id:"setsettings",children:"SetSettings"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method SetSettings(pState As %List) As %Status [ Final ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Called by the Task Manager prior to running OnTask() to set all Property values.",(0,n.jsx)(s.br,{}),"\nThe 'pState' value is the serialized list of Property values stored in the scheduled Task in %SYS.Task.Settings."]}),"\n",(0,n.jsx)(s.h3,{id:"onsubmit",children:"OnSubmit"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method OnSubmit(ByRef pID As %String, pSubmit As %String) As %Status [ CodeMode = objectgenerator, Final ]\n"})}),"\n",(0,n.jsxs)(s.p,{children:["This callback is called when this form is submitted. pID is the ID value associated with the form. The default implementation will perform a Save if the AutoForm is a persistent object.",(0,n.jsx)(s.br,{}),"\npSubmit is the name of the submit button (i.e., $AUTOFORM_SAVE)."]}),"\n",(0,n.jsx)(s.h3,{id:"gettaskname",children:"GetTaskName"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetTaskName() As %String [ CodeMode = objectgenerator, Final ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Returns the localized name of this task."}),"\n",(0,n.jsx)(s.h3,{id:"getpropertyname",children:"GetPropertyName"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetPropertyName(propertyName As %String) As %String [ CodeMode = objectgenerator, Final ]\n"})}),"\n",(0,n.jsx)(s.h3,{id:"getcollectiontype",children:"GetCollectionType"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetCollectionType(propertyName As %String, ByRef tCollection As %String) As %String [ CodeMode = objectgenerator, Final ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Return a collection type for a property. By passing reference tCollection we can get all properties which are collections."}),"\n",(0,n.jsx)(s.h3,{id:"checkpermission",children:"CheckPermission"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CheckPermission(taskClass As %String, namespace As %String, Output sc As %Status) As %Boolean\n"})}),"\n",(0,n.jsx)(s.p,{children:"This method checks if the current process has the permission defined by the RESOURCE parameter for the given Task class. This will return 1 if the process has permission, or if no RESOURCE is defined. It will return 0 otherwise."}),"\n",(0,n.jsx)(s.h3,{id:"getresource",children:"GetResource"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetResource(taskClass As %String, namespace As %String) As %String [ Final, Private ]\n"})})]})}function o(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>l});var n=t(96540);const i={},a=n.createContext(i);function r(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);