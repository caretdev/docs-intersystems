"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[70265],{76772:(e,t,s)=>{s.r(t),s.d(t,{contentTitle:()=>i,default:()=>c,frontMatter:()=>a,toc:()=>o});var r=s(74848),n=s(28453);const a={pagination_prev:null,pagination_next:null},i="%ResultSet.SQL",o=[{value:"Methods",id:"methods",level:2},{value:"%Prepare",id:"prepare",level:3},{value:"%PrepareMetaData",id:"preparemetadata",level:3},{value:"%NormalizeObject",id:"normalizeobject",level:3},{value:"%ValidateObject",id:"validateobject",level:3},{value:"%SerializeObject",id:"serializeobject",level:3},{value:"%ConstructClone",id:"constructclone",level:3},{value:"%AddToSaveSet",id:"addtosaveset",level:3},{value:"%RemoveFromSaveSet",id:"removefromsaveset",level:3}];function l(e){const t={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"resultsetsql",children:"%ResultSet.SQL"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Class %ResultSet.SQL Extends (%Library.IResultSet, %ResultSet.QuerySuper) [ System = 4 ]\n"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"This class has been superseded."})," It will remain for compatibility with existing code and samples. We recommend using %SQL.Statement."]}),"\n",(0,r.jsx)(t.p,{children:"Cached ResultSet based on an SQL statement. This class only supports the SELECT statement."}),"\n",(0,r.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(t.h3,{id:"prepare",children:"%Prepare"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'ClassMethod %Prepare(ByRef sqlStatement As %String(MAXLEN=""), ByRef returnError As %SYSTEM.Error, %importPackages As %RawString = "", %args...) As %ResultSet.SQL [ PublicList = (SQLCODE, resultSet, returnStatus) ]\n'})}),"\n",(0,r.jsx)(t.p,{children:"%Prepare() This method is different for each type of result set class. This method has two tasks. First, instantiate the correct concrete result set class. For %ResultSet.SQL that means accepting the sql query text in the first parameter and looking up the query implementation in the query cache. The second task is to prepare the resulting object for data retrieval by the caller which is done in %OnNew. The assumption is that if the query requires any parameters then the actual arguments are all literal or public variables."}),"\n",(0,r.jsx)(t.p,{children:"For %ResultSet.SQL, the arguments are:"}),"\n",(0,r.jsx)(t.p,{children:"sqlStatement (byref)"}),"\n",(0,r.jsx)(t.p,{children:"the SQL Select statement, either as a counted array or as a $$$NL delimited string;"}),"\n",(0,r.jsx)(t.p,{children:"returnError (byref)"}),"\n",(0,r.jsx)(t.p,{children:"if an error occurs, this will be an oref of an instance of %SYSTEM.Error. That object has a Status property as well as methods to convert that status value into message id's and text from other error domains. If no error is detected during %Prepare then returnError is $$$NULLOREF;"}),"\n",(0,r.jsx)(t.p,{children:"%importPackages"}),"\n",(0,r.jsxs)(t.p,{children:["this is a $list of package names to be used to resolve any unqualified names in the SELECT statement.",(0,r.jsx)(t.br,{}),"\nFor example, SELECT %ID from MyTable",(0,r.jsx)(t.br,{}),'\nIf %importPackages contains "Sample" then the schema associated with the Sample package would be used to qualify MyTable.']}),"\n",(0,r.jsx)(t.p,{children:"%args..."}),"\n",(0,r.jsx)(t.p,{children:"variable number of argument values that correspond to '?' parameters contained in the sqlStatement."}),"\n",(0,r.jsx)(t.p,{children:"This method returns an instance of %Library.IResultSet in the generic case. In the case of %ResultSet.SQL, an instance of %ResultSet.SQL is returned."}),"\n",(0,r.jsx)(t.p,{children:"This method constructs a SaveSet containing objects that are part of the current %Save() for persistent classes or %GetSwizzleObject for serial classes. A queue of objects to be saved or serialized is also constructed. Only modified objects are included in the save queue. The value (OID or serial value in OID form) of each object is also placed in the SaveSet."}),"\n",(0,r.jsx)(t.h3,{id:"preparemetadata",children:"%PrepareMetaData"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'ClassMethod %PrepareMetaData(ByRef txtSQL As %String(MAXLEN=""), ByRef returnError As %SYSTEM.Error = "", importPackages As %RawString = "") As %ResultSet.MetaData\n'})}),"\n",(0,r.jsx)(t.p,{children:"%PrepareMetaData is similar to %Prepare except that no result set is instantiated. This method returns a %ResultSet.MetaData object. Be aware that the implementation of this method might cause the result set to be instantiated but that is up to the result set class itself and no result set is actually returned by this method - only metadata."}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"query"}),(0,r.jsx)(t.th,{children:"This is the SQL SELECT statement"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"returnError"}),(0,r.jsx)(t.td,{children:"If an error occurs this is returned by reference and is a %SYSTEM.Error object with properties set to describe information about the error. %returnError.Status contains the %Status value."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"importPackages"}),(0,r.jsx)(t.td,{children:"This is a comma delimited list of packages to import. This is only relevant if the result set implementation is generated and the query source might include unqualified names. The import packages list is used to resolve package/schema names for unqualified names."})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"normalizeobject",children:"%NormalizeObject"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method %NormalizeObject() As %Status [ CodeMode = expression ]\n"})}),"\n",(0,r.jsx)(t.h3,{id:"validateobject",children:"%ValidateObject"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method %ValidateObject(force As %Integer = 0) As %Status [ CodeMode = expression ]\n"})}),"\n",(0,r.jsx)(t.h3,{id:"serializeobject",children:"%SerializeObject"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method %SerializeObject(ByRef serial As %Binary, partial As %Integer = 0) As %Status [ CodeMode = expression ]\n"})}),"\n",(0,r.jsx)(t.h3,{id:"constructclone",children:"%ConstructClone"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method %ConstructClone(deep As %Boolean = 0, ByRef cloned As %String, location As %String) As %RegisteredObject [ CodeMode = expression, ProcedureBlock = 1, ServerOnly = 1 ]\n"})}),"\n",(0,r.jsx)(t.h3,{id:"addtosaveset",children:"%AddToSaveSet"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:'Method %AddToSaveSet(depth As %Integer = 3, refresh As %Integer = 0, norecurseon As %String = "") As %Status [ CodeMode = expression, Internal, ProcedureBlock = 1, ServerOnly = 1 ]\n'})}),"\n",(0,r.jsx)(t.h3,{id:"removefromsaveset",children:"%RemoveFromSaveSet"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-objectscript-class",children:"Method %RemoveFromSaveSet() As %Status [ CodeMode = expression, Internal, ProcedureBlock = 1, ServerOnly = 1 ]\n"})})]})}function c(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>i,x:()=>o});var r=s(96540);const n={},a=r.createContext(n);function i(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);