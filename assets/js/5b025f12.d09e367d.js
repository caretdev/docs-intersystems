"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[47660],{69019:(e,n,l)=>{l.r(n),l.d(n,{contentTitle:()=>a,default:()=>o,frontMatter:()=>t,toc:()=>i});var s=l(74848),r=l(28453);const t={pagination_prev:null,pagination_next:null},a="%DeepSee.UserLibrary.Worksheet",i=[{value:"Parameters",id:"parameters",level:2},{value:"XMLNAME",id:"xmlname",level:3},{value:"ITEMTYPE",id:"itemtype",level:3},{value:"ICON",id:"icon",level:3},{value:"LARGEICON",id:"largeicon",level:3},{value:"Properties",id:"properties",level:2},{value:"format",id:"format",level:3},{value:"style",id:"style",level:3},{value:"columnHeaderStyle",id:"columnheaderstyle",level:3},{value:"rowHeaderStyle",id:"rowheaderstyle",level:3},{value:"borders",id:"borders",level:3},{value:"showZebra",id:"showzebra",level:3},{value:"showRowLabels",id:"showrowlabels",level:3},{value:"showColumnLabels",id:"showcolumnlabels",level:3},{value:"rowHeaders",id:"rowheaders",level:3},{value:"columnHeaders",id:"columnheaders",level:3},{value:"cells",id:"cells",level:3},{value:"gridMode",id:"gridmode",level:3},{value:"dataConnector",id:"dataconnector",level:3},{value:"pageSize",id:"pagesize",level:3},{value:"columnWidth",id:"columnwidth",level:3},{value:"%cells",id:"cells-1",level:3},{value:"%values",id:"values",level:3},{value:"xmlCells",id:"xmlcells",level:3},{value:"xmlValues",id:"xmlvalues",level:3},{value:"%rowIndex",id:"rowindex",level:3},{value:"%columnIndex",id:"columnindex",level:3},{value:"%currRow",id:"currrow",level:3},{value:"%currColumn",id:"currcolumn",level:3},{value:"%externalValues",id:"externalvalues",level:3},{value:"%externalRefs",id:"externalrefs",level:3},{value:"Methods",id:"methods",level:2},{value:"%GetURL",id:"geturl",level:3},{value:"%GetTypeName",id:"gettypename",level:3},{value:"%OnAfterSave",id:"onaftersave",level:3},{value:"%OnDelete",id:"ondelete",level:3},{value:"%OnOpen",id:"onopen",level:3},{value:"%OnAfterImport",id:"onafterimport",level:3},{value:"XMLBeforeExport",id:"xmlbeforeexport",level:3},{value:"%CopyToComponent",id:"copytocomponent",level:3},{value:"%CopyFromComponent",id:"copyfromcomponent",level:3},{value:"%Calculate",id:"calculate",level:3},{value:"%EvaluateCell",id:"evaluatecell",level:3},{value:"%Lookup",id:"lookup",level:3},{value:"%LookupReference",id:"lookupreference",level:3}];function c(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"deepseeuserlibraryworksheet",children:"%DeepSee.UserLibrary.Worksheet"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Class %DeepSee.UserLibrary.Worksheet Extends %DeepSee.UserLibrary.FolderItem [ System = 4 ]\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This class represents a DeepSee Worksheet within a DeepSee folder.",(0,s.jsx)(n.br,{}),'\nThis class also provides the APIs for working with DeepSee "worksheets". A worksheet can be used in several ways:']}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"You can use a worksheet to define a specialized KPI containing user-entered data that drives other dashboard widgets."}),"\n",(0,s.jsx)(n.li,{children:"You can use a worksheet to feed values into other DeepSee components, such as pivot tables."}),"\n",(0,s.jsx)(n.li,{children:"You can use a worksheet to enter and display a grid of values."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsx)(n.h3,{id:"xmlname",children:"XMLNAME"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Parameter XMLNAME = "worksheet";\n'})}),"\n",(0,s.jsx)(n.h3,{id:"itemtype",children:"ITEMTYPE"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Parameter ITEMTYPE = "worksheet";\n'})}),"\n",(0,s.jsx)(n.p,{children:"This is the extension returned by this type from the Finder."}),"\n",(0,s.jsx)(n.h3,{id:"icon",children:"ICON"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Parameter ICON = "deepsee/ds2_list_44.png";\n'})}),"\n",(0,s.jsx)(n.h3,{id:"largeicon",children:"LARGEICON"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Parameter LARGEICON = "deepsee/ds2_list_44.png";\n'})}),"\n",(0,s.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,s.jsx)(n.h3,{id:"format",children:"format"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property format As %ZEN.Datatype.string(XMLPROJECTION = "attribute");\n'})}),"\n",(0,s.jsx)(n.p,{children:"Default format to apply to cells in this worksheet."}),"\n",(0,s.jsx)(n.h3,{id:"style",children:"style"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property style As %ZEN.Datatype.style(XMLPROJECTION = "attribute");\n'})}),"\n",(0,s.jsx)(n.p,{children:"Additional style to apply to cells in this worksheet."}),"\n",(0,s.jsx)(n.h3,{id:"columnheaderstyle",children:"columnHeaderStyle"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property columnHeaderStyle As %ZEN.Datatype.style(XMLPROJECTION = "attribute");\n'})}),"\n",(0,s.jsx)(n.p,{children:"Additional style to apply to column headers in this grid."}),"\n",(0,s.jsx)(n.h3,{id:"rowheaderstyle",children:"rowHeaderStyle"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property rowHeaderStyle As %ZEN.Datatype.style(XMLPROJECTION = "attribute");\n'})}),"\n",(0,s.jsx)(n.p,{children:"Additional style to apply to row headers in this grid."}),"\n",(0,s.jsx)(n.h3,{id:"borders",children:"borders"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property borders As %ZEN.Datatype.string(XMLPROJECTION = "attribute");\n'})}),"\n",(0,s.jsx)(n.p,{children:'Specify whether cell borders should be "all" (the default) or "none".'}),"\n",(0,s.jsx)(n.h3,{id:"showzebra",children:"showZebra"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property showZebra As %ZEN.Datatype.boolean(XMLPROJECTION = "attribute");\n'})}),"\n",(0,s.jsx)(n.p,{children:"Specify whether zebra striping should be applied to the grid."}),"\n",(0,s.jsx)(n.h3,{id:"showrowlabels",children:"showRowLabels"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property showRowLabels As %ZEN.Datatype.boolean(XMLPROJECTION = "attribute") [ InitialExpression = 1 ];\n'})}),"\n",(0,s.jsx)(n.p,{children:"Specifies whether row labels should be displayed."}),"\n",(0,s.jsx)(n.h3,{id:"showcolumnlabels",children:"showColumnLabels"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property showColumnLabels As %ZEN.Datatype.boolean(XMLPROJECTION = "attribute") [ InitialExpression = 1 ];\n'})}),"\n",(0,s.jsx)(n.p,{children:"Specifies whether column labels should be displayed."}),"\n",(0,s.jsx)(n.h3,{id:"rowheaders",children:"rowHeaders"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property rowHeaders As list Of WorksheetAxis(XMLNAME = "rowHeader", XMLPROJECTION = "ELEMENT");\n'})}),"\n",(0,s.jsx)(n.p,{children:"This contains the definition of the row headers for this worksheet."}),"\n",(0,s.jsx)(n.h3,{id:"columnheaders",children:"columnHeaders"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property columnHeaders As list Of WorksheetAxis(XMLNAME = "columnHeader", XMLPROJECTION = "ELEMENT");\n'})}),"\n",(0,s.jsx)(n.p,{children:"This contains the definition of the column headers for this worksheet."}),"\n",(0,s.jsx)(n.h3,{id:"cells",children:"cells"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property cells As list Of WorksheetCell(XMLNAME = "cellDef", XMLPROJECTION = "ELEMENT");\n'})}),"\n",(0,s.jsx)(n.p,{children:"This contains the definition of (overridden) cells for this worksheet."}),"\n",(0,s.jsx)(n.h3,{id:"gridmode",children:"gridMode"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property gridMode As %ZEN.Datatype.string(XMLPROJECTION = "attribute");\n'})}),"\n",(0,s.jsx)(n.p,{children:'Data mode for the worksheet: "dataSet" or "dataSource".'}),"\n",(0,s.jsx)(n.h3,{id:"dataconnector",children:"dataConnector"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property dataConnector As %ZEN.Datatype.string(XMLPROJECTION = "attribute");\n'})}),"\n",(0,s.jsx)(n.p,{children:'Name of data connector class used by the grid (in "dataSource" mode).'}),"\n",(0,s.jsx)(n.h3,{id:"pagesize",children:"pageSize"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property pageSize As %ZEN.Datatype.integer(XMLPROJECTION = "attribute");\n'})}),"\n",(0,s.jsx)(n.p,{children:'Page size used by the grid (in "dataSource" mode).'}),"\n",(0,s.jsx)(n.h3,{id:"columnwidth",children:"columnWidth"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property columnWidth As %ZEN.Datatype.integer;\n"})}),"\n",(0,s.jsx)(n.p,{children:"Default column width."}),"\n",(0,s.jsx)(n.h3,{id:"cells-1",children:"%cells"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property %cells As %String(XMLPROJECTION = "none") [ Internal, MultiDimensional, Transient ];\n'})}),"\n",(0,s.jsxs)(n.p,{children:["This holds the definition of the cells within this worksheet.",(0,s.jsx)(n.br,{}),"\n%cells(r,c) = value"]}),"\n",(0,s.jsx)(n.h3,{id:"values",children:"%values"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property %values As %String(XMLPROJECTION = "none") [ Internal, MultiDimensional, Transient ];\n'})}),"\n",(0,s.jsxs)(n.p,{children:["This holds the values of the cells within this worksheet after any calculations have been resolved.",(0,s.jsx)(n.br,{}),"\n%values(r,c) = value"]}),"\n",(0,s.jsx)(n.h3,{id:"xmlcells",children:"xmlCells"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property xmlCells As list Of %String(XMLNAME = "cell", XMLPROJECTION = "ELEMENT") [ Transient ];\n'})}),"\n",(0,s.jsx)(n.p,{children:"This is used to hold cell values when they are exported to XML."}),"\n",(0,s.jsx)(n.h3,{id:"xmlvalues",children:"xmlValues"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property xmlValues As list Of %String(XMLNAME = "value", XMLPROJECTION = "ELEMENT") [ Transient ];\n'})}),"\n",(0,s.jsx)(n.p,{children:"This is used to hold cell (resolved) values when they are exported to XML."}),"\n",(0,s.jsx)(n.h3,{id:"rowindex",children:"%rowIndex"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property %rowIndex As %Integer(XMLPROJECTION = "none") [ Internal, MultiDimensional, Transient ];\n'})}),"\n",(0,s.jsx)(n.p,{children:"Index of row names used during calculation."}),"\n",(0,s.jsx)(n.h3,{id:"columnindex",children:"%columnIndex"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property %columnIndex As %Integer(XMLPROJECTION = "none") [ Internal, MultiDimensional, Transient ];\n'})}),"\n",(0,s.jsx)(n.p,{children:"Index of column names used during calculation."}),"\n",(0,s.jsx)(n.h3,{id:"currrow",children:"%currRow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property %currRow As %Integer(XMLPROJECTION = "none") [ Internal, Transient ];\n'})}),"\n",(0,s.jsx)(n.p,{children:"Current row during calculation."}),"\n",(0,s.jsx)(n.h3,{id:"currcolumn",children:"%currColumn"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property %currColumn As %Integer(XMLPROJECTION = "none") [ Internal, Transient ];\n'})}),"\n",(0,s.jsx)(n.p,{children:"Current column during calculation."}),"\n",(0,s.jsx)(n.h3,{id:"externalvalues",children:"%externalValues"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property %externalValues As %String(XMLPROJECTION = "none") [ Internal, MultiDimensional, Transient ];\n'})}),"\n",(0,s.jsx)(n.p,{children:"Array of values from external sources (used during calculation)."}),"\n",(0,s.jsx)(n.h3,{id:"externalrefs",children:"%externalRefs"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:'Property %externalRefs As %String(XMLPROJECTION = "none") [ Internal, MultiDimensional, Transient ];\n'})}),"\n",(0,s.jsx)(n.p,{children:"Array of external sources (used during calculation)."}),"\n",(0,s.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(n.h3,{id:"geturl",children:"%GetURL"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %GetURL() As %String\n"})}),"\n",(0,s.jsx)(n.p,{children:"Return the URL for this item."}),"\n",(0,s.jsx)(n.h3,{id:"gettypename",children:"%GetTypeName"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %GetTypeName() As %String\n"})}),"\n",(0,s.jsx)(n.p,{children:"Return the localized type name for this item."}),"\n",(0,s.jsx)(n.h3,{id:"onaftersave",children:"%OnAfterSave"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %OnAfterSave(insert As %Boolean) As %Status [ Private, ServerOnly = 1 ]\n"})}),"\n",(0,s.jsx)(n.h3,{id:"ondelete",children:"%OnDelete"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %OnDelete(oid As %ObjectIdentity) As %Status [ Private, ServerOnly = 1 ]\n"})}),"\n",(0,s.jsx)(n.h3,{id:"onopen",children:"%OnOpen"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %OnOpen() As %Status [ Private, ServerOnly = 1 ]\n"})}),"\n",(0,s.jsx)(n.h3,{id:"onafterimport",children:"%OnAfterImport"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %OnAfterImport() As %Status\n"})}),"\n",(0,s.jsx)(n.p,{children:"Notification that this item has just been imported."}),"\n",(0,s.jsx)(n.h3,{id:"xmlbeforeexport",children:"XMLBeforeExport"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method XMLBeforeExport()\n"})}),"\n",(0,s.jsx)(n.p,{children:"Notification before xml export."}),"\n",(0,s.jsx)(n.h3,{id:"copytocomponent",children:"%CopyToComponent"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %CopyToComponent(pPivot As %DeepSee.Component.pivotTable) As %Status [ Internal ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Copy the contents of this definition to pivot table pPivot."}),"\n",(0,s.jsx)(n.h3,{id:"copyfromcomponent",children:"%CopyFromComponent"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %CopyFromComponent(pPivot As %DeepSee.Component.pivotTable) As %Status [ Internal ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Set the contents of this definition from pivot table pPivot."}),"\n",(0,s.jsx)(n.h3,{id:"calculate",children:"%Calculate"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %Calculate() As %Status [ Internal ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Resolve values of any formulas within this worksheet. This takes the raw values in %cells, executes formulas, and puts the results into %values."}),"\n",(0,s.jsx)(n.h3,{id:"evaluatecell",children:"%EvaluateCell"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %EvaluateCell(pValue As %String, pRow As %Integer, pCol As %Integer, Output pResult As %String, Output pSC As %Status) As %Boolean [ Internal ]\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Evaluate formula for one cell.",(0,s.jsx)(n.br,{}),"\nReturn false if it has unresolved dependencies."]}),"\n",(0,s.jsx)(n.h3,{id:"lookup",children:"%Lookup"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method %Lookup(pIdent As %String) As %String\n"})}),"\n",(0,s.jsx)(n.p,{children:"Formula function: Lookup the value of the given identifier."}),"\n",(0,s.jsx)(n.h3,{id:"lookupreference",children:"%LookupReference"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %LookupReference(ByRef pContext, pIdent As %String) As %String [ Internal ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Lookup the value of a complete cell reference: [source].[col].[row] pContext tracks all the data sources that have been referenced."})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,n,l)=>{l.d(n,{R:()=>a,x:()=>i});var s=l(96540);const r={},t=s.createContext(r);function a(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);