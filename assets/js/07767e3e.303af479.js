"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[23535],{7976:(e,n,t)=>{t.r(n),t.d(n,{contentTitle:()=>i,default:()=>r,frontMatter:()=>s,toc:()=>a});var o=t(74848),c=t(28453);const s={pagination_prev:null,pagination_next:null},i="%SYSTEM.SQLGateway",a=[{value:"Methods",id:"methods",level:2},{value:"TestConnection",id:"testconnection",level:3},{value:"DropConnection",id:"dropconnection",level:3},{value:"GetJDBCConnection",id:"getjdbcconnection",level:3},{value:"DropAll",id:"dropall",level:3},{value:"GetODBCConnection",id:"getodbcconnection",level:3},{value:"SetAllODBCConnectOption",id:"setallodbcconnectoption",level:3},{value:"SetAutoCommit",id:"setautocommit",level:3},{value:"Transact",id:"transact",level:3}];function l(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"systemsqlgateway",children:"%SYSTEM.SQLGateway"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objectscript-class",children:"Class %SYSTEM.SQLGateway Extends Help [ Abstract, LegacyInstanceContext, System = 4 ]\n"})}),"\n",(0,o.jsx)(n.p,{children:"The %SYSTEM.SQLGateway class provides an interface for managing Gateway connections."}),"\n",(0,o.jsxs)(n.p,{children:["You can use it via the special ",(0,o.jsx)(n.strong,{children:"$system"})," object: ",(0,o.jsx)(n.code,{children:"Do $system.SQLGateway.DropAll()"})]}),"\n",(0,o.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,o.jsx)(n.h3,{id:"testconnection",children:"TestConnection"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod TestConnection(nm, timeout = 0, verbose = 1, error = "") As %Status\n'})}),"\n",(0,o.jsx)(n.p,{children:"Test a previously defined SQL Gateway connection."}),"\n",(0,o.jsx)(n.p,{children:"It writes the diagnostic ouput to a current device."}),"\n",(0,o.jsxs)(n.p,{children:["nm - connection name",(0,o.jsx)(n.br,{}),"\ntimeout - timeout (only relevant for ODBC connections)",(0,o.jsx)(n.br,{}),"\nverbose - setting to a non 0 value will cause the diagnostic output to the current device",(0,o.jsx)(n.br,{}),"\nerror - output variable for passing back an error if it occurs"]}),"\n",(0,o.jsx)(n.h3,{id:"dropconnection",children:"DropConnection"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod DropConnection(nm) As %Status\n"})}),"\n",(0,o.jsx)(n.p,{children:"Disconnect a JDBC or ODBC connection"}),"\n",(0,o.jsx)(n.p,{children:"nm - connection name"}),"\n",(0,o.jsx)(n.h3,{id:"getjdbcconnection",children:"GetJDBCConnection"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod GetJDBCConnection(cname) As %Binary\n"})}),"\n",(0,o.jsx)(n.p,{children:"Connect to a previously defined JDBC Gateway connection."}),"\n",(0,o.jsx)(n.p,{children:"It returns an empty string if the connection attempt was unsuccessful."}),"\n",(0,o.jsx)(n.p,{children:"nm - connection name"}),"\n",(0,o.jsx)(n.h3,{id:"dropall",children:"DropAll"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod DropAll() As %Status\n"})}),"\n",(0,o.jsx)(n.p,{children:"Drop all open connections and unload the SQL Gateway library."}),"\n",(0,o.jsx)(n.h3,{id:"getodbcconnection",children:"GetODBCConnection"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod GetODBCConnection(nm, timeout, legacy = "") As %Binary\n'})}),"\n",(0,o.jsx)(n.p,{children:"Connect to a previously defined SQL Gateway ODBC connection."}),"\n",(0,o.jsx)(n.p,{children:"It returns an empty string if the connection attempt was unsuccessful."}),"\n",(0,o.jsxs)(n.p,{children:["nm - connection name",(0,o.jsx)(n.br,{}),"\ntimeout - timeout",(0,o.jsx)(n.br,{}),"\nlegacy - legacy mode"]}),"\n",(0,o.jsx)(n.h3,{id:"setallodbcconnectoption",children:"SetAllODBCConnectOption"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod SetAllODBCConnectOption(option, vparm) As %Status\n"})}),"\n",(0,o.jsx)(n.p,{children:"Set the given integer option for all open connections"}),"\n",(0,o.jsxs)(n.p,{children:["option - option to set",(0,o.jsx)(n.br,{}),"\nvparm - value associated with option"]}),"\n",(0,o.jsx)(n.h3,{id:"setautocommit",children:"SetAutoCommit"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod SetAutoCommit(ac) As %Status\n"})}),"\n",(0,o.jsx)(n.p,{children:"Set the autocommit mode for all open connections"}),"\n",(0,o.jsx)(n.p,{children:"ac = { 0 - AUTOCOMMIT OFF, 1 - AUTOCOMMIT ON}"}),"\n",(0,o.jsx)(n.h3,{id:"transact",children:"Transact"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod Transact(ttype) As %Status\n"})}),"\n",(0,o.jsx)(n.p,{children:"Request a commit or rollback operation for all active operations on JDBC or ODBC connections."}),"\n",(0,o.jsx)(n.p,{children:"type = { 0 - SQL_COMMIT, 1 - SQL_ROLLBACK}"})]})}function r(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var o=t(96540);const c={},s=o.createContext(c);function i(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);