"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[17442],{67581:(e,n,t)=>{t.r(n),t.d(n,{contentTitle:()=>d,default:()=>i,frontMatter:()=>o,toc:()=>a});var s=t(74848),c=t(28453);const o={pagination_prev:null,pagination_next:null},d="%XML.Document",a=[{value:"Methods",id:"methods",level:2},{value:"CreateDocument",id:"createdocument",level:3},{value:"GetDocumentFromStream",id:"getdocumentfromstream",level:3},{value:"GetDocumentElement",id:"getdocumentelement",level:3},{value:"GetDocumentNode",id:"getdocumentnode",level:3},{value:"GetNode",id:"getnode",level:3},{value:"GetNodeById",id:"getnodebyid",level:3},{value:"SetNodeById",id:"setnodebyid",level:3},{value:"GetNamespace",id:"getnamespace",level:3},{value:"CountNamespace",id:"countnamespace",level:3},{value:"InsertNamespace",id:"insertnamespace",level:3},{value:"FindNamespace",id:"findnamespace",level:3},{value:"GetVersion",id:"getversion",level:3}];function r(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"xmldocument",children:"%XML.Document"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Class %XML.Document Extends (%XML.ImportHandler, %XML.Node) [ Inheritance = right, System = 2 ]\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"For details on using this class"}),", see ",(0,s.jsx)(n.a,{href:"/csp/docbook/Doc.View.cls?FIND=CLASSES+%25XML.Document",children:"Representing an XML Document as a DOM"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"%XML.Document represents an XML document as an Document Object Model (DOM). The DOM may be created either"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"from an XML document by accessing the Document property of %XML.Reader after calling an Openxxx method of %XML.Reader."}),"\n",(0,s.jsx)(n.li,{children:"as a new DOM by calling the CreateDocument of this class."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The %XML.Document class maintains the namespaces for the DOM. The %XML.Node class created by GetDocumentElement may be used to navigate the DOM or the macros in %xmlDOM.inc may be used to navigate the DOM based on the DocumentId of %XML.Document."}),"\n",(0,s.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(n.h3,{id:"createdocument",children:"CreateDocument"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod CreateDocument(localName As %String, namespace As %String) As %XML.Document\n"})}),"\n",(0,s.jsx)(n.p,{children:"Create a new Document Object Model (DOM) consisting of only a root element."}),"\n",(0,s.jsx)(n.h3,{id:"getdocumentfromstream",children:"GetDocumentFromStream"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod GetDocumentFromStream(stream As %BinaryStream, Output document As %XML.Document) As %Status\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Create a doocument by parsing the XML document contained in a stream.",(0,s.jsx)(n.br,{}),"\nThe parsed document is returned in document.",(0,s.jsx)(n.br,{}),"\nA %Status is returned to indicate if parsing is successful."]}),"\n",(0,s.jsx)(n.h3,{id:"getdocumentelement",children:"GetDocumentElement"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetDocumentElement() As %XML.Node [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Returns an %XML.Node DOM navigation object which is positioned at the the root element of this Document."}),"\n",(0,s.jsx)(n.h3,{id:"getdocumentnode",children:"GetDocumentNode"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetDocumentNode() As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Returns the node id of the root element of this Document."}),"\n",(0,s.jsx)(n.h3,{id:"getnode",children:"GetNode"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetNode(nodeId As %String) As %XML.Node\n"})}),"\n",(0,s.jsx)(n.p,{children:"Returns an %XML.Node DOM navigation object which is positioned at the the node specified by the nodeId argument."}),"\n",(0,s.jsx)(n.h3,{id:"getnodebyid",children:"GetNodeById"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetNodeById(id As %String) [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Return nodeId for node with id attribute = %id."}),"\n",(0,s.jsx)(n.h3,{id:"setnodebyid",children:"SetNodeById"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method SetNodeById(id As %String, nodeId As %Integer)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Save nodeId for node with id attribute = %id."}),"\n",(0,s.jsx)(n.h3,{id:"getnamespace",children:"GetNamespace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetNamespace(nsIndex As %Integer) As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Return XML namespace URI for nsIndex into document's namespace table."}),"\n",(0,s.jsx)(n.h3,{id:"countnamespace",children:"CountNamespace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method CountNamespace() As %Integer [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Return number of namepsaces in document's namespace table."}),"\n",(0,s.jsx)(n.h3,{id:"insertnamespace",children:"InsertNamespace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method InsertNamespace(namespace As %String)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Return XML namespace URI for nsIndex into document's namespace table."}),"\n",(0,s.jsx)(n.h3,{id:"findnamespace",children:"FindNamespace"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method FindNamespace(namespace As %String) As %Integer [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Return XML nsIndex into document's namespace table for namespace URI."}),"\n",(0,s.jsx)(n.h3,{id:"getversion",children:"GetVersion"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetVersion() As %Integer [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(n.p,{children:'Return the version of the import handler that constructed this document. A programmatically constructed DOM will always have version "".'})]})}function i(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(r,{...e})}):r(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>a});var s=t(96540);const c={},o=s.createContext(c);function d(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:d(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);