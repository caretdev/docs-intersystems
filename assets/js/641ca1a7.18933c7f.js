"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[91235],{44646:(e,n,s)=>{s.r(n),s.d(n,{contentTitle:()=>l,default:()=>d,frontMatter:()=>i,toc:()=>a});var r=s(74848),t=s(28453);const i={pagination_prev:null,pagination_next:null},l="%Net.abstractMQ",a=[{value:"Parameters",id:"parameters",level:2},{value:"MessageId",id:"messageid",level:3},{value:"CorrelationId",id:"correlationid",level:3},{value:"ReplyQMgrName",id:"replyqmgrname",level:3},{value:"ReplyQName",id:"replyqname",level:3},{value:"ApplIdentityData",id:"applidentitydata",level:3},{value:"Properties",id:"properties",level:2},{value:"mDesc",id:"mdesc",level:3},{value:"mDllid",id:"mdllid",level:3},{value:"MQConnectID",id:"mqconnectid",level:3},{value:"MQDisconnID",id:"mqdisconnid",level:3},{value:"MQOpenQID",id:"mqopenqid",level:3},{value:"MQOpenTopicID",id:"mqopentopicid",level:3},{value:"MQCloseQID",id:"mqcloseqid",level:3},{value:"MQDeleteID",id:"mqdeleteid",level:3},{value:"MQCommitID",id:"mqcommitid",level:3},{value:"MQGetID",id:"mqgetid",level:3},{value:"MQPutID",id:"mqputid",level:3},{value:"MQGetStreamID",id:"mqgetstreamid",level:3},{value:"MQPutStreamID",id:"mqputstreamid",level:3},{value:"MQMsgDescID",id:"mqmsgdescid",level:3},{value:"MQMsgDescIID",id:"mqmsgdesciid",level:3},{value:"MQMsgDescSetID",id:"mqmsgdescsetid",level:3},{value:"MQErrLogID",id:"mqerrlogid",level:3},{value:"MQGetLastErrID",id:"mqgetlasterrid",level:3},{value:"MQSetChannelID",id:"mqsetchannelid",level:3},{value:"MQSetUserPassID",id:"mqsetuserpassid",level:3},{value:"MQSubscribeID",id:"mqsubscribeid",level:3},{value:"qtype",id:"qtype",level:3},{value:"QName",id:"qname",level:3},{value:"QMgr",id:"qmgr",level:3},{value:"Channel",id:"channel",level:3},{value:"Transport",id:"transport",level:3},{value:"Connection",id:"connection",level:3},{value:"SSLCipherSpec",id:"sslcipherspec",level:3},{value:"Username",id:"username",level:3},{value:"Password",id:"password",level:3},{value:"CharSetId",id:"charsetid",level:3},{value:"MessageId",id:"messageid-1",level:3},{value:"CorrelationId",id:"correlationid-1",level:3},{value:"ReplyQMgrName",id:"replyqmgrname-1",level:3},{value:"ReplyQName",id:"replyqname-1",level:3},{value:"ApplIdentityData",id:"applidentitydata-1",level:3},{value:"PutApplType",id:"putappltype",level:3},{value:"Syncpoint",id:"syncpoint",level:3},{value:"Context",id:"context",level:3},{value:"QMBehavior",id:"qmbehavior",level:3},{value:"Methods",id:"methods",level:2},{value:"%GetLastError",id:"getlasterror",level:3},{value:"%Connect",id:"connect",level:3},{value:"%Init",id:"init",level:3},{value:"%Commit",id:"commit",level:3},{value:"%Backout",id:"backout",level:3},{value:"%CharSet",id:"charset",level:3},{value:"%ErrLog",id:"errlog",level:3},{value:"%SetCharSet",id:"setcharset",level:3},{value:"%MsgId",id:"msgid",level:3},{value:"%CorId",id:"corid",level:3},{value:"%ReplyQMgrName",id:"replyqmgrname-2",level:3},{value:"%ReplyQName",id:"replyqname-2",level:3},{value:"%ApplIdentityData",id:"applidentitydata-2",level:3},{value:"%PutApplType",id:"putappltype-1",level:3},{value:"%Syncpoint",id:"syncpoint-1",level:3},{value:"%OnClose",id:"onclose",level:3},{value:"%OnNew",id:"onnew",level:3}];function c(e){const n={a:"a",channel:"channel",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hostname:"hostname",p:"p",port:"port",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"netabstractmq",children:"%Net.abstractMQ"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Class %Net.abstractMQ Extends %RegisteredObject [ Abstract, System = 3 ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"For information on using the API provided by this class"}),", see ",(0,r.jsx)(n.a,{href:"/csp/docbook/DocBook.UI.Page.cls?FIND=CLASSES+%25Net.abstractMQ",children:"Using MQ"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%Net.MQ"})," class provides an interface to the IBM WebSphere MQ Series messaging product. Two classes are provided: %Net.MQSend for sending messages to a queue, and %Net.MQRecv for picking up messages that have been queued."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Usage"})}),"\n",(0,r.jsxs)(n.p,{children:["An MQ object is created when an instance of an MQ class is created via ",(0,r.jsx)(n.strong,{children:"%New"}),". Following creation, the class can be assigned an error log file, and connected to an MQ Server."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%Init()"})," method is a simple way to perform both these functions."]}),"\n",(0,r.jsx)(n.p,{children:"For advanced applications, these steps can be performed via separate method calls."}),"\n",(0,r.jsxs)(n.p,{children:["To establish an error log file for the class, call ",(0,r.jsx)(n.strong,{children:"%ErrLog()"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["A connection is established by calling the ",(0,r.jsx)(n.strong,{children:"%Connect()"})," method. The connection is maintained until you deallocate the instance. The instance must be successfully connected before it can be used for message queuing."]}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.strong,{children:"MQSend.%Put()"})," to send messages to a queue. Use ",(0,r.jsx)(n.strong,{children:"MQRecv.%Get()"})," to read messages from a queue."]}),"\n",(0,r.jsxs)(n.p,{children:["All methods return 1 for success, 0 for failure. In case of a failure, the actual MQ error code is available via the method ",(0,r.jsx)(n.strong,{children:"%GetLastError()"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Charcter Set Translation"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"%CharSet(.ccs)"})," Retrieves the Coded Character Set identifier. This value may be altered by the message system after an unsuccessful attempt to convert data in MQGet."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"%SetCharSet(id)"})," Sets the Coded Character Set identifier. Incoming messages will be converted to this character set. Outgoing message's character set encoding is identified to the message queue with this value."]}),"\n",(0,r.jsx)(n.p,{children:"For output (MQSend.%Put()), the Coded Character Set Id describes to the system the char set used for the message. If not set, the MQ system assumes the default character set for the MQ client."}),"\n",(0,r.jsx)(n.p,{children:"For input (MQRecv.%Get()), the Coded Character Set Id indicates to the MQ client how the message should be converted. The conversion is done automatically during message reciept on the client."}),"\n",(0,r.jsx)(n.p,{children:"Thus one may send messages in any encoding (notifying the system what the encoding used is), and receive messages converting from one encoding to another."}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.p,{children:"To convert a message encoded in EBCDIC (Character Coded Set Id 1047, indicating IBM-1047 coding), a user on a Windows system may wish to convert using code 437 (the default on Windows systems). Then the following will convert the EBCDIC message to ascii on the windows system:"}),"\n",(0,r.jsx)(n.p,{children:"Do mq.%SetCharSet(437) ;437 English ascii code on Windows"}),"\n",(0,r.jsx)(n.p,{children:"Do mq.%Get(.msg) ;converts the message to 437 code"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"MQ Documentation"})}),"\n",(0,r.jsx)(n.p,{children:"Consult the IBM WebSphere MQ website for further documentation."}),"\n",(0,r.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(n.h3,{id:"messageid",children:"MessageId"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Parameter MessageId = 1;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"correlationid",children:"CorrelationId"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Parameter CorrelationId = 2;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"replyqmgrname",children:"ReplyQMgrName"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Parameter ReplyQMgrName = 3;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"replyqname",children:"ReplyQName"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Parameter ReplyQName = 4;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"applidentitydata",children:"ApplIdentityData"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Parameter ApplIdentityData = 5;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(n.h3,{id:"mdesc",children:"mDesc"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'Property mDesc As %Integer [ InitialExpression = "0", Internal ];\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Handle to the MQInterface object created by ",(0,r.jsx)(n.strong,{children:"%New."})]}),"\n",(0,r.jsx)(n.h3,{id:"mdllid",children:"mDllid"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'Property mDllid As %Integer [ InitialExpression = "-1", Internal ];\n'})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the loaded MQInterface shared library"}),"\n",(0,r.jsx)(n.h3,{id:"mqconnectid",children:"MQConnectID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQConnectID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Connect function"}),"\n",(0,r.jsx)(n.h3,{id:"mqdisconnid",children:"MQDisconnID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQDisconnID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Disconnect function"}),"\n",(0,r.jsx)(n.h3,{id:"mqopenqid",children:"MQOpenQID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQOpenQID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Open Queue function"}),"\n",(0,r.jsx)(n.h3,{id:"mqopentopicid",children:"MQOpenTopicID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQOpenTopicID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Open Topic function"}),"\n",(0,r.jsx)(n.h3,{id:"mqcloseqid",children:"MQCloseQID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQCloseQID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Close Queue function"}),"\n",(0,r.jsx)(n.h3,{id:"mqdeleteid",children:"MQDeleteID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQDeleteID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Close function"}),"\n",(0,r.jsx)(n.h3,{id:"mqcommitid",children:"MQCommitID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQCommitID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Commit function"}),"\n",(0,r.jsx)(n.h3,{id:"mqgetid",children:"MQGetID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQGetID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Get function"}),"\n",(0,r.jsx)(n.h3,{id:"mqputid",children:"MQPutID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQPutID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Put function"}),"\n",(0,r.jsx)(n.h3,{id:"mqgetstreamid",children:"MQGetStreamID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQGetStreamID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Get Stream function"}),"\n",(0,r.jsx)(n.h3,{id:"mqputstreamid",children:"MQPutStreamID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQPutStreamID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Put Stream function"}),"\n",(0,r.jsx)(n.h3,{id:"mqmsgdescid",children:"MQMsgDescID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQMsgDescID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to access the Message Descriptor"}),"\n",(0,r.jsx)(n.h3,{id:"mqmsgdesciid",children:"MQMsgDescIID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQMsgDescIID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to access integer pieces of the Message Descriptor"}),"\n",(0,r.jsx)(n.h3,{id:"mqmsgdescsetid",children:"MQMsgDescSetID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQMsgDescSetID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to set the Message Descriptor"}),"\n",(0,r.jsx)(n.h3,{id:"mqerrlogid",children:"MQErrLogID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQErrLogID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the errlog function"}),"\n",(0,r.jsx)(n.h3,{id:"mqgetlasterrid",children:"MQGetLastErrID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQGetLastErrID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the errlog function"}),"\n",(0,r.jsx)(n.h3,{id:"mqsetchannelid",children:"MQSetChannelID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQSetChannelID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Connection Options function"}),"\n",(0,r.jsx)(n.h3,{id:"mqsetuserpassid",children:"MQSetUserPassID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQSetUserPassID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Connection Auth function"}),"\n",(0,r.jsx)(n.h3,{id:"mqsubscribeid",children:"MQSubscribeID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MQSubscribeID As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Handle to the Subscribe function"}),"\n",(0,r.jsx)(n.h3,{id:"qtype",children:"qtype"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property qtype As %Integer [ Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"MQ type"}),"\n",(0,r.jsx)(n.h3,{id:"qname",children:"QName"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property QName As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Queue name"}),"\n",(0,r.jsx)(n.h3,{id:"qmgr",children:"QMgr"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property QMgr As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Queue Manager name"}),"\n",(0,r.jsx)(n.h3,{id:"channel",children:"Channel"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property Channel As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Channel Definition Options: Channel Name"}),"\n",(0,r.jsx)(n.h3,{id:"transport",children:"Transport"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property Transport As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Channel Definition Options: Transport type"}),"\n",(0,r.jsx)(n.h3,{id:"connection",children:"Connection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property Connection As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Channel Definition Options: Connection name"}),"\n",(0,r.jsx)(n.h3,{id:"sslcipherspec",children:"SSLCipherSpec"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property SSLCipherSpec As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Channel Definition Options: SSL Cipher Spec"}),"\n",(0,r.jsx)(n.h3,{id:"username",children:"Username"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property Username As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Channel Definition Options: Username (if any)"}),"\n",(0,r.jsx)(n.h3,{id:"password",children:"Password"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property Password As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Channel Definition Options: Password (if any)"}),"\n",(0,r.jsx)(n.h3,{id:"charsetid",children:"CharSetId"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property CharSetId As %Integer;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Message Descriptor Options: Character Set Identifier"}),"\n",(0,r.jsx)(n.h3,{id:"messageid-1",children:"MessageId"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property MessageId As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Message Descriptor Options: Message Id"}),"\n",(0,r.jsx)(n.h3,{id:"correlationid-1",children:"CorrelationId"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property CorrelationId As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Message Descriptor Options: Correlation Id"}),"\n",(0,r.jsx)(n.h3,{id:"replyqmgrname-1",children:"ReplyQMgrName"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property ReplyQMgrName As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Message Descriptor Options: Reply Q Manager name"}),"\n",(0,r.jsx)(n.h3,{id:"replyqname-1",children:"ReplyQName"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property ReplyQName As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Message Descriptor Options: Reply Q name"}),"\n",(0,r.jsx)(n.h3,{id:"applidentitydata-1",children:"ApplIdentityData"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property ApplIdentityData As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Message Descriptor Options: Application Identity"}),"\n",(0,r.jsx)(n.h3,{id:"putappltype",children:"PutApplType"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property PutApplType As %Integer;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Message Descriptor Options: Put application type"}),"\n",(0,r.jsx)(n.h3,{id:"syncpoint",children:"Syncpoint"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property Syncpoint As %Boolean [ InitialExpression = 0 ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Flag indicating use of SYNCPOINT"}),"\n",(0,r.jsx)(n.h3,{id:"context",children:"Context"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property Context As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Flag indicating use of message context 0 - DEFAULT, 1 - IDENTITY, 2 - ALL"}),"\n",(0,r.jsx)(n.h3,{id:"qmbehavior",children:"QMBehavior"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property QMBehavior As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Flag indicating Queue Manager behavior 0 - commit on disconnect (DEFAULT), 1 - backout on disconnect"}),"\n",(0,r.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(n.h3,{id:"getlasterror",children:"%GetLastError"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %GetLastError() As %Integer\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"%GetLastError"})," returns the last error or reason code returned from MQ."]}),"\n",(0,r.jsx)(n.h3,{id:"connect",children:"%Connect"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %Connect() As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"%Connect"})," creates a connection to a queue manager and opens the queue object. A connection and open MQ object (queue, topic, subscription) is required before messages can be sent or received."]}),"\n",(0,r.jsx)(n.p,{children:"User must first set the standard MQSeries initialization arguments"}),"\n",(0,r.jsx)(n.p,{children:"QName: Host Queue Name (Required)"}),"\n",(0,r.jsx)(n.p,{children:'QMgr: Host Queue Manager name. Passing "" connects to the default queue manager. (Optional)'}),"\n",(0,r.jsx)(n.p,{children:"Channel: Host Channel name (Optional)"}),"\n",(0,r.jsx)(n.p,{children:"Transport: Transport type (TCP, LU62, NETBIOS, SPX) (Optional)"}),"\n",(0,r.jsx)(n.p,{children:'Connection: Connection spec, e.g., "127.0.0.1(1401)" (Optional)'}),"\n",(0,r.jsx)(n.p,{children:"See IBM MQ documentation on establishing defaults, and MQ authentication."}),"\n",(0,r.jsx)(n.h3,{id:"init",children:"%Init"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'Method %Init(QName As %String, QMgr As %String, QChannel As %String, ErrorFile As %String = "") As %Boolean\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"%Init"})," creates a connection to a queue. A connection is required before messages can be sent or received. Use the following standard MQSeries initialization arguments:"]}),"\n",(0,r.jsx)(n.p,{children:"QName: Host Queue name (Required)"}),"\n",(0,r.jsx)(n.p,{children:'QMgr: Host Queue Manager name. Passing "" connects to the default queue manager. (Optional)'}),"\n",(0,r.jsxs)(n.p,{children:["QChannel: Host Channel specification, in form ",(0,r.jsxs)(n.channel,{children:["/TCP/",(0,r.jsxs)(n.hostname,{children:["(",(0,r.jsx)(n.port,{children:") If not set, MQ connects to the default Channel. (Optional)"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"ErrorFile: For logging, specify a file name to store MQ system returned messages. (Optional)"}),"\n",(0,r.jsx)(n.p,{children:"%Init returns 0 on failure, 1 on success."}),"\n",(0,r.jsx)(n.h3,{id:"commit",children:"%Commit"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %Commit() As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"%Commit"})," commits changes to the queue. Used in conjunction with the syncpoint option. If the syncpoint option is set, then when sending, no messages are visible on the queue until commit. When receiving, the messages are not removed from the queue until commit is issued."]}),"\n",(0,r.jsx)(n.p,{children:"%Commit returns 0 on failure, 1 on success."}),"\n",(0,r.jsx)(n.h3,{id:"backout",children:"%Backout"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %Backout() As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"%Backout"})," backs out changes to the queue. Used in conjunction with the syncpoint option. If the syncpoint option is set, then when sending, no messages are visible on the queue until commit. If backout is called, all the messages sent since the last commit are removed from the queue. When receiving, the messages are not removed from the queue until commit is issued. If backout is called, the messages are restored to the queue and available to users."]}),"\n",(0,r.jsx)(n.p,{children:"%Backout returns 0 on failure, 1 on success."}),"\n",(0,r.jsx)(n.h3,{id:"charset",children:"%CharSet"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %CharSet(ByRef Value As %Integer) As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%CharSet"})," method returns the current value of the Coded Character Set Id used for message conversion. The CCSId may also be set to the message's Character Set if conversion was not possible."]}),"\n",(0,r.jsx)(n.h3,{id:"errlog",children:"%ErrLog"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %ErrLog(log As %String) As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%ErrLog"})," method creates an error log to be used for errors on this object."]}),"\n",(0,r.jsx)(n.h3,{id:"setcharset",children:"%SetCharSet"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %SetCharSet(Value As %Integer) As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%SetCharSet"})," method sets the Coded Character Set Id to be used for message conversion."]}),"\n",(0,r.jsx)(n.h3,{id:"msgid",children:"%MsgId"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %MsgId(ByRef Value As %String) As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%MsgId"})," method returns the Message Id for the last message read."]}),"\n",(0,r.jsx)(n.h3,{id:"corid",children:"%CorId"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %CorId(ByRef Value As %String) As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%CorId"})," method returns the Correlation Id for the last message read."]}),"\n",(0,r.jsx)(n.h3,{id:"replyqmgrname-2",children:"%ReplyQMgrName"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %ReplyQMgrName(ByRef Value As %String) As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%ReplyQMgrName"})," method returns the Reply Queue Manager Name for the last message read."]}),"\n",(0,r.jsx)(n.h3,{id:"replyqname-2",children:"%ReplyQName"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %ReplyQName(ByRef Value As %String) As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%ReplyQName"})," method returns the Reply Queue Name for the last message read."]}),"\n",(0,r.jsx)(n.h3,{id:"applidentitydata-2",children:"%ApplIdentityData"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %ApplIdentityData(ByRef Value As %String) As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%ApplIdentityData"})," method returns the Application Identity Data for the last message read."]}),"\n",(0,r.jsx)(n.h3,{id:"putappltype-1",children:"%PutApplType"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %PutApplType(ByRef Value As %Integer) As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%PutApplType"})," method returns the Put Application Type for the last message read."]}),"\n",(0,r.jsx)(n.h3,{id:"syncpoint-1",children:"%Syncpoint"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %Syncpoint(ByRef Value As %Integer) As %Boolean\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.strong,{children:"%Syncpoint"})," method returns the current syncpoint status for the connection."]}),"\n",(0,r.jsx)(n.h3,{id:"onclose",children:"%OnClose"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %OnClose() As %Status [ Internal, Private ]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"onnew",children:"%OnNew"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %OnNew(Arg1Ignored As %String) As %Status [ Internal, Private ]\n"})})]})}function d(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var r=s(96540);const t={},i=r.createContext(t);function l(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);