"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[35044],{71446:(e,n,i)=>{i.r(n),i.d(n,{contentTitle:()=>l,default:()=>c,frontMatter:()=>r,toc:()=>o});var t=i(74848),s=i(28453);const r={pagination_prev:null,pagination_next:null},l="%Library.RoutineIndex",o=[{value:"Properties",id:"properties",level:2},{value:"Modified",id:"modified",level:3},{value:"Length",id:"length",level:3},{value:"Type",id:"type",level:3},{value:"Name",id:"name",level:3},{value:"Methods",id:"methods",level:2},{value:"RebuildIndex",id:"rebuildindex",level:3},{value:"RebuildItemIndex",id:"rebuilditemindex",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"libraryroutineindex",children:"%Library.RoutineIndex"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Class %Library.RoutineIndex Extends %Persistent [ Not ProcedureBlock, System = 3 ]\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Index for all the routines in this namespace. Using this index avoids the overhead of loading all the information from ^ROUTINE, ^rMAC, ^rINC which makes the routine editing tool substantially faster. In case you have tools that enter routines directly into the global and you wish to add this routine to the index then after you have edited the global you should call: ",(0,t.jsx)(n.code,{children:"Do RebuildItemIndex^%R(Name,Type)"})," The global structure is:"]}),"\n",(0,t.jsxs)(n.p,{children:["^rINDEX(",(0,t.jsx)(n.strong,{children:"Name"}),",",(0,t.jsx)(n.strong,{children:"Type"}),")=$ListBuild(",(0,t.jsx)(n.strong,{children:"Modified"}),",",(0,t.jsx)(n.strong,{children:"Length"}),")"]}),"\n",(0,t.jsx)(n.p,{children:"Where:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Type"}),' - is one of "MAC","INT","BAS","MVB","INC","OBJ"']}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Name"})," - is the name of this item, eg routine '%qserver' for classes this is the upper case version."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Modified"})," - is the last date/time the routine was modified in $zdt($h,3) format"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Length"})," - is the size in bytes"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,t.jsx)(n.h3,{id:"modified",children:"Modified"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property Modified As %TimeStamp;\n"})}),"\n",(0,t.jsx)(n.p,{children:"The date/time that this routine was last saved."}),"\n",(0,t.jsx)(n.h3,{id:"length",children:"Length"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property Length As %Integer;\n"})}),"\n",(0,t.jsx)(n.p,{children:"The size in bytes of this routine."}),"\n",(0,t.jsx)(n.h3,{id:"type",children:"Type"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property Type As %String [ Required ];\n"})}),"\n",(0,t.jsx)(n.p,{children:"The type of routine, this will be one of:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"MAC"})," - Macro routine, content is stored in ^rMAC global"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"INT"})," - ObjectScript routine, content is stored in ^ROUTINE global"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"INC"})," - Include file, these may be included from a MAC routine, content is stored in ^rINC"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"BAS"})," - Cache Basic routine, content is stored in the ^ROUTINE global"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"MVB"})," - MultiValue Basic routine, content is stored in the ^ROUTINE global"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"OBJ"})," - Object code, content is stored in ^rOBJ global"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"name",children:"Name"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"Property Name As %String(MAXLEN = 128) [ Required ];\n"})}),"\n",(0,t.jsx)(n.p,{children:"The name of the routine."}),"\n",(0,t.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(n.h3,{id:"rebuildindex",children:"RebuildIndex"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod RebuildIndex(namespace As %String, ByRef num As %Integer) As %Status\n"})}),"\n",(0,t.jsx)(n.p,{children:"In case this index gets out of sync with the routines in the current namespace you can call this method to rebuild the index from the various ^ROUTINE, ^rINC, ^rMAC globals. This only rebuilds the index for entries that really live in this namespace, if you have routine mappings so that some routines are in a separate namespace you will need to rebuilt these seperately."}),"\n",(0,t.jsx)(n.h3,{id:"rebuilditemindex",children:"RebuildItemIndex"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod RebuildItemIndex(rtn As %String, ext As %String, namespace As %String) As %Status\n"})}),"\n",(0,t.jsx)(n.p,{children:'Rebuild the index information for this single item. You pass this the rtn name, its ext (one of "INT", "INC", "MAC", "BAS", "MVB", "OBJ") and optionally the namespace as namespace. You can call this after modifying the routine global directly to update the index correct with the new information.'})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>o});var t=i(96540);const s={},r=t.createContext(s);function l(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);