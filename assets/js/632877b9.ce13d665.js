"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[24201],{15358:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>a,default:()=>d,frontMatter:()=>i,toc:()=>l});var s=n(74848),r=n(28453);const i={pagination_prev:null,pagination_next:null},a="%Library.ArrayOfObjects",l=[{value:"Parameters",id:"parameters",level:2},{value:"CLASSNAMEINOID",id:"classnameinoid",level:3},{value:"ELEMENTTYPE",id:"elementtype",level:3},{value:"Properties",id:"properties",level:2},{value:"Oref",id:"oref",level:3},{value:"ElementType",id:"elementtype-1",level:3},{value:"Data",id:"data",level:3},{value:"Methods",id:"methods",level:2},{value:"Count",id:"count",level:3},{value:"IsDefined",id:"isdefined",level:3},{value:"Define",id:"define",level:3},{value:"Next",id:"next",level:3},{value:"Previous",id:"previous",level:3},{value:"BuildValueArray",id:"buildvaluearray",level:3},{value:"Clear",id:"clear",level:3},{value:"Find",id:"find",level:3},{value:"FindObjectId",id:"findobjectid",level:3},{value:"GetAt",id:"getat",level:3},{value:"GetObjectAt",id:"getobjectat",level:3},{value:"GetObjectIdAt",id:"getobjectidat",level:3},{value:"GetNext",id:"getnext",level:3},{value:"GetObjectNext",id:"getobjectnext",level:3},{value:"GetObjectIdNext",id:"getobjectidnext",level:3},{value:"GetPrevious",id:"getprevious",level:3},{value:"GetObjectPrevious",id:"getobjectprevious",level:3},{value:"GetObjectIdPrevious",id:"getobjectidprevious",level:3},{value:"RemoveAt",id:"removeat",level:3},{value:"SetAt",id:"setat",level:3},{value:"SetObjectAt",id:"setobjectat",level:3},{value:"SetObjectIdAt",id:"setobjectidat",level:3},{value:"%AddToSaveSet",id:"addtosaveset",level:3},{value:"%SerializeObject",id:"serializeobject",level:3},{value:"%UnSwizzleAt",id:"unswizzleat",level:3},{value:"%GetSerial",id:"getserial",level:3},{value:"%SetSerial",id:"setserial",level:3},{value:"%OnConstructClone",id:"onconstructclone",level:3},{value:"%OnNew",id:"onnew",level:3}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"libraryarrayofobjects",children:"%Library.ArrayOfObjects"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Class %Library.ArrayOfObjects Extends (%Collection.AbstractArrayOfObj, %SerialObject) [ ClassType = serial, OdbcType = VARCHAR, StorageStrategy = Custom, System = 2 ]\n"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"For information on this class"}),", see ",(0,s.jsx)(t.a,{href:"/csp/docbook/Doc.View.cls?FIND=CLASSES+%25Library.ArrayOfObjects",children:"Working with Collections"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"The %ArrayOfObjects class represents an array of references to objects, each of which is associated with a unique key value. Keys can have any value, string or numeric. The objects referred to must be registered. They can be either persistent objects or non-id objects."}),"\n",(0,s.jsx)(t.p,{children:'Internally, an %ArrayOfObjects object contains two arrays: one for holding the OID values for the objects referred to (or their serialized state in the case of an array of non-id objects); and another for holding the OREF values for any objects that have been explicitly referred to, and hence "swizzled" into memory. Swizzling (loading an object into memory and generating an OREF value for it) happens automatically whenever the user refers to an object within the array.'}),"\n",(0,s.jsxs)(t.p,{children:["For example, if array is an %ArrayOfObjects object containing an array of ",(0,s.jsx)(t.strong,{children:"Doctor"})," objects (that is an array of OID values for Doctor objects stored in the database) then the following code fragment will automatically load the ",(0,s.jsx)(t.strong,{children:"Doctor"}),' object associated with the key "Primary" into memory and generate an OREF value referring to the in-memory version of the ',(0,s.jsx)(t.strong,{children:"Doctor"})," object. This OREF value can then be used to access the properties and methods of the ",(0,s.jsx)(t.strong,{children:"Doctor"})," object: ",(0,s.jsx)(t.code,{children:'Set doc=array.GetAt("Primary") Write doc.Name'})]}),"\n",(0,s.jsxs)(t.p,{children:["Alternatively, we could use cascading dot syntax: ",(0,s.jsx)(t.code,{children:'Set name=array.GetAt("Primary").Name'})]}),"\n",(0,s.jsxs)(t.p,{children:["When the %ArrayOfObjects object is closed (removed from memory), it will close (call ",(0,s.jsx)(t.strong,{children:"%Close"})," on) all of the references it has swizzled into memory. These classes can be used 'standalone' to store a collection."]}),"\n",(0,s.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsx)(t.h3,{id:"classnameinoid",children:"CLASSNAMEINOID"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Parameter CLASSNAMEINOID = 0;\n"})}),"\n",(0,s.jsx)(t.p,{children:"This parameter determines how the collection object stores OID values. If this parameter is set to 0, then partially-formed OID values, containing only an ID number, are used. If this parameter is set to 1, then fully-formed OID values, containing both a class name and an ID number, are used."}),"\n",(0,s.jsx)(t.h3,{id:"elementtype",children:"ELEMENTTYPE"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter ELEMENTTYPE = "%RegisteredObject";\n'})}),"\n",(0,s.jsx)(t.p,{children:"The type (class name) of the elements stored in the collection."}),"\n",(0,s.jsx)(t.h2,{id:"properties",children:"Properties"}),"\n",(0,s.jsx)(t.h3,{id:"oref",children:"Oref"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Property Oref As %String [ MultiDimensional ];\n"})}),"\n",(0,s.jsx)(t.p,{children:"Private storage area used to hold OREF values."}),"\n",(0,s.jsx)(t.h3,{id:"elementtype-1",children:"ElementType"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Property ElementType As %String(MAXLEN = 256) [ InitialExpression = {..#ELEMENTTYPE} ];\n"})}),"\n",(0,s.jsx)(t.p,{children:"The type (class name) of the elements stored in the collection."}),"\n",(0,s.jsx)(t.h3,{id:"data",children:"Data"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Property Data As %String [ MultiDimensional ];\n"})}),"\n",(0,s.jsx)(t.p,{children:"Data is a private property used to hold the contents of the array."}),"\n",(0,s.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(t.h3,{id:"count",children:"Count"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Count() As %Integer [ ProcedureBlock = 1 ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Returns the number of elements contained in the array."}),"\n",(0,s.jsx)(t.h3,{id:"isdefined",children:"IsDefined"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method IsDefined(key As %String) As %Boolean [ CodeMode = expression, Final ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Returns true (1) if a value is defined at location key, otherwise false (0)."}),"\n",(0,s.jsx)(t.h3,{id:"define",children:"Define"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Define(key As %String) As %Boolean [ CodeMode = expression, Deprecated, Final ]\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"This method is deprecated."})}),"\n",(0,s.jsx)(t.p,{children:"Please use IsDefined instead."}),"\n",(0,s.jsx)(t.h3,{id:"next",children:"Next"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method Next(key As %String = "") As %String [ CodeMode = expression, Final ]\n'})}),"\n",(0,s.jsxs)(t.p,{children:['Finds and returns the key value of the element at the location following key in the array. If key is a null string (""), then ',(0,s.jsx)(t.strong,{children:"Next"})," returns the key value for the first element in the array."]}),"\n",(0,s.jsx)(t.h3,{id:"previous",children:"Previous"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method Previous(key As %String = "") As %String [ CodeMode = expression, Final ]\n'})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the key value of the element at the location preceding key in the array. If key is a null string (""), then Next returns the key value for the last element in the array.'}),"\n",(0,s.jsx)(t.h3,{id:"buildvaluearray",children:"BuildValueArray"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod BuildValueArray(serialized As %Binary, array As %Binary) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Constructs array(key)=value for each element in the serialval value."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"clear",children:"Clear"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Clear() As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Clears the contents of the array. Both the OID and OREF values are cleared."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"find",children:"Find"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method Find(element As %ObjectIdentity, key As %String) As %String [ CodeMode = generator ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Starting from, but not including, location key, finds the next element in the array whose OID value equals element."}),"\n",(0,s.jsx)(t.p,{children:'If key is a null string (""), the search starts at the beginning of the array.'}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Find"}),' returns the key associated with the found element or null string ("") if no element is found.']}),"\n",(0,s.jsx)(t.h3,{id:"findobjectid",children:"FindObjectId"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method FindObjectId(id As %String, key As %Integer) As %String\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Starting from, but not including, position key, ",(0,s.jsx)(t.strong,{children:"FindObjectId"})," finds the next element in the list whose ObjectId equals id. If key is a null string, ",(0,s.jsx)(t.strong,{children:"Find"})," starts at the beginning of the list."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Find"}),' returns the position of the found element or null string ("") if no element was found.']}),"\n",(0,s.jsx)(t.h3,{id:"getat",children:"GetAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetAt(key As %String) As %RegisteredObject\n"})}),"\n",(0,s.jsx)(t.p,{children:"Finds and returns the OREF value of the element associated with key."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"GetAt"}),' returns the OREF value of the element associated with key or null string ("") if no element is found.']}),"\n",(0,s.jsx)(t.h3,{id:"getobjectat",children:"GetObjectAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectAt(key As %String, force As %Integer = 0) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:"Finds and returns the OID value of the element associated with key."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"GetObjectAt"}),' returns the OID value of the element associated with key or null string ("") if no element is found.']}),"\n",(0,s.jsx)(t.h3,{id:"getobjectidat",children:"GetObjectIdAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectIdAt(key As %String, force As %Integer = 0) As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Finds and returns the ID value of the element associated with key."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"GetObjectIdAt"}),' returns the ID value of the element associated with key or null string ("") if no element is found.']}),"\n",(0,s.jsx)(t.h3,{id:"getnext",children:"GetNext"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetNext(ByRef key As %String) As %RegisteredObject\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OREF value of the element at the location after key in the array. If key is a null string (""), it returns the OREF value of the first element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the end of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectnext",children:"GetObjectNext"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectNext(ByRef key As %String) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OID value of the element at the location after key in the array. If key is a null string (""), it returns the OID value of the first element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the end of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectidnext",children:"GetObjectIdNext"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectIdNext(ByRef key As %String) As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the ID value of the element at the location after key in the array. If key is a null string (""), it returns the ID value of the first element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the end of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"getprevious",children:"GetPrevious"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetPrevious(ByRef key As %String) As %RegisteredObject\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OREF value of the element at the location before key in the array. If key is a null string (""), it returns the OREF value of the last element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the beginning of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectprevious",children:"GetObjectPrevious"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectPrevious(ByRef key As %String) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the OID value of the element at the location before key in the array. If key is a null string (""), it returns the OID value of the last element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the beginning of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"getobjectidprevious",children:"GetObjectIdPrevious"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetObjectIdPrevious(ByRef key As %String) As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:'Finds and returns the ID value of the element at the location before key in the array. If key is a null string (""), it returns the ID value of the last element in the array.'}),"\n",(0,s.jsx)(t.p,{children:'The value of key, which is passed by reference, is updated to the key value of the returned element or null string ("") if key is at the beginning of the array.'}),"\n",(0,s.jsx)(t.h3,{id:"removeat",children:"RemoveAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method RemoveAt(key As %String, Output success As %Boolean) As %ObjectIdentity\n"})}),"\n",(0,s.jsx)(t.p,{children:"Removes the element associated with key in the array."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"RemoveAt"}),' returns the OID value of the removed element or null string ("") if no element was removed. It also has a success output argument that returns true if the item was removed and false if it was not.']}),"\n",(0,s.jsx)(t.h3,{id:"setat",children:"SetAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SetAt(oref As %RegisteredObject, key As %String) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Sets the OREF value of the element associated with key to element."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"setobjectat",children:"SetObjectAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SetObjectAt(oid As %ObjectIdentity, key As %String) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Sets the OID value of the element associated with key to element."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"setobjectidat",children:"SetObjectIdAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SetObjectIdAt(id As %String, key As %String) As %Status [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Sets the ID value of the element associated with key to element."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"addtosaveset",children:"%AddToSaveSet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %AddToSaveSet(force As %Integer = 0, refresh As %Integer = 0) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"Overrides %SerialObject implementation. Scans objects for modifications in the related list (Element) and the terminated relationship list (DeleteOref). Modified/Scheduled to delete objects are added to the save graph."}),"\n",(0,s.jsx)(t.h3,{id:"serializeobject",children:"%SerializeObject"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %SerializeObject(ByRef serial As %Binary, partial As %Integer = 0) As %Status\n"})}),"\n",(0,s.jsx)(t.h3,{id:"unswizzleat",children:"%UnSwizzleAt"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %UnSwizzleAt(key As %String, force As %Integer = 0) As %Status [ ProcedureBlock = 1 ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Unswizzles (removes from memory) the element associated with key in the array."}),"\n",(0,s.jsx)(t.p,{children:"Returns a %Status value indicating success or failure."}),"\n",(0,s.jsx)(t.h3,{id:"getserial",children:"%GetSerial"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %GetSerial(force As %Integer = 0) As %String [ CodeMode = generator, Private ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"setserial",children:"%SetSerial"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %SetSerial(serialized As %String) As %Status [ Private ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"onconstructclone",children:"%OnConstructClone"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %OnConstructClone(oref As %RegisteredObject, deep As %Boolean = 0, ByRef cloned As %String) As %Status [ Private, ProcedureBlock = 1 ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"onnew",children:"%OnNew"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %OnNew(initvalue As %String) As %Status [ Private ]\n"})})]})}function d(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>l});var s=n(96540);const r={},i=s.createContext(r);function a(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);