"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[36603],{83821:(e,s,n)=>{n.r(s),n.d(s,{contentTitle:()=>i,default:()=>d,frontMatter:()=>c,toc:()=>a});var r=n(74848),t=n(28453);const c={pagination_prev:null,pagination_next:null},i="%SYSTEM.CodeScanner",a=[{value:"Parameters",id:"parameters",level:2},{value:"DOMAIN",id:"domain",level:3},{value:"Methods",id:"methods",level:2},{value:"AddRow",id:"addrow",level:3},{value:"ReportClassDeprecated",id:"reportclassdeprecated",level:3},{value:"NormalizeClassAndReport",id:"normalizeclassandreport",level:3},{value:"CheckLine",id:"checkline",level:3},{value:"SetUpZuFns",id:"setupzufns",level:3},{value:"ScanDocumentsExecute",id:"scandocumentsexecute",level:3},{value:"ScanDocumentsClose",id:"scandocumentsclose",level:3},{value:"ScanDocumentsFetch",id:"scandocumentsfetch",level:3},{value:"SetupPatterns",id:"setuppatterns",level:3},{value:"ScanAll",id:"scanall",level:3},{value:"Scan",id:"scan",level:3},{value:"searchItem",id:"searchitem",level:3},{value:"searchClassNode",id:"searchclassnode",level:3}];function l(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"systemcodescanner",children:"%SYSTEM.CodeScanner"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"Class %SYSTEM.CodeScanner Extends %SYSTEM.Help\n"})}),"\n",(0,r.jsx)(s.p,{children:"Used to scan user code looking for references to deprecated functionality."}),"\n",(0,r.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(s.h3,{id:"domain",children:"DOMAIN"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter DOMAIN = "%Utility";\n'})}),"\n",(0,r.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(s.h3,{id:"addrow",children:"AddRow"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod AddRow(idx As %Integer, doc As %String, location As %String, message As %String) [ Internal, Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Create a row in the PPG."}),"\n",(0,r.jsx)(s.h3,{id:"reportclassdeprecated",children:"ReportClassDeprecated"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ReportClassDeprecated(idx As %Integer, doc As %String, location As %String, cls As %String) [ Internal, Private ]\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Create a row that reports ",(0,r.jsx)(s.code,{children:"cls"})," as deprecated."]}),"\n",(0,r.jsx)(s.h3,{id:"normalizeclassandreport",children:"NormalizeClassAndReport"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod NormalizeClassAndReport(idx As %Integer, doc As %String, location As %String, cls As %String, ByRef imports) As %String [ Internal, Private ]\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Normalize ",(0,r.jsx)(s.code,{children:"cls"})," using ",(0,r.jsx)(s.code,{children:"imports"})," and create a row if it's deprecated. Create a row with the error text if the normalization fails. Returns the normalized class name, or the empty string if normalization failed."]}),"\n",(0,r.jsx)(s.h3,{id:"checkline",children:"CheckLine"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CheckLine(idx As %Integer, line As %String, doc As %String, docType As %Integer, location As %String, ByRef imports, ByRef zuFns, ByRef vars) [ Internal, Private ]\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Search ",(0,r.jsx)(s.code,{children:"line"})," of ObjectScript for references to deprecated functions."]}),"\n",(0,r.jsx)(s.h3,{id:"setupzufns",children:"SetUpZuFns"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SetUpZuFns(Output zuFns As %String) [ Internal, Private ]\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Output a subscripted array of deprecated ",(0,r.jsx)(s.code,{children:"$ZUTIL"})," functions and their replacements. Functions taken from ",(0,r.jsx)(s.a,{href:"https://github.com/intersystems/language-server/blob/42eb61fe90f9260dcdb08b87f28edbc7af3ecf77/server/src/utils/variables.ts#L64",children:"InterSystems Language Server"})," VS Code extension."]}),"\n",(0,r.jsx)(s.h3,{id:"scandocumentsexecute",children:"ScanDocumentsExecute"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ScanDocumentsExecute(ByRef qHandle As %Binary, mapped As %Boolean = 0) As %Status [ Internal ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Scan user-defined classes and routines in this namespace for references to classes and system functions that have been deprecated or should be replaced."}),"\n",(0,r.jsxs)(s.p,{children:["ObjectScript code in the routine body, Property ",(0,r.jsx)(s.code,{children:"SqlComputeCode"}),", and Method and Trigger implementations with ",(0,r.jsx)(s.code,{children:"Language = objectscript"})," is scanned. Classes defined with the ",(0,r.jsx)(s.code,{children:"Deprecated"})," keyword will not be scanned. The ",(0,r.jsx)(s.strong,{children:"mapped"})," argument controls whether documents mapped from a non-default database are scanned. By default, only documents in the default database will be scanned."]}),"\n",(0,r.jsx)(s.p,{children:"The query returns:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Document"})," - The name of the document, including the file extension."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Location"})," - A line number or class keyword describing where the deprecated reference is located in ",(0,r.jsx)(s.strong,{children:"Document"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Message"})," - A string describing the deprecated reference at ",(0,r.jsx)(s.strong,{children:"Location"})," in ",(0,r.jsx)(s.strong,{children:"Document"}),".\nA row will be returned if the following code structures are encountered:"]}),"\n",(0,r.jsxs)(s.li,{children:["A class defined with the ",(0,r.jsx)(s.code,{children:"Deprecated"})," keyword that is:\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Referenced in ObjectScript code using ",(0,r.jsx)(s.code,{children:"##class()"})," or ",(0,r.jsx)(s.code,{children:"$SYSTEM.class.method()"})," syntax."]}),"\n",(0,r.jsxs)(s.li,{children:["In the superclass, ",(0,r.jsx)(s.code,{children:"CompileAfter"}),", ",(0,r.jsx)(s.code,{children:"DependsOn"}),", or ",(0,r.jsx)(s.code,{children:"PropertyClass"})," list of a class definition."]}),"\n",(0,r.jsx)(s.li,{children:"Defined as the type of an argument in a Method or class Query's argument list."}),"\n",(0,r.jsx)(s.li,{children:"Defined as the return type of a Method."}),"\n",(0,r.jsx)(s.li,{children:"Defined as the type of a Property or class Query."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["A Method defined with the ",(0,r.jsx)(s.code,{children:"Deprecated"})," keyword that is referenced using:\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"##class().method()"})," syntax."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"$SYSTEM.class.method()"})," syntax."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"variable.method()"})," syntax, where ",(0,r.jsx)(s.code,{children:"variable"})," is a method argument defined with a type or a local variable with a type declared using ",(0,r.jsx)(s.code,{children:"#Dim"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"$THIS.method()"})," syntax, when in a class definition."]}),"\n",(0,r.jsxs)(s.li,{children:["Relative dot (",(0,r.jsx)(s.code,{children:"..method()"}),") syntax, when in a class definition."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["A Property defined with the ",(0,r.jsx)(s.code,{children:"Deprecated"})," keyword that is referenced using:\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"variable.property"})," syntax, where ",(0,r.jsx)(s.code,{children:"variable"})," is a method argument defined with a type or a local variable with a type declared using ",(0,r.jsx)(s.code,{children:"#Dim"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"$THIS.property"})," syntax, when in a class definition."]}),"\n",(0,r.jsxs)(s.li,{children:["Instance variable (",(0,r.jsx)(s.code,{children:"i%property"}),") syntax, when in a class definition."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["A Parameter defined with the ",(0,r.jsx)(s.code,{children:"Deprecated"})," keyword that is referenced using:\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"##class().#parameter"})," syntax."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"variable.#parameter"})," syntax, where ",(0,r.jsx)(s.code,{children:"variable"})," is a method argument defined with a type or a local variable with a type declared using ",(0,r.jsx)(s.code,{children:"#Dim"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"$THIS.#parameter"})," syntax, when in a class definition."]}),"\n",(0,r.jsxs)(s.li,{children:["Relative dot (",(0,r.jsx)(s.code,{children:"..#parameter"}),") syntax, when in a class definition."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["A ",(0,r.jsx)(s.code,{children:"$ZUTIL"})," function listed in the ",(0,r.jsx)(s.a,{href:"https://docs.intersystems.com/latest/csp/docbook/DocBook.UI.Page.cls?KEY=RCOS%5Freplacements",children:"$ZUTIL Replacements documentation"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["A ",(0,r.jsx)(s.code,{children:"$ZOBJ"})," function that has been ",(0,r.jsx)(s.a,{href:"https://docs.intersystems.com/latest/csp/docbook/DocBook.UI.Page.cls?KEY=GCRN%5F20101#GCRN%5Fupgrade20101%5Fzobj",children:"replaced with a standard system function"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["The ",(0,r.jsx)(s.a,{href:"https://docs.intersystems.com/irislatest/csp/docbook/DocBook.UI.Page.cls?KEY=RCOS%5Fmacros%5Fmpp%5FlbSQLCompile%5FMode",children:"#sqlcompile mode"})," macro preprocessor directive."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"$ZF(-1)"})," or ",(0,r.jsx)(s.code,{children:"$ZF(-2)"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Class keyword ",(0,r.jsx)(s.code,{children:"LegacyInstanceContext"})," or a reference to the obsolete ",(0,r.jsx)(s.code,{children:"%this"})," variable."]}),"\n",(0,r.jsxs)(s.li,{children:["Property keyword ",(0,r.jsx)(s.code,{children:"SqlListDelimiter"})," or ",(0,r.jsx)(s.code,{children:"SqlListType"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["A Method or Trigger with keyword ",(0,r.jsx)(s.code,{children:"CodeMode"})," set to 'generator'."]}),"\n",(0,r.jsx)(s.li,{children:"A system function that is not supported in user code."}),"\n",(0,r.jsx)(s.li,{children:"A short class name that did not match a class in any of the imported packages."}),"\n",(0,r.jsx)(s.li,{children:"A short class name that matched classes in multiple imported packages and therefore was ambiguous."}),"\n",(0,r.jsx)(s.li,{children:"A Method or class Query argument list that is formatted incorrectly."}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"scandocumentsclose",children:"ScanDocumentsClose"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ScanDocumentsClose(qHandle As %Binary) As %Status [ Internal ]\n"})}),"\n",(0,r.jsx)(s.h3,{id:"scandocumentsfetch",children:"ScanDocumentsFetch"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ScanDocumentsFetch(ByRef qHandle As %Binary, ByRef Row As %List, ByRef AtEnd As %Integer = 0) As %Status [ Internal ]\n"})}),"\n",(0,r.jsx)(s.h3,{id:"setuppatterns",children:"SetupPatterns"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SetupPatterns(ByRef patterns As %String, ByRef info As %String) [ Internal, Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Define the list of things to scan for. The format is:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"patterns(num)=pattern"}),"\n",(0,r.jsx)(s.li,{children:'patterns(num,"case")=case sensitive'}),"\n",(0,r.jsx)(s.li,{children:'patterns(num,"version")=version customer will see the problem in'}),"\n",(0,r.jsx)(s.li,{children:'patterns(num,"info")=description of the problem'}),"\n",(0,r.jsx)(s.li,{children:'patterns(num,"whole")=whole word pattern match'}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"scanall",children:"ScanAll"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod ScanAll(SearchList As %String = "*.*") [ Deprecated ]\n'})}),"\n",(0,r.jsxs)(s.p,{children:["This method is ",(0,r.jsx)(s.strong,{children:"deprecated"}),". Use the ScanDocuments class Query instead."]}),"\n",(0,r.jsx)(s.p,{children:"Scan all namespaces on this system looking for code that may not work correctly due to use of unsupported features. You can pass an options SearchList argument which is a mask of which documents to search for."}),"\n",(0,r.jsx)(s.h3,{id:"scan",children:"Scan"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod Scan(SearchList As %String = "*.*") [ Deprecated ]\n'})}),"\n",(0,r.jsxs)(s.p,{children:["This method is ",(0,r.jsx)(s.strong,{children:"deprecated"}),". Use the ScanDocuments class Query instead."]}),"\n",(0,r.jsx)(s.p,{children:"Scan this namespace looking for code that may not work correctly due to use of unsupported features. You can pass an options SearchList argument which is a mask of which documents to search for."}),"\n",(0,r.jsx)(s.h3,{id:"searchitem",children:"searchItem"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod searchItem(pattern As %String, Name As %String, ByRef Found As %Integer = 0, wild As %Boolean = 0, CaseSensitive As %Boolean = 1, Max As %Integer = 200, Pattern As %String, WholeWords As %Boolean = 0) As %Boolean [ Internal, Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Search this specific items for the string"}),"\n",(0,r.jsx)(s.h3,{id:"searchclassnode",children:"searchClassNode"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod searchClassNode(Name As %String, ref As %String, type As %String, NewName As %String, pattern As %String, ByRef Found As %Integer, Tree As %String, CaseSensitive As %Boolean = 1, Max As %Integer = 200, Wild As %Boolean = 0) [ Internal, Private ]\n"})}),"\n",(0,r.jsx)(s.p,{children:"Search this class for the string"})]})}function d(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>a});var r=n(96540);const t={},c=r.createContext(t);function i(e){const s=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(c.Provider,{value:s},e.children)}}}]);