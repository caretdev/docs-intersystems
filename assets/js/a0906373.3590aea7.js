"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[20664],{59874:(e,t,r)=>{r.r(t),r.d(t,{contentTitle:()=>i,default:()=>d,frontMatter:()=>a,toc:()=>o});var n=r(74848),s=r(28453);const a={pagination_prev:null,pagination_next:null},i="%JSON.Adaptor",o=[{value:"Parameters",id:"parameters",level:2},{value:"%JSONENABLED",id:"jsonenabled",level:3},{value:"%JSONIGNOREINVALIDFIELD",id:"jsonignoreinvalidfield",level:3},{value:"%JSONNULL",id:"jsonnull",level:3},{value:"%JSONIGNORENULL",id:"jsonignorenull",level:3},{value:"%JSONREFERENCE",id:"jsonreference",level:3},{value:"Methods",id:"methods",level:2},{value:"%JSONImport",id:"jsonimport",level:3},{value:"%JSONNew",id:"jsonnew",level:3},{value:"%JSONExport",id:"jsonexport",level:3},{value:"%JSONExportToStream",id:"jsonexporttostream",level:3},{value:"%JSONExportToString",id:"jsonexporttostring",level:3},{value:"%JSONX",id:"jsonx",level:3},{value:"%JSONGenerate",id:"jsongenerate",level:3},{value:"%JSONImportInternal",id:"jsonimportinternal",level:3},{value:"%JSONExportInternal",id:"jsonexportinternal",level:3},{value:"%JSONExportToStringInternal",id:"jsonexporttostringinternal",level:3}];function l(e){const t={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"jsonadaptor",children:"%JSON.Adaptor"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Class %JSON.Adaptor [ Abstract, PropertyClass = %JSON.PropertyParameters, System = 3 ]\n"})}),"\n",(0,n.jsx)(t.p,{children:"The following table displays the correspondence between JSON field values and property values that will be implemented by the JSON Adaptor."}),"\n",(0,n.jsx)(t.p,{children:"The actual conversion between registered object values and JSON values will be done by new datatype methods: JSONToLogical and LogicalToJSON. In addition, a new JSONTYPE parameter will be introduced for the datatype classes which indicates how the data type will be mapped to JSON."}),"\n",(0,n.jsx)(t.p,{children:"JSON                                            Registered object type object                                          class referenced by property array - error if all values are not literals    %ListOfDatatypes array - error if all values are not objects     %ListOfObjects or relationship array - error if all values are not literals    %List string                                          %String, %Char, %Name, %FileCharacterStream, %GlobalCharacterStream string - must be base64 encoded                 %Binary, %FileBinaryStream, %GlobalBinaryStream string - ODBC format date                       %Date string - ODBC format time                       %Time string - ODBC format date/time                  %DateTime, %TimeStamp numeric - bounds must match object type         %BigInt, %Currency, %Decimal, %Double, %Float, %Integer, %Numeric, %SmallInt, %TinyInt boolean                                         %Boolean"}),"\n",(0,n.jsx)(t.p,{children:"Note that the types %xsd package are all subclasses of base % datatypes and will map as the super type."}),"\n",(0,n.jsx)(t.h2,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsx)(t.h3,{id:"jsonenabled",children:"%JSONENABLED"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Parameter %JSONENABLED = 1;\n"})}),"\n",(0,n.jsx)(t.p,{children:"If this parameter is true then JSON-enabling methods will be generated. Otherwise, the method generators do not produce a runnable method."}),"\n",(0,n.jsx)(t.h3,{id:"jsonignoreinvalidfield",children:"%JSONIGNOREINVALIDFIELD"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Parameter %JSONIGNOREINVALIDFIELD As BOOLEAN = 0;\n"})}),"\n",(0,n.jsx)(t.p,{children:"The %JSONIGNOREINVALIDFIELD parameter allows the programmer to control handling of unexpected fields in the JSON input. The default (%JSONIGNOREINVALIDFIELD = 0) will treat an unexpected field as an error. If %JSONIGNOREINVALIDFIELD is set = 1, then unexpected fields will be ignored."}),"\n",(0,n.jsx)(t.h3,{id:"jsonnull",children:"%JSONNULL"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Parameter %JSONNULL As BOOLEAN = 0;\n"})}),"\n",(0,n.jsx)(t.p,{children:"If %JSONNULL is true (=1), then unspecified properties are exported as the null value. Otherwise the field corresponding to the property is just skipped during export. The corresponding property parameter overrides this parameter if specified."}),"\n",(0,n.jsx)(t.h3,{id:"jsonignorenull",children:"%JSONIGNORENULL"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Parameter %JSONIGNORENULL As BOOLEAN = 0;\n"})}),"\n",(0,n.jsxs)(t.p,{children:['%JSONIGNORENULL allows the programmer to override the default handling of empty strings for string properties. This paramneter applies to only true strings which is determined by XSDTYPE = "string" as well as JSONTYPE="string" By default (%JSONIGNORENULL = 0), empty strings in the JSON input are stored as $c(0) and $c(0) is written to JSON as the string "". A missing field in the JSON input is always stored as "" and "" is always output to JSON according to the %JSONNULL parameter.',(0,n.jsx)(t.br,{}),'\nIf %JSONIGNORENULL is set = 1, then both missing fields in the JSON and empty strings are input as "", and both "" and $c(0) are output as field values of "". The corresponding property parameter overrides this parameter if specified.']}),"\n",(0,n.jsx)(t.h3,{id:"jsonreference",children:"%JSONREFERENCE"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Parameter %JSONREFERENCE As STRING [ Constraint = "OBJECT,ID,OID,GUID", Flags = ENUM ] = "OBJECT";\n'})}),"\n",(0,n.jsxs)(t.p,{children:['%JSONREFERENCE specifies the default value of the %JSONREFERENCE property parameter that specifies how to project references to JSON. %JSONREFERENCE may be specified for any property to override this default value. Possible values of %JSONREFERENCE are "OBJECT", "ID", "OID", "GUID".',(0,n.jsx)(t.br,{}),'\n="OBJECT" is the default and indicates that the properties of the referenced class are used to represent the referenced object.',(0,n.jsx)(t.br,{}),'\n="ID" indicates that the id of a persistent or serial class is used to represent the reference.',(0,n.jsx)(t.br,{}),'\n="OID" indicates that the oid of a persistent or serial class is used to represent the reference. The form of the oid as projected to JSON will be classname,id.',(0,n.jsx)(t.br,{}),'\n="GUID" indicates the GUID of a persistent class is used to represent the reference.',(0,n.jsx)(t.br,{}),"\nThe corresponding property parameter overrides this parameter if specified."]}),"\n",(0,n.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(t.h3,{id:"jsonimport",children:"%JSONImport"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method %JSONImport(input, %mappingName As %String = "") As %Status [ ServerOnly = 1 ]\n'})}),"\n",(0,n.jsxs)(t.p,{children:["%JSONImport imports JSON or dynamic object input into this object.",(0,n.jsx)(t.br,{}),"\nThe input argument is either JSON as a string or stream, or a subclass of %DynamicAbstractObject.",(0,n.jsx)(t.br,{}),'\nmappingName is the name of the mapping to use for the import. The base mapping is represented by "" and is the default.']}),"\n",(0,n.jsx)(t.h3,{id:"jsonnew",children:"%JSONNew"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'ClassMethod %JSONNew(dynamicObject As %DynamicObject, containerOref As %RegisteredObject = "") As %RegisteredObject [ CodeMode = generator, GenerateAfter = %JSONGenerate, ServerOnly = 1 ]\n'})}),"\n",(0,n.jsx)(t.p,{children:"Get an instance of an JSON enabled class."}),"\n",(0,n.jsxs)(t.p,{children:["You may override this method to do custom processing (such as initializing the object instance) before returning an instance of this class. However, this method should not be called directly from user code.",(0,n.jsx)(t.br,{}),"\nArguments:",(0,n.jsx)(t.br,{}),"\ndynamicObject is the dynamic object with thee values to be assigned to the new object.",(0,n.jsx)(t.br,{}),"\ncontainerOref is the containing object instance when called from JSONImport."]}),"\n",(0,n.jsx)(t.h3,{id:"jsonexport",children:"%JSONExport"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method %JSONExport(%mappingName As %String = "") As %Status\n'})}),"\n",(0,n.jsxs)(t.p,{children:["Serialize a JSON enabled class as a JSON document and write it to the current device.",(0,n.jsx)(t.br,{}),'\nmappingName is the name of the mapping to use for the export. The base mapping is represented by "" and is the default.']}),"\n",(0,n.jsx)(t.h3,{id:"jsonexporttostream",children:"%JSONExportToStream"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method %JSONExportToStream(ByRef export As %Stream.Object, %mappingName As %String = "") As %Status\n'})}),"\n",(0,n.jsxs)(t.p,{children:["Serialize a JSON enabled class as a JSON document and write it to a stream.",(0,n.jsx)(t.br,{}),'\nmappingName is the name of the mapping to use for the export. The base mapping is represented by "" and is the default.']}),"\n",(0,n.jsx)(t.h3,{id:"jsonexporttostring",children:"%JSONExportToString"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Method %JSONExportToString(ByRef %export As %String, %mappingName As %String = "") As %Status\n'})}),"\n",(0,n.jsxs)(t.p,{children:["Serialize a JSON enabled class as a JSON document and return it as a string.",(0,n.jsx)(t.br,{}),'\nmappingName is the name of the mapping to use for the export. The base mapping is represented by "" and is the default.']}),"\n",(0,n.jsx)(t.h3,{id:"jsonx",children:"%JSONX"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method %JSONX() [ Abstract, Internal, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(t.p,{children:"Dummy method which exists to force GenerateAfter code to take affect for %JSONGenerate. The GenerateAfter will not have affect unless the after method is laterin collating sequence. All this is necessary to force geenrator methods to be run after member methods are created. This method is for internal use only. You should not make direct use of it within your applications. There is no guarantee made about either the behavior or future operation of this method."}),"\n",(0,n.jsx)(t.h3,{id:"jsongenerate",children:"%JSONGenerate"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod %JSONGenerate() [ CodeMode = generator, GenerateAfter = %JSONX, Internal, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(t.p,{children:"%JSONGenerate is an internal method that controls the generation of the other methods in %JSON.Adaptor. If %JSONGenerate is overridden, then JSON meta data and the other generator methods of %JSON.Adaptor will not be created."}),"\n",(0,n.jsx)(t.h3,{id:"jsonimportinternal",children:"%JSONImportInternal"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method %JSONImportInternal() As %Status [ CodeMode = generator, GenerateAfter = %JSONGenerate, Internal, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(t.p,{children:"%JSONImportInternal is internal method used by %JSONImport"}),"\n",(0,n.jsx)(t.h3,{id:"jsonexportinternal",children:"%JSONExportInternal"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method %JSONExportInternal() As %Status [ CodeMode = generator, GenerateAfter = %JSONGenerate, Internal, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(t.p,{children:"%JSONExportInternal is internal method used by %JSONExport"}),"\n",(0,n.jsx)(t.h3,{id:"jsonexporttostringinternal",children:"%JSONExportToStringInternal"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method %JSONExportToStringInternal() As %Status [ CodeMode = generator, GenerateAfter = %JSONGenerate, Internal, ServerOnly = 1 ]\n"})}),"\n",(0,n.jsx)(t.p,{children:"%JSONExportToStringInternal is internal method used by %JSONExport"})]})}function d(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>o});var n=r(96540);const s={},a=n.createContext(s);function i(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);