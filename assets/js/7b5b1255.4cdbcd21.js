"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[87046],{67045:(e,t,l)=>{l.r(t),l.d(t,{contentTitle:()=>i,default:()=>r,frontMatter:()=>n,toc:()=>d});var a=l(74848),s=l(28453);const n={pagination_prev:null,pagination_next:null},i="%SYS.PTools.FileCreation",d=[{value:"Methods",id:"methods",level:2},{value:"createOrderByList",id:"createorderbylist",level:3},{value:"condsMatch",id:"condsmatch",level:3},{value:"createAndOpenFile",id:"createandopenfile",level:3},{value:"openFileForRead",id:"openfileforread",level:3},{value:"getOutputFile",id:"getoutputfile",level:3},{value:"fileHeader",id:"fileheader",level:3},{value:"fileBody",id:"filebody",level:3},{value:"fileFooter",id:"filefooter",level:3},{value:"TXTtabHead",id:"txttabhead",level:3},{value:"TXTtabRow",id:"txttabrow",level:3},{value:"CSVtabHead",id:"csvtabhead",level:3},{value:"CSVtabRow",id:"csvtabrow",level:3},{value:"DLMtabHead",id:"dlmtabhead",level:3},{value:"DLMtabRow",id:"dlmtabrow",level:3},{value:"XMLsheet",id:"xmlsheet",level:3},{value:"XMLtable",id:"xmltable",level:3},{value:"XMLrowHeader",id:"xmlrowheader",level:3},{value:"XMLtabRow",id:"xmltabrow",level:3},{value:"XMLcolWidth",id:"xmlcolwidth",level:3},{value:"XMLcolAuto",id:"xmlcolauto",level:3},{value:"XMLsort",id:"xmlsort",level:3},{value:"HTMLtabHead",id:"htmltabhead",level:3},{value:"HTMLtabRow",id:"htmltabrow",level:3}];function o(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"sysptoolsfilecreation",children:"%SYS.PTools.FileCreation"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Class %SYS.PTools.FileCreation [ Abstract, System = 4 ]\n"})}),"\n",(0,a.jsx)(t.p,{children:'This class is a place to create File Creation & Formatting methods used by the PTools Application Package, which was designed to gather performance statistics for any type of Routine, Code Block or SQL Statement. The following methods are written to be used within Class Definitions, and the equivalent methods within the %SYS.PTools.FileCreation.INC file are written to be used within MAC Routines and are written as pure COS methods. The file formatted that these methods support are driven by the \'format\' parameter and support the following formats: format - The output format of the Export/Reporting file This parameter has the following structure of constituent elements: format=[:$LB(,,)] Where the constituent elements have the following values:  - The format of the Export/Reporting file: - P = Printable/Viewable report file (.txt file, no pagination) - D = Comma-delimited data file (.csv file) which can be read into a spreadsheet - X = Microsoft Excel XML markup file suitable for import into Excel (.xml file) - H = HTML page file (.html file) - Z = User-defined delimiter "P" formatted file (.dlm file) NOTE: The  element is required or defaulted to $C(9) (TAB) Optional Elements:  - User-defined delimiter [DEFAULT: $C(9) (TAB)] NOTE: This is generally used for ="Z"  - .csv file header for ="D": - 0 = Don\'t add non-standard information header to file [DEFAULT] - 1 = Add non-standard information header to file  - .csv file footer for ="D": - 0 = Don\'t add non-standard information footer to file [DEFAULT] - 1 = Add non-standard information footer to file EXAMPLES: Valid \'format\' values: - "H" // HTML file - "D" // CSV file with No information header or footer - "D:"_$LB(,1,1) // CSV file with information header & footer - "Z:"_$LB("^") // User-defined delimiter file (delim="^") This class is Super-Class, and is used as part of the EXTENDS directive for the following classes: - %SYS.PTools.SQLQuery - %SYS.PTools.Stats - %SYS.PTools.StatsSQL - %SYS.PTools.SQLStats'}),"\n",(0,a.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,a.jsx)(t.h3,{id:"createorderbylist",children:"createOrderByList"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:'ClassMethod createOrderByList(orderBy = "", d) As %String\n'})}),"\n",(0,a.jsx)(t.p,{children:"Create a valid SQL"}),"\n",(0,a.jsx)(t.h3,{id:"condsmatch",children:"condsMatch"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:'ClassMethod condsMatch(conds, d, condValExp = "") As %Status [ PublicList = (conds, condValExp, d) ]\n'})}),"\n",(0,a.jsx)(t.p,{children:"Check Conditional Matches"}),"\n",(0,a.jsx)(t.h3,{id:"createandopenfile",children:"createAndOpenFile"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod createAndOpenFile(file, timeout = {$$$PTSOpenTimeout}) As %Status\n"})}),"\n",(0,a.jsx)(t.p,{children:"Create & Open File"}),"\n",(0,a.jsx)(t.h3,{id:"openfileforread",children:"openFileForRead"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod openFileForRead(file, timeout = {$$$PTSOpenTimeout}) As %Status\n"})}),"\n",(0,a.jsx)(t.p,{children:"Open File For Read"}),"\n",(0,a.jsx)(t.h3,{id:"getoutputfile",children:"getOutputFile"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:'ClassMethod getOutputFile(file = "", className = "", methodName = "", format = "", hDate = "", tSC = {$$$OK}) As %String\n'})}),"\n",(0,a.jsx)(t.p,{children:"Get the 'outputFile'"}),"\n",(0,a.jsx)(t.h3,{id:"fileheader",children:"fileHeader"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:'ClassMethod fileHeader(file, format, title = "", class, method, version, metadata, bcFlag = "") As %Status\n'})}),"\n",(0,a.jsx)(t.p,{children:"File Header"}),"\n",(0,a.jsx)(t.h3,{id:"filebody",children:"fileBody"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod fileBody(file, format, metadata)\n"})}),"\n",(0,a.jsx)(t.p,{children:"File Body"}),"\n",(0,a.jsx)(t.h3,{id:"filefooter",children:"fileFooter"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod fileFooter(file, format, footerMsg, metadata, elapseTime, rowCnt) As %Status\n"})}),"\n",(0,a.jsx)(t.p,{children:"File Footer"}),"\n",(0,a.jsx)(t.h3,{id:"txttabhead",children:"TXTtabHead"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod TXTtabHead(metadata, delim)\n"})}),"\n",(0,a.jsx)(t.p,{children:"Text Table Header"}),"\n",(0,a.jsx)(t.h3,{id:"txttabrow",children:"TXTtabRow"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod TXTtabRow(metadata, delim)\n"})}),"\n",(0,a.jsx)(t.p,{children:"Text Table Data Row"}),"\n",(0,a.jsx)(t.h3,{id:"csvtabhead",children:"CSVtabHead"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod CSVtabHead(metadata, delim)\n"})}),"\n",(0,a.jsx)(t.p,{children:"CSV Table Header"}),"\n",(0,a.jsx)(t.h3,{id:"csvtabrow",children:"CSVtabRow"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod CSVtabRow(metadata, delim)\n"})}),"\n",(0,a.jsx)(t.p,{children:"CSV Table Data Row"}),"\n",(0,a.jsx)(t.h3,{id:"dlmtabhead",children:"DLMtabHead"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod DLMtabHead(metadata, delim)\n"})}),"\n",(0,a.jsx)(t.p,{children:"DLM Table Header"}),"\n",(0,a.jsx)(t.h3,{id:"dlmtabrow",children:"DLMtabRow"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod DLMtabRow(metadata, delim)\n"})}),"\n",(0,a.jsx)(t.p,{children:"DLM Table Data Row"}),"\n",(0,a.jsx)(t.h3,{id:"xmlsheet",children:"XMLsheet"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod XMLsheet(name)\n"})}),"\n",(0,a.jsx)(t.p,{children:"XML Worksheet Element"}),"\n",(0,a.jsx)(t.h3,{id:"xmltable",children:"XMLtable"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod XMLtable(colCnt = 0, rowCnt = 0)\n"})}),"\n",(0,a.jsx)(t.p,{children:"XML Table Element"}),"\n",(0,a.jsx)(t.h3,{id:"xmlrowheader",children:"XMLrowHeader"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod XMLrowHeader(metadata)\n"})}),"\n",(0,a.jsx)(t.p,{children:"XML Header Row Element"}),"\n",(0,a.jsx)(t.h3,{id:"xmltabrow",children:"XMLtabRow"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod XMLtabRow(metadata)\n"})}),"\n",(0,a.jsx)(t.p,{children:"XML Table Data Row Element"}),"\n",(0,a.jsx)(t.h3,{id:"xmlcolwidth",children:"XMLcolWidth"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod XMLcolWidth(width)\n"})}),"\n",(0,a.jsx)(t.p,{children:"XML Column Width Element"}),"\n",(0,a.jsx)(t.h3,{id:"xmlcolauto",children:"XMLcolAuto"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod XMLcolAuto()\n"})}),"\n",(0,a.jsx)(t.p,{children:"XML Column AutoFit Width Element"}),"\n",(0,a.jsx)(t.h3,{id:"xmlsort",children:"XMLsort"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod XMLsort(sortColList, sortOrderList)\n"})}),"\n",(0,a.jsx)(t.p,{children:"XML Sorting Element"}),"\n",(0,a.jsx)(t.h3,{id:"htmltabhead",children:"HTMLtabHead"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod HTMLtabHead(aTag, title, metadata)\n"})}),"\n",(0,a.jsx)(t.p,{children:"HTML Table Header"}),"\n",(0,a.jsx)(t.h3,{id:"htmltabrow",children:"HTMLtabRow"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod HTMLtabRow(metadata)\n"})}),"\n",(0,a.jsx)(t.p,{children:"HTML Table Row"})]})}function r(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},28453:(e,t,l)=>{l.d(t,{R:()=>i,x:()=>d});var a=l(96540);const s={},n=a.createContext(s);function i(e){const t=a.useContext(n);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(n.Provider,{value:t},e.children)}}}]);