"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[5176],{67637:(e,s,t)=>{t.r(s),t.d(s,{contentTitle:()=>c,default:()=>d,frontMatter:()=>r,toc:()=>o});var n=t(74848),a=t(28453);const r={pagination_prev:null,pagination_next:null},c="%SYS.Task.RunLegacyTask",o=[{value:"Parameters",id:"parameters",level:2},{value:"TaskName",id:"taskname",level:3},{value:"Properties",id:"properties",level:2},{value:"ExecuteCode",id:"executecode",level:3},{value:"Methods",id:"methods",level:2},{value:"OnTask",id:"ontask",level:3},{value:"executeCode",id:"executecode-1",level:3}];function i(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"systaskrunlegacytask",children:"%SYS.Task.RunLegacyTask"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Class %SYS.Task.RunLegacyTask Extends %SYS.Task.Definition [ System = 4 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"This class provides a way for users of previous versions of Task Manager to easily migrate their tasks which were based on 'ExecuteCode'. It is shown as a 'Task type' in the Task Scheduler Wizard so that users may enter their code there."}),"\n",(0,n.jsx)(s.p,{children:"Note that all new user-defined tasks should be created by subclassing %SYS.Task.Definition and editing the OnTask() method. See examples in the [SAMPLES]Sample.Task and Sample.Task* classes."}),"\n",(0,n.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsx)(s.h3,{id:"taskname",children:"TaskName"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter TaskName = "RunLegacyTask";\n'})}),"\n",(0,n.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,n.jsx)(s.h3,{id:"executecode",children:"ExecuteCode"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'Property ExecuteCode As %String(MAXLEN = "");\n'})}),"\n",(0,n.jsx)(s.p,{children:'The value of this property is used as the argument to an XECUTE command when OnTask is run. The user may also set the value of the variable "Status" to a return code if they wish.'}),"\n",(0,n.jsx)(s.p,{children:"Note that this is provided only for backwards compatibility. All new user-defined tasks should be created by subclassing %SYS.Task.Definition and editing the OnTask() method."}),"\n",(0,n.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(s.h3,{id:"ontask",children:"OnTask"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method OnTask() As %Status\n"})}),"\n",(0,n.jsxs)(s.p,{children:["This method is responsible for executing the task.",(0,n.jsx)(s.br,{}),'\nAt the scheduled time, the Task Manager creates an instance of this object, sets any property values using the stored "settings" for the task, and then invokes this method to execute the task.',(0,n.jsx)(s.br,{}),'\nThe user\'s code may set the value of "Status" to return a status code.']}),"\n",(0,n.jsx)(s.h3,{id:"executecode-1",children:"executeCode"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method executeCode(code) [ ProcedureBlock = 0 ]\n"})})]})}function d(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(i,{...e})}):i(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>c,x:()=>o});var n=t(96540);const a={},r=n.createContext(a);function c(e){const s=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);