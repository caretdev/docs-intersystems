"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[62015],{81857:(e,s,r)=>{r.r(s),r.d(s,{contentTitle:()=>a,default:()=>d,frontMatter:()=>l,toc:()=>i});var n=r(74848),c=r(28453);const l={pagination_prev:null,pagination_next:null},a="%SYS.DBSRV",i=[{value:"Properties",id:"properties",level:2},{value:"Auditing",id:"auditing",level:3},{value:"AuditingDML",id:"auditingdml",level:3},{value:"ClientMaxIdleTime",id:"clientmaxidletime",level:3},{value:"ConnectionLimit",id:"connectionlimit",level:3},{value:"Device",id:"device",level:3},{value:"DeviceStack",id:"devicestack",level:3},{value:"Dispatch",id:"dispatch",level:3},{value:"EventClass",id:"eventclass",level:3},{value:"FunctionTimeout",id:"functiontimeout",level:3},{value:"GatewayReentry",id:"gatewayreentry",level:3},{value:"HeaderReadInSQL",id:"headerreadinsql",level:3},{value:"InBufSize",id:"inbufsize",level:3},{value:"LCBmode",id:"lcbmode",level:3},{value:"Logging",id:"logging",level:3},{value:"ObjectCache",id:"objectcache",level:3},{value:"ObjectCacheHead",id:"objectcachehead",level:3},{value:"ObjectCacheSize",id:"objectcachesize",level:3},{value:"ObjectCacheTail",id:"objectcachetail",level:3},{value:"ObjectCacheMaxSize",id:"objectcachemaxsize",level:3},{value:"OutBufSize",id:"outbufsize",level:3},{value:"RedirectionStack",id:"redirectionstack",level:3},{value:"RHash",id:"rhash",level:3},{value:"RolesAdded",id:"rolesadded",level:3},{value:"ServerOptions",id:"serveroptions",level:3},{value:"ServiceType",id:"servicetype",level:3},{value:"SQLCompileContext",id:"sqlcompilecontext",level:3},{value:"UHash",id:"uhash",level:3},{value:"WaterMark1",id:"watermark1",level:3},{value:"WaterMark2",id:"watermark2",level:3},{value:"Methods",id:"methods",level:2},{value:"BuildDispatch",id:"builddispatch",level:3},{value:"SuperConnect",id:"superconnect",level:3},{value:"SetupDevice",id:"setupdevice",level:3},{value:"SetupShmDevice",id:"setupshmdevice",level:3},{value:"InitSHM",id:"initshm",level:3},{value:"SuperError",id:"supererror",level:3},{value:"LCBSuperConnect1",id:"lcbsuperconnect1",level:3},{value:"LCBSuperConnect2",id:"lcbsuperconnect2",level:3},{value:"Logon",id:"logon",level:3},{value:"GetServerProcessCount",id:"getserverprocesscount",level:3},{value:"AuthenticationError",id:"authenticationerror",level:3},{value:"GWExecuteSingle",id:"gwexecutesingle",level:3},{value:"GWDisconnect",id:"gwdisconnect",level:3},{value:"Server",id:"server",level:3},{value:"startSYSIOLoop",id:"startsysioloop",level:3},{value:"XDCall",id:"xdcall",level:3},{value:"Prepare",id:"prepare",level:3},{value:"SPPrepare",id:"spprepare",level:3},{value:"SPFunction",id:"spfunction",level:3},{value:"SPQuery",id:"spquery",level:3},{value:"SPFetch",id:"spfetch",level:3},{value:"SPClose",id:"spclose",level:3},{value:"SPExecute",id:"spexecute",level:3},{value:"SPMoreResults",id:"spmoreresults",level:3},{value:"SPMoreData",id:"spmoredata",level:3},{value:"AuditSP",id:"auditsp",level:3},{value:"StaticCursorExecute",id:"staticcursorexecute",level:3},{value:"ExecuteBatch",id:"executebatch",level:3},{value:"ExecuteBatchError",id:"executebatcherror",level:3},{value:"ReadQueryParameters",id:"readqueryparameters",level:3},{value:"SPReadParameters",id:"spreadparameters",level:3},{value:"SPReadParametersDP",id:"spreadparametersdp",level:3},{value:"SPWriteParameters",id:"spwriteparameters",level:3},{value:"SPWriteParametersDP",id:"spwriteparametersdp",level:3},{value:"SetCompileMode",id:"setcompilemode",level:3},{value:"CacheResultSetFetch",id:"cacheresultsetfetch",level:3},{value:"GatewayIn",id:"gatewayin",level:3},{value:"Transact",id:"transact",level:3},{value:"ResetConnection",id:"resetconnection",level:3},{value:"FlushError",id:"flusherror",level:3},{value:"ProcessExternalInterrupt",id:"processexternalinterrupt",level:3},{value:"RecordError",id:"recorderror",level:3},{value:"IsolationLevel",id:"isolationlevel",level:3},{value:"CloseUp",id:"closeup",level:3},{value:"CloseAllStatements",id:"closeallstatements",level:3},{value:"CreateOref",id:"createoref",level:3},{value:"CloseStatement",id:"closestatement",level:3},{value:"Catalog",id:"catalog",level:3},{value:"JPAQuery",id:"jpaquery",level:3},{value:"ISCProcAll",id:"iscprocall",level:3},{value:"DirectDialect",id:"directdialect",level:3},{value:"DirectParameter",id:"directparameter",level:3},{value:"CacheInfo",id:"cacheinfo",level:3},{value:"GetVersion",id:"getversion",level:3},{value:"setupLogging",id:"setuplogging",level:3},{value:"log",id:"log",level:3},{value:"logappend",id:"logappend",level:3},{value:"dumplog",id:"dumplog",level:3},{value:"dumponelog",id:"dumponelog",level:3},{value:"timings",id:"timings",level:3},{value:"delta",id:"delta",level:3},{value:"median",id:"median",level:3},{value:"purgelog",id:"purgelog",level:3},{value:"sqlcode",id:"sqlcode",level:3}];function t(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"sysdbsrv",children:"%SYS.DBSRV"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Class %SYS.DBSRV Extends %RegisteredObject\n"})}),"\n",(0,n.jsx)(s.p,{children:"IRIS xDBC Server This code used to be in %SYS.DBSRV.mac prior to DPV6458"}),"\n",(0,n.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,n.jsx)(s.h3,{id:"auditing",children:"Auditing"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property Auditing As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Flag which determings if we are performing xDBC query auditing or not"}),"\n",(0,n.jsx)(s.h3,{id:"auditingdml",children:"AuditingDML"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property AuditingDML As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Flag which determings if we are performing xDBC DML auditing or not, relevant to fast insert auditing specifically"}),"\n",(0,n.jsx)(s.h3,{id:"clientmaxidletime",children:"ClientMaxIdleTime"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property ClientMaxIdleTime As %Integer;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Maximum number of seconds this server should be allowed to remain idle for (no message from client)"}),"\n",(0,n.jsx)(s.h3,{id:"connectionlimit",children:"ConnectionLimit"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property ConnectionLimit As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Maximum number of xDBC connection we can allow for this server"}),"\n",(0,n.jsx)(s.h3,{id:"device",children:"Device"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property Device As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"TCP/Shared Memory device for the connection"}),"\n",(0,n.jsx)(s.h3,{id:"devicestack",children:"DeviceStack"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property DeviceStack As %String [ InitialExpression = 0, MultiDimensional ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Memory to hold the Devices pushed/popped on the stack for gateway re-entrancy"}),"\n",(0,n.jsx)(s.h3,{id:"dispatch",children:"Dispatch"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property Dispatch As %Integer [ MultiDimensional ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Array which holds the server functions permitted by this connection"}),"\n",(0,n.jsx)(s.h3,{id:"eventclass",children:"EventClass"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property EventClass As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Name of the class that has transaction callmack methods %OnTranCommit and %OnTranRollback"}),"\n",(0,n.jsx)(s.h3,{id:"functiontimeout",children:"FunctionTimeout"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property FunctionTimeout As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Timeout from the client to be used to place a time limit (in seconds) on a function's execution"}),"\n",(0,n.jsx)(s.h3,{id:"gatewayreentry",children:"GatewayReentry"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property GatewayReentry As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Flag used to tell the server this was called from gatewat Re-Entrancy"}),"\n",(0,n.jsx)(s.h3,{id:"headerreadinsql",children:"HeaderReadInSQL"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property HeaderReadInSQL As %Integer;\n"})}),"\n",(0,n.jsx)(s.p,{children:"This flag is true if the header was read within the generated SQL code"}),"\n",(0,n.jsx)(s.h3,{id:"inbufsize",children:"InBufSize"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property InBufSize As %Integer;\n"})}),"\n",(0,n.jsx)(s.p,{children:"TCP input buffer size"}),"\n",(0,n.jsx)(s.h3,{id:"lcbmode",children:"LCBmode"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property LCBmode As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Flag used to tell the server it has been called from Light C Binding"}),"\n",(0,n.jsx)(s.h3,{id:"logging",children:"Logging"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property Logging As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Flag for if we are performing server logging or not"}),"\n",(0,n.jsx)(s.h3,{id:"objectcache",children:"ObjectCache"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property ObjectCache As %String [ MultiDimensional ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"ObjectCaache holds the orefs for cached cached query objects"}),"\n",(0,n.jsx)(s.h3,{id:"objectcachehead",children:"ObjectCacheHead"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property ObjectCacheHead As %String;\n"})}),"\n",(0,n.jsx)(s.h3,{id:"objectcachesize",children:"ObjectCacheSize"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property ObjectCacheSize As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(s.h3,{id:"objectcachetail",children:"ObjectCacheTail"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property ObjectCacheTail As %String;\n"})}),"\n",(0,n.jsx)(s.h3,{id:"objectcachemaxsize",children:"ObjectCacheMaxSize"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property ObjectCacheMaxSize As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(s.h3,{id:"outbufsize",children:"OutBufSize"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property OutBufSize As %Integer;\n"})}),"\n",(0,n.jsx)(s.p,{children:"TCP Output buffer size"}),"\n",(0,n.jsx)(s.h3,{id:"redirectionstack",children:"RedirectionStack"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property RedirectionStack As %String [ InitialExpression = 0, MultiDimensional ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Array used to keep track of Start/Stop output redirection for each device"}),"\n",(0,n.jsx)(s.h3,{id:"rhash",children:"RHash"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property RHash As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Hash of the login roles for this user"}),"\n",(0,n.jsx)(s.h3,{id:"rolesadded",children:"RolesAdded"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property RolesAdded As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Roles that might have been added by CheckBindingsAccess"}),"\n",(0,n.jsx)(s.h3,{id:"serveroptions",children:"ServerOptions"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property ServerOptions As %Integer [ MultiDimensional ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Options supported for this connection after handshake with client"}),"\n",(0,n.jsx)(s.h3,{id:"servicetype",children:"ServiceType"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property ServiceType As %String [ MultiDimensional ];\n"})}),"\n",(0,n.jsx)(s.p,{children:"Used to determine which types of functions are privileged for this user Multidimentional because I need to set $e on the value."}),"\n",(0,n.jsx)(s.h3,{id:"sqlcompilecontext",children:"SQLCompileContext"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property SQLCompileContext As %SYSTEM.Context.SQLCompile;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Holds the $SYSTEM.Context.SQLCompile settings at the time of connection"}),"\n",(0,n.jsx)(s.h3,{id:"uhash",children:"UHash"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property UHash As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Hash for the username"}),"\n",(0,n.jsx)(s.h3,{id:"watermark1",children:"WaterMark1"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property WaterMark1 As %Integer;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Watermark level to flush fetch results for first buffer"}),"\n",(0,n.jsx)(s.h3,{id:"watermark2",children:"WaterMark2"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property WaterMark2 As %Integer;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Watermark level to flush fetch results for second through Nth buffer"}),"\n",(0,n.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(s.h3,{id:"builddispatch",children:"BuildDispatch"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method BuildDispatch()\n"})}),"\n",(0,n.jsx)(s.p,{children:"Build the local array for looking up client functions to the dispatch number The functions allows for this server process are based on the resources the process has We also define ..ServiceType here. This is a string with: position 1 ON: User has %Service_SQL position 2 ON: User has %Service_Object position 3 ON: User has %Service_DirectLoad (XEP)"}),"\n",(0,n.jsx)(s.h3,{id:"superconnect",children:"SuperConnect"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SuperConnect(protocol, msgid, acn, io, %qport)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"setupdevice",children:"SetupDevice"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method SetupDevice(io)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Setup TCP/IP device specific options, the device must be the current device"}),"\n",(0,n.jsx)(s.h3,{id:"setupshmdevice",children:"SetupShmDevice"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod SetupShmDevice(ByRef shmIO, shmConnect, returnStatus = 0, ByRef statusCode, currentDevice = "", setQdev = 0)\n'})}),"\n",(0,n.jsx)(s.p,{children:"Setup SharedMemory device specific options, the device must be the current device"}),"\n",(0,n.jsx)(s.h3,{id:"initshm",children:"InitSHM"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod InitSHM(ByRef shmIO, dollarJ, shmSize, shmName, shmWaitFlag, openTimeout, returnStatus = 0, ByRef statusCode, currentDevice = "", setQdev = 0)\n'})}),"\n",(0,n.jsx)(s.p,{children:"Generic Init SharedMemory device"}),"\n",(0,n.jsx)(s.h3,{id:"supererror",children:"SuperError"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SuperError(msgid, acn, rc)\n"})}),"\n",(0,n.jsx)(s.p,{children:"; send Super Server error message (called from %SYS.SERVER)"}),"\n",(0,n.jsx)(s.h3,{id:"lcbsuperconnect1",children:"LCBSuperConnect1"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LCBSuperConnect1(protocol, msgid, acn, io)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Support connecting via ccallin-based SPC device, for Light C++ Binding. Called from LCB to process first message from SendLogonMessage()"}),"\n",(0,n.jsx)(s.h3,{id:"lcbsuperconnect2",children:"LCBSuperConnect2"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LCBSuperConnect2(io)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Support connecting via ccallin-based SPC device, for Light C++ Binding. Called from LCB to process second message from SendLogonMessage()"}),"\n",(0,n.jsx)(s.h3,{id:"logon",children:"Logon"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod Logon(ns, brokerToken = "") [ Private ]\n'})}),"\n",(0,n.jsx)(s.h3,{id:"getserverprocesscount",children:"GetServerProcessCount"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetServerProcessCount()\n"})}),"\n",(0,n.jsx)(s.p,{children:"Count the current number of xDBC server processes"}),"\n",(0,n.jsx)(s.h3,{id:"authenticationerror",children:"AuthenticationError"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod AuthenticationError(text, status, ns = "")\n'})}),"\n",(0,n.jsx)(s.h3,{id:"gwexecutesingle",children:"GWExecuteSingle"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GWExecuteSingle(%qmsgid, %qacn, %qfun) [ PublicList = (i, nparm, oref, x) ]\n"})}),"\n",(0,n.jsx)(s.h3,{id:"gwdisconnect",children:"GWDisconnect"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GWDisconnect(device)\n"})}),"\n",(0,n.jsx)(s.p,{children:"This entry point is called from the gateway re-entrance code to cleanup RETURNs nothing"}),"\n",(0,n.jsx)(s.h3,{id:"server",children:"Server"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Server(jumpToMain As %Integer = 0)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"startsysioloop",children:"startSYSIOLoop"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod startSYSIOLoop()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"xdcall",children:"XDCall"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod XDCall()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"prepare",children:"Prepare"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Prepare()\n"})}),"\n",(0,n.jsx)(s.p,{children:"Called by PP, DQ (Direct Query), DU (Direct Update), DX (Direct Static Cursor)"}),"\n",(0,n.jsx)(s.h3,{id:"spprepare",children:"SPPrepare"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPPrepare(ByRef returnmeta)\n"})}),"\n",(0,n.jsx)(s.p,{children:'Called from srvDS (Direct Stored procedure) and srvSP (Prepare Stored Procedure) if returnmeta=1, do not write the metadata to the zobjexport buffer here. This means it is a "DS" call and we need to wait and wrie the metadata after SP execution. This is needed in case the SP execution performs re-entrancy, the metadata written to the buffer will be lost'}),"\n",(0,n.jsx)(s.h3,{id:"spfunction",children:"SPFunction"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPFunction(procmeta)\n"})}),"\n",(0,n.jsx)(s.p,{children:"if procmeta is defined, this was a DS call and we need to write the metadata on the wire after the proc execution"}),"\n",(0,n.jsx)(s.h3,{id:"spquery",children:"SPQuery"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPQuery(ByRef procmeta, catalogQuery = 0) [ PublicList = rc ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Called from srvDS (Direct Stored procedure), srvSQ (Stored Procedure Query Execute), srvUNK for catalog queries if procmeta is defined, this was a DS call and we need to write the metadata on the wire after the proc execution"}),"\n",(0,n.jsx)(s.h3,{id:"spfetch",children:"SPFetch"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPFetch(directcall, %qHandle)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Called from srvSF (Stored Procedure Fetch Data) and SPQuery directcall=1 means this is an srvSF call"}),"\n",(0,n.jsx)(s.h3,{id:"spclose",children:"SPClose"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPClose(%qHandle)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Called from SPFetch"}),"\n",(0,n.jsx)(s.h3,{id:"spexecute",children:"SPExecute"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPExecute()\n"})}),"\n",(0,n.jsx)(s.p,{children:"Called from srvMS (Multiple Result Set)"}),"\n",(0,n.jsx)(s.h3,{id:"spmoreresults",children:"SPMoreResults"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPMoreResults(directcall)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Called from SPExecute, srvMR (Get More Results), and DirectDialect directcall = 1 when called from srvMR, otherwise 0."}),"\n",(0,n.jsx)(s.h3,{id:"spmoredata",children:"SPMoreData"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPMoreData()\n"})}),"\n",(0,n.jsx)(s.p,{children:"Called from srvMD (Multiple Result Sets Fetch Data)"}),"\n",(0,n.jsx)(s.h3,{id:"auditsp",children:"AuditSP"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod AuditSP(parameters)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"staticcursorexecute",children:"StaticCursorExecute"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod StaticCursorExecute()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"executebatch",children:"ExecuteBatch"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ExecuteBatch()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"executebatcherror",children:"ExecuteBatchError"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ExecuteBatchError(i, cnt)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"readqueryparameters",children:"ReadQueryParameters"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ReadQueryParameters()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"spreadparameters",children:"SPReadParameters"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPReadParameters(parameters)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"spreadparametersdp",children:"SPReadParametersDP"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPReadParametersDP(parameters)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"spwriteparameters",children:"SPWriteParameters"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPWriteParameters(parameters)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"spwriteparametersdp",children:"SPWriteParametersDP"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SPWriteParametersDP(parameters)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"setcompilemode",children:"SetCompileMode"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SetCompileMode()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"cacheresultsetfetch",children:"CacheResultSetFetch"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CacheResultSetFetch()\n"})}),"\n",(0,n.jsx)(s.p,{children:"called from srvFR"}),"\n",(0,n.jsx)(s.h3,{id:"gatewayin",children:"GatewayIn"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GatewayIn()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"transact",children:"Transact"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Transact(ttype)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"resetconnection",children:"ResetConnection"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ResetConnection()\n"})}),"\n",(0,n.jsx)(s.p,{children:"resets/cleans up the connection so that it can be reused in a pooled env"}),"\n",(0,n.jsx)(s.h3,{id:"flusherror",children:"FlushError"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod FlushError(tag, ns = "")\n'})}),"\n",(0,n.jsx)(s.h3,{id:"processexternalinterrupt",children:"ProcessExternalInterrupt"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ProcessExternalInterrupt(pCloseCurrentStatement = 1)\n"})}),"\n",(0,n.jsx)(s.p,{children:"The process received an  error, deal with it..."}),"\n",(0,n.jsx)(s.h3,{id:"recorderror",children:"RecordError"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod RecordError(tag)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Record the error on the server. Like FlushError, but send nothing to the client"}),"\n",(0,n.jsx)(s.h3,{id:"isolationlevel",children:"IsolationLevel"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod IsolationLevel()\n"})}),"\n",(0,n.jsx)(s.p,{children:"Get/set server process's isolation level Called from srvIL We support READ_COMMITED (0), READ_COMMITTED (1), and READ_VERIFIED (3) The client mapping for these values is: 0 on server, 1 on client // uncommitted 1 on server, 2 on client // committed 3 on server, 32 on client // verified if level=0, the client is simply asking what the current isolation level is."}),"\n",(0,n.jsx)(s.h3,{id:"closeup",children:"CloseUp"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CloseUp(atend = 0, nocache = 0)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"closeallstatements",children:"CloseAllStatements"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CloseAllStatements()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"createoref",children:"CreateOref"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CreateOref(discard = 0)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Structure of linked list FIFO $$$srv.ObjectCache: $$$srv.ObjectCache(%qacn)=oref $$$srv.ObjectCache(%qacn,0)=forward pointer towards the head of the queue $$$srv.ObjectCache(%qacn,1)=back pointer towards the tail of the queue $$$srv.ObjectCacheHead=head of the queue (%qacn value) $$$srv.ObjectCacheTail=tail of the queue (%qacn value) $$$srv.ObjectCacheSize=size of the queue See if we have this oref in the cache, if so return it and if not then %new the class we want and return this"}),"\n",(0,n.jsx)(s.h3,{id:"closestatement",children:"CloseStatement"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CloseStatement(%qacn)\n"})}),"\n",(0,n.jsx)(s.p,{children:"called from srvCU, Prepare, SPPrepare"}),"\n",(0,n.jsx)(s.h3,{id:"catalog",children:"Catalog"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod Catalog(query)\n"})}),"\n",(0,n.jsx)(s.p,{children:"process Catalog Queries"}),"\n",(0,n.jsx)(s.h3,{id:"jpaquery",children:"JPAQuery"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod JPAQuery()\n"})}),"\n",(0,n.jsx)(s.p,{children:"JPAQuery() implements the QQ message processor"}),"\n",(0,n.jsx)(s.h3,{id:"iscprocall",children:"ISCProcAll"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ISCProcAll(SCHEMA, PROC)\n"})}),"\n",(0,n.jsx)(s.p,{children:"ISCProcAll takes a procedure and schema and checks to see if this is a class from CACHELIB with no owner. if it is, privileges do not need to be checked on this procedure and everyone can run it. This preserves behavior we had prior to DPV4707 where privileges were not checked on hidden procedures Returns: 1 - if this procedure is from CACHELIB and there is no owner - no privilege checking needed 0 - otherwise"}),"\n",(0,n.jsx)(s.h3,{id:"directdialect",children:"DirectDialect"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DirectDialect()\n"})}),"\n",(0,n.jsx)(s.h3,{id:"directparameter",children:"DirectParameter"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DirectParameter()\n"})}),"\n",(0,n.jsx)(s.p,{children:"DIRECT_EXECUTE_DIALECT_PARAM (DP) Field Name Description ----------------------- ------------------------------------------------------ SQL Dialect SQL Dialect (DEFAULT = 0, MSSQL = 1, SYBASE = 2) SQL Text SQL statement isStatic isStatic - unused Statement Timeout Statement Timeout (protocol>=42) Parameter Sets Number of Parameter Sets (Ignored) Parameter Count Number of Parameters ...Type Parameter Type ...Precision Parameter Precision ...Scale Parameter Scale ...Nullable Parameter Nullable ...Name Parameter Name ...Mode Parameter Mode Parameter List $LB(par1,...,parCount)"}),"\n",(0,n.jsx)(s.h3,{id:"cacheinfo",children:"CacheInfo"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CacheInfo(io, uplen)\n"})}),"\n",(0,n.jsx)(s.p,{children:"Called from %SYS.SERVER to get available namespaces."}),"\n",(0,n.jsx)(s.h3,{id:"getversion",children:"GetVersion"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetVersion()\n"})}),"\n",(0,n.jsx)(s.p,{children:"Called from SQLVer^SystemCheck"}),"\n",(0,n.jsx)(s.h3,{id:"setuplogging",children:"setupLogging"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod setupLogging(ns)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"log",children:"log"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod log(text = "", sameid = 0, ByRef sql, ByRef vartypes, ns = "")\n'})}),"\n",(0,n.jsx)(s.p,{children:'log something log file format is: 1 2 3 4 5 6 7 8 9 10 ^%sqlcq(namespace,"log",pid,id) = $lb(timestamp,text, message id, cursor number, function, isolation level, transaction level, error code, message,rowcount,%lasterr) ^%sqlcq(namespace,"log",pid,id,"sql") = array of sql text ^%sqlcq(namespace,"log",pid,id,"vartype") = array of metadata for %sqlHVarTypes ^%sqlcq(namespace,"log",pid,id,"info") = # of info lines ^%sqlcq(namespace,"log",pid,id,"info",1..n) = Additional information for this entry'}),"\n",(0,n.jsx)(s.h3,{id:"logappend",children:"logappend"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod logappend(info = "", ns = "")\n'})}),"\n",(0,n.jsx)(s.p,{children:"Add info to the current log entry"}),"\n",(0,n.jsx)(s.h3,{id:"dumplog",children:"dumplog"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod dumplog(pid = "")\n'})}),"\n",(0,n.jsx)(s.h3,{id:"dumponelog",children:"dumponelog"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod dumponelog(pid)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"timings",children:"timings"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod timings(outlierPerc = 500, pqpulimit = 1)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"delta",children:"delta"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method delta(t1, t2)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"median",children:"median"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method median(ByRefstatements, sid, fun)\n"})}),"\n",(0,n.jsx)(s.h3,{id:"purgelog",children:"purgelog"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod purgelog(pid = "*")\n'})}),"\n",(0,n.jsx)(s.h3,{id:"sqlcode",children:"sqlcode"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod sqlcode(code)\n"})})]})}function d(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(t,{...e})}):t(e)}},28453:(e,s,r)=>{r.d(s,{R:()=>a,x:()=>i});var n=r(96540);const c={},l=n.createContext(c);function a(e){const s=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:a(e.components),n.createElement(l.Provider,{value:s},e.children)}}}]);