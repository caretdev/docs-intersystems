"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[34791],{89641:(e,s,n)=>{n.r(s),n.d(s,{contentTitle:()=>o,default:()=>i,frontMatter:()=>c,toc:()=>l});var t=n(74848),r=n(28453);const c={pagination_prev:null,pagination_next:null},o="%SYS.TokenAuth",l=[{value:"Properties",id:"properties",level:2},{value:"SID",id:"sid",level:3},{value:"Expires",id:"expires",level:3},{value:"SecurityContext",id:"securitycontext",level:3},{value:"AccessTokenHash",id:"accesstokenhash",level:3},{value:"RefreshTokenHash",id:"refreshtokenhash",level:3},{value:"GroupId",id:"groupid",level:3},{value:"Methods",id:"methods",level:2},{value:"GenerateAccessToken",id:"generateaccesstoken",level:3},{value:"ValidateAccessToken",id:"validateaccesstoken",level:3},{value:"RefreshToken",id:"refreshtoken",level:3},{value:"RevokeTokensForSID",id:"revoketokensforsid",level:3},{value:"RevokeToken",id:"revoketoken",level:3},{value:"CreateTokens",id:"createtokens",level:3},{value:"ResetSystemJWKS",id:"resetsystemjwks",level:3},{value:"CheckToken",id:"checktoken",level:3},{value:"UpdateGroupId",id:"updategroupid",level:3},{value:"RevokeExpiredTokens",id:"revokeexpiredtokens",level:3},{value:"%OnBeforeSave",id:"onbeforesave",level:3},{value:"%OnDelete",id:"ondelete",level:3},{value:"%OnOpen",id:"onopen",level:3}];function a(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"systokenauth",children:"%SYS.TokenAuth"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Class %SYS.TokenAuth Extends %Persistent [ Final, System = 4 ]\n"})}),"\n",(0,t.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,t.jsx)(s.h3,{id:"sid",children:"SID"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property SID As %String(MAXLEN = 24) [ InitialExpression = {$System.Encryption.Base64Encode($System.Encryption.GenCryptRand(18))} ];\n"})}),"\n",(0,t.jsx)(s.h3,{id:"expires",children:"Expires"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property Expires As %BigInt;\n"})}),"\n",(0,t.jsx)(s.h3,{id:"securitycontext",children:"SecurityContext"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'Property SecurityContext As %String(MAXLEN = "");\n'})}),"\n",(0,t.jsx)(s.h3,{id:"accesstokenhash",children:"AccessTokenHash"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property AccessTokenHash As %String(MAXLEN = 64);\n"})}),"\n",(0,t.jsx)(s.h3,{id:"refreshtokenhash",children:"RefreshTokenHash"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property RefreshTokenHash As %String(MAXLEN = 64);\n"})}),"\n",(0,t.jsx)(s.h3,{id:"groupid",children:"GroupId"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'Property GroupId As %String(MAXLEN = "");\n'})}),"\n",(0,t.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(s.h3,{id:"generateaccesstoken",children:"GenerateAccessToken"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GenerateAccessToken(cspSession As %CSP.Session, Output info As %DynamicObject) As %Boolean [ Internal ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"validateaccesstoken",children:"ValidateAccessToken"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ValidateAccessToken(jwt As %String, Output state As %List) As %Boolean [ Internal ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"refreshtoken",children:"RefreshToken"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod RefreshToken(token As %String, Output info As %DynamicObject, state As %List) As %Boolean [ Internal ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"revoketokensforsid",children:"RevokeTokensForSID"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod RevokeTokensForSID(sid As %String, groupId As %String = "") As %Status [ Internal ]\n'})}),"\n",(0,t.jsx)(s.h3,{id:"revoketoken",children:"RevokeToken"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod RevokeToken(token As %String, Output state As %List) As %Boolean [ Internal ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"createtokens",children:"CreateTokens"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method CreateTokens(data As %DynamicObject, Output info As %DynamicObject) As %Boolean [ Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"resetsystemjwks",children:"ResetSystemJWKS"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ResetSystemJWKS() [ Internal ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"checktoken",children:"CheckToken"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CheckToken(jwt As %String, checkExpired As %Boolean = 1, Output session As %SYS.TokenAuth, Output body As %DynamicObject) As %Boolean [ Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"updategroupid",children:"UpdateGroupId"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod UpdateGroupId(sid As %String, groupId As %String) As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"revokeexpiredtokens",children:"RevokeExpiredTokens"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod RevokeExpiredTokens() [ Internal ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"onbeforesave",children:"%OnBeforeSave"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %OnBeforeSave() As %Status [ Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"ondelete",children:"%OnDelete"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod %OnDelete() As %Status [ Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"onopen",children:"%OnOpen"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %OnOpen() As %Status [ Private ]\n"})})]})}function i(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>l});var t=n(96540);const r={},c=t.createContext(r);function o(e){const s=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(c.Provider,{value:s},e.children)}}}]);