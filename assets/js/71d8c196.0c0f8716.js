"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[4418],{63794:(e,s,l)=>{l.r(s),l.d(s,{contentTitle:()=>t,default:()=>d,frontMatter:()=>n,toc:()=>c});var a=l(74848),i=l(28453);const n={pagination_prev:null,pagination_next:null},t="%Studio.SourceControl.UI",c=[{value:"Parameters",id:"parameters",level:2},{value:"SrcVer",id:"srcver",level:3},{value:"Version",id:"version",level:3},{value:"SECURITYRESOURCE;",id:"securityresource",level:3},{value:"Methods",id:"methods",level:2},{value:"OnPage",id:"onpage",level:3},{value:"UpdateSession",id:"updatesession",level:3},{value:"MenuDisplay",id:"menudisplay",level:3},{value:"LoginDisplay",id:"logindisplay",level:3},{value:"ClearP4Ticket",id:"clearp4ticket",level:3},{value:"ShelveFile",id:"shelvefile",level:3},{value:"UnshelveFile",id:"unshelvefile",level:3},{value:"SwitchChangelist",id:"switchchangelist",level:3},{value:"CheckinDisplay",id:"checkindisplay",level:3},{value:"DownloadDisplay",id:"downloaddisplay",level:3},{value:"LoadDisplay",id:"loaddisplay",level:3},{value:"IsNoUploadException",id:"isnouploadexception",level:3},{value:"BundleDisplay",id:"bundledisplay",level:3},{value:"UploadDisplay",id:"uploaddisplay",level:3},{value:"ItemsetlogDisplay",id:"itemsetlogdisplay",level:3},{value:"ItemsetautodownloadDisplay",id:"itemsetautodownloaddisplay",level:3},{value:"ItemsethistoryDisplay",id:"itemsethistorydisplay",level:3},{value:"SummaryDisplay",id:"summarydisplay",level:3},{value:"RefreshDisplay",id:"refreshdisplay",level:3},{value:"SystemdefaultsDisplay",id:"systemdefaultsdisplay",level:3},{value:"DiffDisplay",id:"diffdisplay",level:3},{value:"ValidateCCRUpload",id:"validateccrupload",level:3},{value:"RetrieveCCRDetails",id:"retrieveccrdetails",level:3},{value:"DiffEnabled",id:"diffenabled",level:3},{value:"ConvertStreamToHTML",id:"convertstreamtohtml",level:3},{value:"SelfLink",id:"selflink",level:3},{value:"ValidateDiffDisplay",id:"validatediffdisplay",level:3},{value:"GetParameter",id:"getparameter",level:3},{value:"AllowedApps",id:"allowedapps",level:3},{value:"PerforceLogin",id:"perforcelogin",level:3},{value:"PerforceLoggedIn",id:"perforceloggedin",level:3},{value:"OnPreHTTP",id:"onprehttp",level:3},{value:"OnToolsCompile",id:"ontoolscompile",level:3},{value:"InstanceVersion",id:"instanceversion",level:3},{value:"WriteDiffJS",id:"writediffjs",level:3}];function r(e){const s={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"studiosourcecontrolui",children:"%Studio.SourceControl.UI"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"Class %Studio.SourceControl.UI Extends %CSP.StudioTemplateSuper [ System = 4 ]\n"})}),"\n",(0,a.jsx)(s.p,{children:"Dialog for checking in files to Perforce"}),"\n",(0,a.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,a.jsx)(s.h3,{id:"srcver",children:"SrcVer"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter SrcVer = "$Id: //iris/2024.3.0/databases/sys/cls/Studio/SourceControl/UI.xml#1 $";\n'})}),"\n",(0,a.jsx)(s.p,{children:"This Parameter should be updated when synced from Perforce"}),"\n",(0,a.jsx)(s.h3,{id:"version",children:"Version"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter Version = 106;\n"})}),"\n",(0,a.jsx)(s.p,{children:"Revision number of this class when compiled as part of the //custom_ccrs/_common/config/... branch. This version will not be updated (by design) when the class is integrated to other branches. This allows the user to tell what version of the Studio client tools are in use."}),"\n",(0,a.jsx)(s.h3,{id:"securityresource",children:"SECURITYRESOURCE;"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter SECURITYRESOURCE;\n"})}),"\n",(0,a.jsx)(s.p,{children:"Do not accept the default SECURITYRESOURCE from the superclass as this page handles it's own security to allow TrakCare use-cases"}),"\n",(0,a.jsx)(s.p,{children:"NOTE - this parameter is not enforced until 2012.2"}),"\n",(0,a.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,a.jsx)(s.h3,{id:"onpage",children:"OnPage"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPage() As %Status [ ServerOnly = 1 ]\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Event handler for ",(0,a.jsx)(s.strong,{children:"PAGE"})," event: this is invoked in order to generate the content of a csp page."]}),"\n",(0,a.jsx)(s.h3,{id:"updatesession",children:"UpdateSession"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod UpdateSession()\n"})}),"\n",(0,a.jsx)(s.h3,{id:"menudisplay",children:"MenuDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod MenuDisplay()\n"})}),"\n",(0,a.jsx)(s.h3,{id:"logindisplay",children:"LoginDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LoginDisplay(Output pContinue As %Boolean = 1)\n"})}),"\n",(0,a.jsx)(s.p,{children:"If login needed (connected multi-developer instance), displays/processes the login form. Other UIs can call this and examine pLoggedIn to determine if processing should continue."}),"\n",(0,a.jsx)(s.h3,{id:"clearp4ticket",children:"ClearP4Ticket"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ClearP4Ticket()\n"})}),"\n",(0,a.jsx)(s.p,{children:"Handles case of an invalid perforce ticket. Clears the cache and refreshes the page."}),"\n",(0,a.jsx)(s.h3,{id:"shelvefile",children:"ShelveFile"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ShelveFile(file As %String)\n"})}),"\n",(0,a.jsx)(s.p,{children:"Shelve a given file in the current selected changelist"}),"\n",(0,a.jsx)(s.h3,{id:"unshelvefile",children:"UnshelveFile"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod UnshelveFile(file As %String)\n"})}),"\n",(0,a.jsx)(s.p,{children:"Unshelve a given shelved file from the current selected changelist, into the same changelist"}),"\n",(0,a.jsx)(s.h3,{id:"switchchangelist",children:"SwitchChangelist"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SwitchChangelist(newChangelist)\n"})}),"\n",(0,a.jsx)(s.p,{children:"Store the new changelist number in %session.Data if switching changelists on check-in page"}),"\n",(0,a.jsx)(s.h3,{id:"checkindisplay",children:"CheckinDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod CheckinDisplay(DisplayForm As %Boolean)\n"})}),"\n",(0,a.jsx)(s.p,{children:"Page for checking in files from perforce changelists in the current workspace. Only valid for connected clients."}),"\n",(0,a.jsx)(s.h3,{id:"downloaddisplay",children:"DownloadDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DownloadDisplay(DisplayForm As %Boolean)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"loaddisplay",children:"LoadDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod LoadDisplay(DisplayForm As %Boolean)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"isnouploadexception",children:"IsNoUploadException"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod IsNoUploadException(name As %String) As %Boolean\n"})}),"\n",(0,a.jsx)(s.p,{children:"Given an internal name of an item, determine if it is an exception for the NoUpload flag"}),"\n",(0,a.jsx)(s.h3,{id:"bundledisplay",children:"BundleDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod BundleDisplay(DisplayForm As %Boolean)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"uploaddisplay",children:"UploadDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod UploadDisplay(DisplayForm As %Boolean)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"itemsetlogdisplay",children:"ItemsetlogDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ItemsetlogDisplay(DisplayForm As %Boolean)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"itemsetautodownloaddisplay",children:"ItemsetautodownloadDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ItemsetautodownloadDisplay()\n"})}),"\n",(0,a.jsx)(s.h3,{id:"itemsethistorydisplay",children:"ItemsethistoryDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ItemsethistoryDisplay()\n"})}),"\n",(0,a.jsx)(s.h3,{id:"summarydisplay",children:"SummaryDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SummaryDisplay()\n"})}),"\n",(0,a.jsx)(s.h3,{id:"refreshdisplay",children:"RefreshDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod RefreshDisplay(DisplayForm As %Boolean)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"systemdefaultsdisplay",children:"SystemdefaultsDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SystemdefaultsDisplay(DisplayForm As %Boolean)\n"})}),"\n",(0,a.jsx)(s.p,{children:"Runs the Ens.Config.DefaultSettings.%Export method"}),"\n",(0,a.jsx)(s.h3,{id:"diffdisplay",children:"DiffDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DiffDisplay()\n"})}),"\n",(0,a.jsx)(s.p,{children:'Displays a diff between the file passes in the file url parameter and file_".bak" if it exists'}),"\n",(0,a.jsx)(s.h3,{id:"validateccrupload",children:"ValidateCCRUpload"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod ValidateCCRUpload(pRID = "")\n'})}),"\n",(0,a.jsx)(s.p,{children:"Called from UI Bundle page to validate whether an ItemSet can be uploaded for a given CCR Updates elements on the page according to the status"}),"\n",(0,a.jsx)(s.h3,{id:"retrieveccrdetails",children:"RetrieveCCRDetails"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod RetrieveCCRDetails(pRID = "", pToken = "")\n'})}),"\n",(0,a.jsx)(s.p,{children:"Retrieve details of the requested CCR and update the UI with the details"}),"\n",(0,a.jsx)(s.h3,{id:"diffenabled",children:"DiffEnabled"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod DiffEnabled() As %Boolean [ CodeMode = expression ]\n"})}),"\n",(0,a.jsx)(s.p,{children:"Returns boolean value indicated whether or not the diff UI can be displayed"}),"\n",(0,a.jsx)(s.p,{children:'Set ^SYS("SourceControl","UIConfig","DisableDiff")=1 to disable diff for a specific namespace'}),"\n",(0,a.jsx)(s.p,{children:'Set ^%SYS("SourceControl","UIConfig","DisableDiff")=1 to disable diff for the entire instance'}),"\n",(0,a.jsx)(s.h3,{id:"convertstreamtohtml",children:"ConvertStreamToHTML"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ConvertStreamToHTML(pStream) As %Stream.GlobalCharacter\n"})}),"\n",(0,a.jsx)(s.h3,{id:"selflink",children:"SelfLink"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod SelfLink() [ CodeMode = expression ]\n"})}),"\n",(0,a.jsx)(s.p,{children:"Link to this page"}),"\n",(0,a.jsx)(s.h3,{id:"validatediffdisplay",children:"ValidateDiffDisplay"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod ValidateDiffDisplay() [ Internal ]\n"})}),"\n",(0,a.jsxs)(s.p,{children:["This method displays validation logic for the included diff_match_patch diff JS To use, you must put the following into /CSP/sys: //custom_ccrs/_common/config/internal/testing/manual_tests/UI.diff_match_patch_test.html //custom_ccrs/_common/config/internal/testing/manual_tests/diff_match_patch_test.js NOTE: The above files are not to be distributed in product; they are only for manually validating the diff functionality Access this test via ",(0,a.jsx)(s.a,{href:"http://localhost:/csp/sys/%25Studio.SourceControl.UI.cls?action=validatediff",children:"http://localhost:/csp/sys/%25Studio.SourceControl.UI.cls?action=validatediff"})]}),"\n",(0,a.jsx)(s.h3,{id:"getparameter",children:"GetParameter"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetParameter(Parameter) As %String [ CodeMode = objectgenerator ]\n"})}),"\n",(0,a.jsx)(s.p,{children:"Pages inheriting from %CSP.Page don't have a %GetParameter() method until 2010.2. This method allows access to the parameter values in the class from outside of the class"}),"\n",(0,a.jsx)(s.h3,{id:"allowedapps",children:"AllowedApps"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod AllowedApps() As %String [ CodeMode = expression ]\n"})}),"\n",(0,a.jsx)(s.p,{children:"CSP Applications allowed to access this UI."}),"\n",(0,a.jsxs)(s.p,{children:["To add web applications to the return list, set ",(0,a.jsx)(s.code,{children:'^%SYS("SourceControl","AllowedApps")=$lb(app1,app2,...)'}),". NOTE: app1, app2, etc must have a trailing '/', e.g. ",(0,a.jsx)(s.code,{children:'^%SYS("SourceControl","AllowedApps")=$lb("/csp/users/")'})]}),"\n",(0,a.jsx)(s.h3,{id:"perforcelogin",children:"PerforceLogin"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod PerforceLogin(Password) As %Status\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Accepts the password for the current Perforce user (defined by $USERNAME) and validates password by attempting to log into Perforce and obtain a IP-bound ticket",(0,a.jsx)(s.br,{}),"\nIf login is successful, ticket is stored in the session to be reused on later calls to Perforce",(0,a.jsx)(s.br,{}),"\nIf Password is not defined, then the locally cached ticket will be cleared"]}),"\n",(0,a.jsx)(s.h3,{id:"perforceloggedin",children:"PerforceLoggedIn"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod PerforceLoggedIn() As %Boolean\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Returns true if the user has a valid Perforce ticket in the CSP session, otherwise returns false.",(0,a.jsx)(s.br,{}),"\nAlso obtains and validate an existing ticket.",(0,a.jsx)(s.br,{}),"\nThis also inializes the process ticket variable, so this must be called whenever a server-side method requiring Perforce access is invoked"]}),"\n",(0,a.jsx)(s.h3,{id:"onprehttp",children:"OnPreHTTP"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnPreHTTP() As %Boolean [ ServerOnly = 1 ]\n"})}),"\n",(0,a.jsx)(s.p,{children:"Ensure that this page is only accessible through approved CSP Applications"}),"\n",(0,a.jsx)(s.h3,{id:"ontoolscompile",children:"OnToolsCompile"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod OnToolsCompile() [ CodeMode = objectgenerator, Internal ]\n"})}),"\n",(0,a.jsx)(s.p,{children:"Handles all compile-time logic for this class"}),"\n",(0,a.jsx)(s.h3,{id:"instanceversion",children:"InstanceVersion"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod InstanceVersion() As %Numeric [ CodeMode = expression ]\n"})}),"\n",(0,a.jsx)(s.p,{children:"Returns value the Major.Minor version for this instance, so it can be used in comparison code which makes sure certain features are used in appropriate versions"}),"\n",(0,a.jsx)(s.h3,{id:"writediffjs",children:"WriteDiffJS"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod WriteDiffJS() [ Internal ]\n"})}),"\n",(0,a.jsxs)(s.p,{children:["////////////////////////////////////////////////////////////////////////////////////////////////////////// diff-match-patch ------------------------------------------- Obtained from: ",(0,a.jsx)(s.a,{href:"https://github.com/google/diff-match-patch",children:"https://github.com/google/diff-match-patch"})," at commit a6367d7866833ac037fbdefcdbcbee4def86e326 Used under Apache License 2.0 (",(0,a.jsx)(s.a,{href:"https://github.com/google/diff-match-patch/blob/0ae308daa77aeddb089cd6b7b0a443fca026266e/LICENSE",children:"https://github.com/google/diff-match-patch/blob/0ae308daa77aeddb089cd6b7b0a443fca026266e/LICENSE"}),") ------------------------------------------- The Javascript code below is from ",(0,a.jsx)(s.a,{href:"https://github.com/google/diff-match-patch/blob/a6367d7866833ac037fbdefcdbcbee4def86e326/javascript/diff%5C_match%5C_patch.js",children:"https://github.com/google/diff-match-patch/blob/a6367d7866833ac037fbdefcdbcbee4def86e326/javascript/diff\\_match\\_patch.js"})," //////////////////////////////////////////////////////////////////////////////////////////////////////////"]})]})}function d(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(r,{...e})}):r(e)}},28453:(e,s,l)=>{l.d(s,{R:()=>t,x:()=>c});var a=l(96540);const i={},n=a.createContext(i);function t(e){const s=a.useContext(n);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),a.createElement(n.Provider,{value:s},e.children)}}}]);