"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[48009],{86639:(e,t,s)=>{s.r(t),s.d(t,{contentTitle:()=>r,default:()=>i,frontMatter:()=>l,toc:()=>o});var n=s(74848),a=s(28453);const l={pagination_prev:null,pagination_next:null},r="%ZEN.Component.querySource",o=[{value:"Properties",id:"properties",level:2},{value:"queryClass",id:"queryclass",level:3},{value:"queryName",id:"queryname",level:3},{value:"sql",id:"sql",level:3},{value:"tableName",id:"tablename",level:3},{value:"columnName",id:"columnname",level:3},{value:"whereClause",id:"whereclause",level:3},{value:"orderByClause",id:"orderbyclause",level:3},{value:"groupByClause",id:"groupbyclause",level:3},{value:"maxRows",id:"maxrows",level:3},{value:"countRows",id:"countrows",level:3},{value:"OnCreateResultSet",id:"oncreateresultset",level:3},{value:"OnExecuteResultSet",id:"onexecuteresultset",level:3},{value:"Methods",id:"methods",level:2},{value:"%CreateResultSet",id:"createresultset",level:3},{value:"%OnCreateResultSet",id:"oncreateresultset-1",level:3},{value:"%OnExecuteResultSet",id:"onexecuteresultset-1",level:3}];function c(e){const t={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"zencomponentquerysource",children:"%ZEN.Component.querySource"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Class %ZEN.Component.querySource [ Abstract, Deprecated, PropertyClass = %ZEN.componentParameters, System = 3 ]\n"})}),"\n",(0,n.jsxs)(t.p,{children:["This abstract class provides a standard interface for creating a %ResultSet object that a component can then use to supply itself with data.",(0,n.jsx)(t.br,{}),"\nThere are several ways to define the creation of a %ResultSet object:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Define an SQL statement using the sql property."}),"\n",(0,n.jsx)(t.li,{children:"Provide the class and name of a class query using the queryClass and queryName properties."}),"\n",(0,n.jsx)(t.li,{children:"Define a callback method using the OnCreateResultSet property."}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"properties",children:"Properties"}),"\n",(0,n.jsx)(t.h3,{id:"queryclass",children:"queryClass"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property queryClass As %ZEN.Datatype.className(ZENENCRYPT = 1);\n"})}),"\n",(0,n.jsxs)(t.p,{children:["(optional) Name of the class containing the class query that will be used to create a %ResultSet object.",(0,n.jsx)(t.br,{}),"\nThis is an encrypted value and cannot be modified on the client."]}),"\n",(0,n.jsx)(t.h3,{id:"queryname",children:"queryName"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Property queryName As %ZEN.Datatype.classMember(MEMBERTYPE = "QUERY");\n'})}),"\n",(0,n.jsx)(t.p,{children:"(optional) Name of the class query that will be used to create a %ResultSet object."}),"\n",(0,n.jsx)(t.h3,{id:"sql",children:"sql"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property sql As %ZEN.Datatype.sql;\n"})}),"\n",(0,n.jsxs)(t.p,{children:["(optional) SQL statement that, if present, will be used to create a %ResultSet object.",(0,n.jsx)(t.br,{}),"\nIf defined, this takes precedence over queryClass and queryName."]}),"\n",(0,n.jsx)(t.h3,{id:"tablename",children:"tableName"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property tableName As %ZEN.Datatype.string(ZENENCRYPT = 1, ZENEXPRESSION = 1);\n"})}),"\n",(0,n.jsxs)(t.p,{children:["(optional) Name of an SQL table used to provide data.",(0,n.jsx)(t.br,{}),"\nFor sources that automatically create an SQL statement, this is the table used in the FROM clause.",(0,n.jsx)(t.br,{}),"\nIf no column information is supplied, then the %ID column of the table will be used as the SELECT list.",(0,n.jsx)(t.br,{}),"\nThis value is encrypted and cannot be modified on the client."]}),"\n",(0,n.jsx)(t.h3,{id:"columnname",children:"columnName"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property columnName As %ZEN.Datatype.string(ZENEXPRESSION = 1);\n"})}),"\n",(0,n.jsxs)(t.p,{children:["(optional) Name of a column in the SQL table used to provide data.",(0,n.jsx)(t.br,{}),"\nIf both this and tableName is specified, and no other columns are defined, then an automatically generated query will use %ID for the value column and the column specified by columnName for the display value.",(0,n.jsx)(t.br,{}),"\nThis must contain a valid column name."]}),"\n",(0,n.jsx)(t.h3,{id:"whereclause",children:"whereClause"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property whereClause As %ZEN.Datatype.string(ZENEXPRESSION = 1);\n"})}),"\n",(0,n.jsxs)(t.p,{children:["(optional) An SQL WHERE clause: e.g., \"Name='Elvis'\"",(0,n.jsx)(t.br,{}),"\nFor sources that automatically create an SQL statement, this is used to create the WHERE clause."]}),"\n",(0,n.jsx)(t.h3,{id:"orderbyclause",children:"orderByClause"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property orderByClause As %ZEN.Datatype.string(ZENEXPRESSION = 1);\n"})}),"\n",(0,n.jsxs)(t.p,{children:['(optional) An SQL ORDER BY clause: e.g., "Name,State"',(0,n.jsx)(t.br,{}),"\nFor sources that automatically create an SQL statement, this is used to create the ORDER BY clause."]}),"\n",(0,n.jsx)(t.h3,{id:"groupbyclause",children:"groupByClause"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property groupByClause As %ZEN.Datatype.string(ZENEXPRESSION = 1);\n"})}),"\n",(0,n.jsxs)(t.p,{children:['(optional) An SQL GROUP BY clause: e.g., "Year,State"',(0,n.jsx)(t.br,{}),"\nFor sources that automatically create an SQL statement, this is used to create a GROUP BY clause."]}),"\n",(0,n.jsx)(t.h3,{id:"maxrows",children:"maxRows"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property maxRows As %ZEN.Datatype.integer [ InitialExpression = 100 ];\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Maximum number of rows to fetch from the %ResultSet object. This provides a way to limit the number of rows displayed by a data-aware component.",(0,n.jsx)(t.br,{}),"\nIf this is set to 0, then no limit is enforced; all rows from the query are displayed."]}),"\n",(0,n.jsx)(t.h3,{id:"countrows",children:"countRows"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Property countRows As %ZEN.Datatype.integer [ InitialExpression = 0 ];\n"})}),"\n",(0,n.jsx)(t.p,{children:"This property should not be used; it is provided for backward compatibility. The original implementation of querySource caused the pInfo.rowCount property to be computed automatically, however this was never used and in cases where a table did not have an extent bitmap index would cause poor performance. To get the original behavior set this to 1 (true)."}),"\n",(0,n.jsx)(t.h3,{id:"oncreateresultset",children:"OnCreateResultSet"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Property OnCreateResultSet As %ZEN.Datatype.delegator(FORMALSPEC = "*tSC:%Status,pInfo:%ZEN.Auxiliary.QueryInfo", RETURNTYPE = "%ResultSet");\n'})}),"\n",(0,n.jsxs)(t.p,{children:["(optional) Name of Server-side callback method to call to create a %ResultSet object.",(0,n.jsx)(t.br,{}),"\nThis must be the name of a server-only method in the page class that contains this component."]}),"\n",(0,n.jsx)(t.h3,{id:"onexecuteresultset",children:"OnExecuteResultSet"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:'Property OnExecuteResultSet As %ZEN.Datatype.delegator(FORMALSPEC = "pRS:%Library.ResultSet,*tSC:%Status,pInfo:%ZEN.Auxiliary.QueryInfo", RETURNTYPE = "%Boolean");\n'})}),"\n",(0,n.jsxs)(t.p,{children:["(optional) Name of Server-side callback method to call to execute the %ResultSet object.",(0,n.jsx)(t.br,{}),"\nThis must be the name of a server-only method in the page class that contains this table pane."]}),"\n",(0,n.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(t.h3,{id:"createresultset",children:"%CreateResultSet"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method %CreateResultSet(Output tSC As %Status, pInfo As %ZEN.Auxiliary.QueryInfo, pExecute As %Boolean = 1) As %ResultSet [ Final ]\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Internal method.",(0,n.jsx)(t.br,{}),"\nCreate and execute the %ResultSet object used to supply data for this component. If pExecute is false, then do not execute the query."]}),"\n",(0,n.jsx)(t.h3,{id:"oncreateresultset-1",children:"%OnCreateResultSet"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method %OnCreateResultSet(Output tSC As %Status, pInfo As %ZEN.Auxiliary.QueryInfo) As %ResultSet\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Internal method.",(0,n.jsx)(t.br,{}),"\nSubclasses can override this to create the %ResultSet object used to used by this component.",(0,n.jsx)(t.br,{}),"\nThe default implementation is to call the page method specified by the OnCreateResultSet property, if defined."]}),"\n",(0,n.jsx)(t.h3,{id:"onexecuteresultset-1",children:"%OnExecuteResultSet"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-objectscript-class",children:"Method %OnExecuteResultSet(pRS As %ResultSet, Output tSC As %Status, pInfo As %ZEN.Auxiliary.QueryInfo) As %Boolean\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Internal method.",(0,n.jsx)(t.br,{}),"\nSubclasses can override this to execute the %ResultSet object used to by this component.",(0,n.jsx)(t.br,{}),"\nReturn true (1) if the result set has been executed.",(0,n.jsx)(t.br,{}),"\nThe default implementation is to call the page method specified by the onExecuteResultSet property, if defined."]})]})}function i(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>o});var n=s(96540);const a={},l=n.createContext(a);function r(e){const t=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),n.createElement(l.Provider,{value:t},e.children)}}}]);