"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[51144],{83491:(e,t,s)=>{s.r(t),s.d(t,{contentTitle:()=>r,default:()=>d,frontMatter:()=>i,toc:()=>l});var a=s(74848),n=s(28453);const i={pagination_prev:null,pagination_next:null},r="%Net.MailMessagePart",l=[{value:"Properties",id:"properties",level:2},{value:"IsMultiPart",id:"ismultipart",level:3},{value:"MultiPartType",id:"multiparttype",level:3},{value:"IsAlternative",id:"isalternative",level:3},{value:"IsBinary",id:"isbinary",level:3},{value:"IsBase64",id:"isbase64",level:3},{value:"Is7bit",id:"is7bit",level:3},{value:"IsHTML",id:"ishtml",level:3},{value:"ContentType",id:"contenttype",level:3},{value:"ContentTransferEncoding",id:"contenttransferencoding",level:3},{value:"TextData",id:"textdata",level:3},{value:"BinaryData",id:"binarydata",level:3},{value:"Parts",id:"parts",level:3},{value:"Dir",id:"dir",level:3},{value:"FileName",id:"filename",level:3},{value:"InlineAttachment",id:"inlineattachment",level:3},{value:"Headers",id:"headers",level:3},{value:"Charset",id:"charset",level:3},{value:"Debug",id:"debug",level:3},{value:"PartIndex",id:"partindex",level:3},{value:"Methods",id:"methods",level:2},{value:"IsAlternativeGet",id:"isalternativeget",level:3},{value:"IsAlternativeSet",id:"isalternativeset",level:3},{value:"IsBase64Get",id:"isbase64get",level:3},{value:"IsBase64Set",id:"isbase64set",level:3},{value:"Is7bitGet",id:"is7bitget",level:3},{value:"Is7bitSet",id:"is7bitset",level:3},{value:"ContentTransferEncodingSet",id:"contenttransferencodingset",level:3},{value:"CharsetSet",id:"charsetset",level:3},{value:"%OnNew",id:"onnew",level:3},{value:"AttachFile",id:"attachfile",level:3},{value:"AttachStream",id:"attachstream",level:3},{value:"GetFileName",id:"getfilename",level:3},{value:"AttachNewMessage",id:"attachnewmessage",level:3},{value:"AttachEmail",id:"attachemail",level:3},{value:"GetAttribute",id:"getattribute",level:3}];function c(e){const t={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"netmailmessagepart",children:"%Net.MailMessagePart"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Class %Net.MailMessagePart Extends %SerialObject [ System = 3 ]\n"})}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:"For information on using this class"}),", see ",(0,a.jsx)(t.a,{href:"/csp/docbook/DocBook.UI.Page.cls?FIND=CLASSES+%25Net.MailMessagePart",children:"Sending and Receiving Email"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"Send an SMTP mail message or receive a MIME message using POP3."}),"\n",(0,a.jsx)(t.h2,{id:"properties",children:"Properties"}),"\n",(0,a.jsx)(t.h3,{id:"ismultipart",children:"IsMultiPart"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property IsMultiPart As %Boolean [ InitialExpression = 0 ];\n"})}),"\n",(0,a.jsx)(t.p,{children:"If set, this message part (which may be the entire message) is made up out of parts which you need to process. If 0, then message consists of a single part and either has text data or binary data"}),"\n",(0,a.jsx)(t.h3,{id:"multiparttype",children:"MultiPartType"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property MultiPartType As %String;\n"})}),"\n",(0,a.jsx)(t.p,{children:'Type of MultiPart to declare, e.g. "related","alternative"; default="mixed"'}),"\n",(0,a.jsx)(t.h3,{id:"isalternative",children:"IsAlternative"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property IsAlternative As %Boolean [ Calculated, Deprecated ];\n"})}),"\n",(0,a.jsx)(t.p,{children:"The IsAlternative property is only meaningful for multipart messages (IsMultiPart=1). If IsAlternative=1, then Content-Type: multipart/alternative, otherwise Content-Type: multipart/mixed. IsAlternative is deprecated. Use MultiPartType"}),"\n",(0,a.jsx)(t.h3,{id:"isbinary",children:"IsBinary"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property IsBinary As %Boolean;\n"})}),"\n",(0,a.jsx)(t.p,{children:"If message is NOT multipart, this indicates whether message has text or binary data"}),"\n",(0,a.jsx)(t.h3,{id:"isbase64",children:"IsBase64"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property IsBase64 As %Boolean [ Calculated, Deprecated ];\n"})}),"\n",(0,a.jsxs)(t.p,{children:["If message is NOT multipart, this indicates whether message to be sent will be encoded as Base64 or quoted-printable.",(0,a.jsx)(t.br,{}),'\nWhen sending the message and Is7bit="", the encoding (IsBase64) defaults to 1 if IsBinary, else to 0. IsBase64 is deprecated. Use ContentTransferEncoding.']}),"\n",(0,a.jsx)(t.h3,{id:"is7bit",children:"Is7bit"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property Is7bit As %Boolean [ Calculated, Deprecated ];\n"})}),"\n",(0,a.jsxs)(t.p,{children:["If message is NOT multipart, this indicates whether message to be sent will be treated as a 7bit message that does not need encoding. All body text must already be 7bit data and all lines must < 998 bytes in lenght.",(0,a.jsx)(t.br,{}),"\nWhen sending the message and IsBase64=1, then Is7bit is ignored. Is7bit is deprecated. Use ContentTransferEncoding."]}),"\n",(0,a.jsx)(t.h3,{id:"ishtml",children:"IsHTML"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property IsHTML As %Boolean;\n"})}),"\n",(0,a.jsx)(t.p,{children:"if message is NOT multipart and is text, this indicates whether message is in HTML format"}),"\n",(0,a.jsx)(t.h3,{id:"contenttype",children:"ContentType"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property ContentType As %String(MAXLEN = 1024);\n"})}),"\n",(0,a.jsx)(t.p,{children:'Sets the Content-Type header. If IsBinary, defaults to "application/octet-stream" If \'IsBinary && isHTML, defaults to "text/html" If \'IsBinary && \'isHTML, defaults to "text/plain"'}),"\n",(0,a.jsx)(t.h3,{id:"contenttransferencoding",children:"ContentTransferEncoding"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:'Property ContentTransferEncoding As %String(VALUELIST = ",base64,quoted-printable,7bit,8bit");\n'})}),"\n",(0,a.jsx)(t.p,{children:'Content-Transfer-Encoding header. Can be one of "base64", "quoted-printable", "7bit", "8bit". Default is "base64 if IsBinary is true, toherwise default is "quoted-printable".'}),"\n",(0,a.jsx)(t.h3,{id:"textdata",children:"TextData"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property TextData As %FileCharacterStream;\n"})}),"\n",(0,a.jsx)(t.p,{children:"text data if message is NOT binary and is NOT multipart"}),"\n",(0,a.jsx)(t.h3,{id:"binarydata",children:"BinaryData"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property BinaryData As %FileBinaryStream;\n"})}),"\n",(0,a.jsx)(t.p,{children:"binary data if message is BINARY and is NOT multipart"}),"\n",(0,a.jsx)(t.h3,{id:"parts",children:"Parts"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property Parts As array Of %Net.MailMessagePart;\n"})}),"\n",(0,a.jsx)(t.p,{children:"If IsMultiPart=1 (true), Parts is an array of the parts of a multipart messsage. Normally each of these parts is a %Net.MailMessagePart."}),"\n",(0,a.jsx)(t.p,{children:'However, if ContentType="message/rfc822", then Parts may only have one entry which is a %Net.MailMessage object that represents an attached email message. This attached message may be converted to a %Net.MailMessage object using the GetAttachedEmail method of %Net.POP3.'}),"\n",(0,a.jsx)(t.h3,{id:"dir",children:"Dir"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property Dir As %String(MAXLEN = 4096);\n"})}),"\n",(0,a.jsx)(t.p,{children:"directory for attachments"}),"\n",(0,a.jsx)(t.h3,{id:"filename",children:"FileName"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property FileName As %String(MAXLEN = 4096);\n"})}),"\n",(0,a.jsx)(t.p,{children:"Filename if message is associated with attached file"}),"\n",(0,a.jsx)(t.h3,{id:"inlineattachment",children:"InlineAttachment"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property InlineAttachment As %Boolean;\n"})}),"\n",(0,a.jsx)(t.p,{children:"If Filename specified and InlineAttachment property is true, then attachment will have a content-disposition header with value inline."}),"\n",(0,a.jsx)(t.h3,{id:"headers",children:"Headers"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property Headers As array Of %String(MAXLEN = 4096);\n"})}),"\n",(0,a.jsx)(t.p,{children:"Array of header names and their values. Note that Content-Transfer-Encoding, Content-Type and Content-Disposition are automatically created and should not be included in the Headers array."}),"\n",(0,a.jsx)(t.h3,{id:"charset",children:"Charset"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property Charset As %String;\n"})}),"\n",(0,a.jsx)(t.p,{children:"Then default is utf-8 on Unicode systems and the system default on 8-bit systems."}),"\n",(0,a.jsx)(t.p,{children:"Charset determines the charset of the mail message part. %Net.SMTP and %Net.POP3 handle Charset differently -- see the appropriate class definition."}),"\n",(0,a.jsx)(t.h3,{id:"debug",children:"Debug"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property Debug As %String [ Internal ];\n"})}),"\n",(0,a.jsx)(t.h3,{id:"partindex",children:"PartIndex"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Property PartIndex As %Integer [ Internal ];\n"})}),"\n",(0,a.jsx)(t.p,{children:"Internal part index of this message part."}),"\n",(0,a.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,a.jsx)(t.h3,{id:"isalternativeget",children:"IsAlternativeGet"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method IsAlternativeGet() As %Boolean [ CodeMode = expression ]\n"})}),"\n",(0,a.jsx)(t.h3,{id:"isalternativeset",children:"IsAlternativeSet"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method IsAlternativeSet(value As %Boolean) As %Status\n"})}),"\n",(0,a.jsx)(t.h3,{id:"isbase64get",children:"IsBase64Get"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method IsBase64Get() As %Boolean [ CodeMode = expression ]\n"})}),"\n",(0,a.jsx)(t.h3,{id:"isbase64set",children:"IsBase64Set"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method IsBase64Set(value As %Boolean) As %Status\n"})}),"\n",(0,a.jsx)(t.h3,{id:"is7bitget",children:"Is7bitGet"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method Is7bitGet() As %Boolean [ CodeMode = expression ]\n"})}),"\n",(0,a.jsx)(t.h3,{id:"is7bitset",children:"Is7bitSet"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method Is7bitSet(value As %Boolean) As %Status\n"})}),"\n",(0,a.jsx)(t.h3,{id:"contenttransferencodingset",children:"ContentTransferEncodingSet"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method ContentTransferEncodingSet(value As %String) As %Status\n"})}),"\n",(0,a.jsx)(t.h3,{id:"charsetset",children:"CharsetSet"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method CharsetSet(charset As %String) As %Status\n"})}),"\n",(0,a.jsx)(t.h3,{id:"onnew",children:"%OnNew"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:'Method %OnNew(charset As %String = "") As %Status\n'})}),"\n",(0,a.jsx)(t.h3,{id:"attachfile",children:"AttachFile"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:'Method AttachFile(Dir As %String, File As %String, isBinary As %Boolean = 1, charset As %String = "", ByRef count As %Integer) As %Status\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Attach file to this message as another MIME part. All files are sent as binary attachments by default. However, a text file may be attached by passing the third argument, ",(0,a.jsx)(t.em,{children:"isBinary"}),", as 0. For text files, the ",(0,a.jsx)(t.em,{children:"charset"})," may be passed as the fourth argument.",(0,a.jsx)(t.br,{}),"\nThe position in the Parts array of the message part that holds the file is returned in the ",(0,a.jsx)(t.em,{children:"count"}),' reference argument. This count may be used to set additional characteristics of the file such as Charset, e.g. set msg.Parts.GetAt(count).Charset="iso-8859-1".',(0,a.jsx)(t.br,{}),"\nFor example to send the file as a text file in charset iso-8859-2: ",(0,a.jsx)(t.code,{children:'set status=message.AttachFile("d:\\temp","test.txt",0,"iso-8859-1",.count) if $$$ISERR(status) do handleError .....'})," Note that setting the Charset does not translate the file. Rather it just specifies the charset that already describes the file's data."]}),"\n",(0,a.jsx)(t.h3,{id:"attachstream",children:"AttachStream"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:'Method AttachStream(stream As %Stream.Object, Filename As %String, isBinary As %Boolean = 1, charset As %String = "", ByRef count As %Integer) As %Status\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Attach the contents of a stream to this message as another MIME part. The attachment is considered a file attachment if Filename is specified. Otherwise it is considered an inline attachment. All attachments are sent as binary attachments by default. However, a text attached may be attached by passing the third argument, ",(0,a.jsx)(t.em,{children:"isBinary"}),", as 0. For text attachments, the ",(0,a.jsx)(t.em,{children:"charset"})," may be passed as the fourth argument.",(0,a.jsx)(t.br,{}),"\nThe position in the Parts array of the message part that holds the file is returned in the ",(0,a.jsx)(t.em,{children:"count"}),' reference argument. This count may be used to set additional characteristics of the file such as Charset, e.g. set msg.Parts.GetAt(count).Charset="iso-8859-1".',(0,a.jsx)(t.br,{}),"\nFor example to send the attachememt as a text file in charset iso-8859-2: ",(0,a.jsx)(t.code,{children:'set status=message.AttachFile(myCharacterStream,"test.txt",0,"iso-8859-1",.count) if $$$ISERR(status) do handleError .....'})," Note that setting the Charset does not translate the attachment. Rather it just specifies the charset that already describes the file's data."]}),"\n",(0,a.jsx)(t.h3,{id:"getfilename",children:"GetFileName"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetFileName() As %String [ CodeMode = expression ]\n"})}),"\n",(0,a.jsx)(t.p,{children:"If message is associated with an attached file, get the filename"}),"\n",(0,a.jsx)(t.h3,{id:"attachnewmessage",children:"AttachNewMessage"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method AttachNewMessage() As %Net.MailMessagePart\n"})}),"\n",(0,a.jsx)(t.p,{children:"Attach message to current message. Return oref of attached message, so more things can be attached to the attachment"}),"\n",(0,a.jsx)(t.h3,{id:"attachemail",children:"AttachEmail"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method AttachEmail(mailmsg As %Net.MailMessage)\n"})}),"\n",(0,a.jsx)(t.p,{children:"Attach email message to current message."}),"\n",(0,a.jsx)(t.h3,{id:"getattribute",children:"GetAttribute"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetAttribute(header As %String, name As %String) As %String\n"})}),"\n",(0,a.jsx)(t.p,{children:'Call this method with a header value, for example, "content-disposition" and the name of an attribute, for example, "filename" to obtain the value of the MIME attribute for this message part.'}),"\n",(0,a.jsx)(t.p,{children:"This only works after a message has been received in POP3 not when a message is being composed in SMTP."})]})}function d(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>l});var a=s(96540);const n={},i=a.createContext(n);function r(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);