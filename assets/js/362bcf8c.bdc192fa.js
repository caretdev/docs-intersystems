"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[54900],{44211:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>i,default:()=>c,frontMatter:()=>a,toc:()=>o});var s=n(74848),r=n(28453);const a={pagination_prev:null,pagination_next:null},i="%Net.MIMEPart",o=[{value:"Properties",id:"properties",level:2},{value:"Parts",id:"parts",level:3},{value:"Body",id:"body",level:3},{value:"PartOwnedStream",id:"partownedstream",level:3},{value:"Headers",id:"headers",level:3},{value:"ContentType",id:"contenttype",level:3},{value:"ContentTypeAttributes",id:"contenttypeattributes",level:3},{value:"ContentCharset",id:"contentcharset",level:3},{value:"ContentTransferEncoding",id:"contenttransferencoding",level:3},{value:"ContentLocation",id:"contentlocation",level:3},{value:"ContentId",id:"contentid",level:3},{value:"Boundary",id:"boundary",level:3},{value:"Methods",id:"methods",level:2},{value:"BodySet",id:"bodyset",level:3},{value:"%OnNew",id:"onnew",level:3},{value:"%OnClose",id:"onclose",level:3},{value:"SetHeader",id:"setheader",level:3},{value:"RemoveHeader",id:"removeheader",level:3},{value:"GetHeader",id:"getheader",level:3},{value:"NextHeader",id:"nextheader",level:3},{value:"ClearHeaders",id:"clearheaders",level:3},{value:"ContentTypeGet",id:"contenttypeget",level:3},{value:"ContentTypeSet",id:"contenttypeset",level:3},{value:"ParseContentType",id:"parsecontenttype",level:3},{value:"GetContentTypeAttribute",id:"getcontenttypeattribute",level:3},{value:"ContentCharsetGet",id:"contentcharsetget",level:3},{value:"ContentCharsetSet",id:"contentcharsetset",level:3},{value:"ContentTransferEncodingSet",id:"contenttransferencodingset",level:3},{value:"ContentTransferEncodingGet",id:"contenttransferencodingget",level:3},{value:"ContentLocationSet",id:"contentlocationset",level:3},{value:"ContentIdSet",id:"contentidset",level:3},{value:"BoundaryGet",id:"boundaryget",level:3},{value:"NormalizeContentId",id:"normalizecontentid",level:3},{value:"NormalizeContentLocation",id:"normalizecontentlocation",level:3}];function d(e){const t={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"netmimepart",children:"%Net.MIMEPart"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Class %Net.MIMEPart Extends %RegisteredObject [ System = 4 ]\n"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"For information on using this class"}),", see ",(0,s.jsx)(t.a,{href:"/csp/docbook/DocBook.UI.Page.cls?FIND=CLASSES+%25Net.MIMEPart",children:"MIME Messages"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"%Net.MIMEPart holds a MIME message part."}),"\n",(0,s.jsx)(t.h2,{id:"properties",children:"Properties"}),"\n",(0,s.jsx)(t.h3,{id:"parts",children:"Parts"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Property Parts As list Of %Net.MIMEPart;\n"})}),"\n",(0,s.jsx)(t.p,{children:"Parts of a multipart message. Either Parts must contain MIMEParts or Body must be specified, but not both."}),"\n",(0,s.jsx)(t.h3,{id:"body",children:"Body"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Property Body As %RegisteredObject;\n"})}),"\n",(0,s.jsx)(t.p,{children:"The body of the attachment as a stream. Either Parts must contain MIMEParts or Body must be specified, but not both."}),"\n",(0,s.jsx)(t.h3,{id:"partownedstream",children:"PartOwnedStream"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Property PartOwnedStream As %Boolean;\n"})}),"\n",(0,s.jsx)(t.p,{children:"If PartOwnedStream is true, then the part owns the stream and should cleasr it when the part is deleted."}),"\n",(0,s.jsx)(t.h3,{id:"headers",children:"Headers"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Property Headers As array Of %List [ Internal, Private ];\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The MIME headers for this attachment. The key is the header name in upper case. The stored value is $lb(headerName,headerValue) where",(0,s.jsx)(t.br,{}),"\nheaderName is the user specified header name.",(0,s.jsx)(t.br,{}),"\nheaderValue is the header value stripped of leading and trailing whitespace."]}),"\n",(0,s.jsx)(t.h3,{id:"contenttype",children:"ContentType"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Property ContentType As %String(MAXLEN = "") [ Calculated ];\n'})}),"\n",(0,s.jsx)(t.p,{children:"Sets/gets the 'Content-Type:' MIME header. A Content-Type specifies the media type of the Body data. A Content-Transfer-Encoding header may be used to indicate any additional content coding applied to the type."}),"\n",(0,s.jsx)(t.h3,{id:"contenttypeattributes",children:"ContentTypeAttributes"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Property ContentTypeAttributes As %String [ Internal, MultiDimensional, Private ];\n"})}),"\n",(0,s.jsx)(t.p,{children:"Attributes of Content-Type header stored in multidimensional array."}),"\n",(0,s.jsx)(t.h3,{id:"contentcharset",children:"ContentCharset"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Property ContentCharset As %String(MAXLEN = "") [ Calculated ];\n'})}),"\n",(0,s.jsx)(t.p,{children:"If the ContentType starts with 'text/' then this is the charset to encode the contents with. This is actually specified in the MIME Content-Type header with something like:"}),"\n",(0,s.jsx)(t.p,{children:"Content-Type: text/html; charset=UTF-8"}),"\n",(0,s.jsx)(t.p,{children:"You must set this property after you set the ContentType or it will overwrite this value."}),"\n",(0,s.jsx)(t.h3,{id:"contenttransferencoding",children:"ContentTransferEncoding"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Property ContentTransferEncoding As %String(VALUELIST = ",base64,quoted-printable,7bit,8bit,binary");\n'})}),"\n",(0,s.jsx)(t.p,{children:'Content-Transfer-Encoding header. Can be one of "base64", "quoted-printable", "7bit", "8bit", "binary".'}),"\n",(0,s.jsx)(t.h3,{id:"contentlocation",children:"ContentLocation"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Property ContentLocation As %String(MAXLEN = "");\n'})}),"\n",(0,s.jsx)(t.p,{children:"The normalized content-location. Any leading or trailing whitespace and comments are removed."}),"\n",(0,s.jsx)(t.h3,{id:"contentid",children:"ContentId"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Property ContentId As %String(MAXLEN = "");\n'})}),"\n",(0,s.jsx)(t.p,{children:"The normalized content-id. Any leading or trailing whitespace and enclosing <> are removed."}),"\n",(0,s.jsx)(t.h3,{id:"boundary",children:"Boundary"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Property Boundary As %String(MAXLEN = "");\n'})}),"\n",(0,s.jsx)(t.p,{children:"Boundary to used to separate parts of the message. If none is specified, a default is created."}),"\n",(0,s.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(t.h3,{id:"bodyset",children:"BodySet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method BodySet(body As %CSP.BinaryStream = "") As %Status\n'})}),"\n",(0,s.jsx)(t.p,{children:"Set the body of the attachment to a stream. If the stream contains a Headers attribute, this attribute is used to initialize the headers of the MIME part. The %CSP.BinaryStream that is returned by the CSP engine is an example of such a stream with Headers attribute."}),"\n",(0,s.jsx)(t.h3,{id:"onnew",children:"%OnNew"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'Method %OnNew(body As %CSP.BinaryStream = "") As %Status\n'})}),"\n",(0,s.jsx)(t.p,{children:"Optionally initialize the body (and possibly the headers) during construction."}),"\n",(0,s.jsx)(t.h3,{id:"onclose",children:"%OnClose"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method %OnClose() As %Status [ Private, ServerOnly = 1 ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Make sure stream is Clear'ed when this part is closed"}),"\n",(0,s.jsx)(t.h3,{id:"setheader",children:"SetHeader"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method SetHeader(name As %String, value As %String)\n"})}),"\n",(0,s.jsx)(t.p,{children:"Add a header to the MIME part. The basic Content headers that you may want are covered by properties of this class: Content-Type, Content-Transfer-Encoding, Content-Id and Content-Location."}),"\n",(0,s.jsx)(t.h3,{id:"removeheader",children:"RemoveHeader"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method RemoveHeader(name As %String)\n"})}),"\n",(0,s.jsx)(t.p,{children:"Remove a header to the MIME part."}),"\n",(0,s.jsx)(t.h3,{id:"getheader",children:"GetHeader"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetHeader(name As %String, Output originalName As %String) As %String\n"})}),"\n",(0,s.jsx)(t.p,{children:"Lookup a previously set header. The lookup is not case sensitive. However, the original name is returned."}),"\n",(0,s.jsx)(t.h3,{id:"nextheader",children:"NextHeader"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method NextHeader(name As %String) As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Get the next header based on the upper case key used to store the headers."}),"\n",(0,s.jsx)(t.h3,{id:"clearheaders",children:"ClearHeaders"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method ClearHeaders() As %Status [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Clear the list of headers"}),"\n",(0,s.jsx)(t.h3,{id:"contenttypeget",children:"ContentTypeGet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method ContentTypeGet() As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"contenttypeset",children:"ContentTypeSet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method ContentTypeSet(contenttype As %String) As %Status\n"})}),"\n",(0,s.jsx)(t.h3,{id:"parsecontenttype",children:"ParseContentType"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method ParseContentType(value As %String) [ Internal, Private ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Parse the Content-Type header into its attributes"}),"\n",(0,s.jsx)(t.h3,{id:"getcontenttypeattribute",children:"GetContentTypeAttribute"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method GetContentTypeAttribute(name As %String) [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Return an attribute of a previously stored Content-Type."}),"\n",(0,s.jsx)(t.h3,{id:"contentcharsetget",children:"ContentCharsetGet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method ContentCharsetGet() As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"contentcharsetset",children:"ContentCharsetSet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method ContentCharsetSet(charset As %String) As %Status\n"})}),"\n",(0,s.jsx)(t.h3,{id:"contenttransferencodingset",children:"ContentTransferEncodingSet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method ContentTransferEncodingSet(value As %String) As %Status\n"})}),"\n",(0,s.jsx)(t.h3,{id:"contenttransferencodingget",children:"ContentTransferEncodingGet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method ContentTransferEncodingGet() As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.h3,{id:"contentlocationset",children:"ContentLocationSet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method ContentLocationSet(value As %String) As %Status\n"})}),"\n",(0,s.jsx)(t.h3,{id:"contentidset",children:"ContentIdSet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method ContentIdSet(value As %String) As %Status\n"})}),"\n",(0,s.jsx)(t.h3,{id:"boundaryget",children:"BoundaryGet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Method BoundaryGet() As %String\n"})}),"\n",(0,s.jsx)(t.h3,{id:"normalizecontentid",children:"NormalizeContentId"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod NormalizeContentId(contentId As %String) As %String [ CodeMode = expression ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Strip enclosing <> from Content-Id header. Input must already be stripped of lleading and trailing whitespace"}),"\n",(0,s.jsx)(t.h3,{id:"normalizecontentlocation",children:"NormalizeContentLocation"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod NormalizeContentLocation(contentLocation As %String) As %String\n"})}),"\n",(0,s.jsx)(t.p,{children:"Strip whitespace and comments from the Content-Location header. Input must already be stripped of lleading and trailing whitespace"})]})}function c(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>o});var s=n(96540);const r={},a=s.createContext(r);function i(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);