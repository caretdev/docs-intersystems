"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[4775],{496:(e,s,n)=>{n.r(s),n.d(s,{contentTitle:()=>a,default:()=>d,frontMatter:()=>r,toc:()=>i});var t=n(74848),l=n(28453);const r={pagination_prev:null,pagination_next:null},a="%Library.GlobalStreamAdaptor",i=[{value:"Parameters",id:"parameters",level:2},{value:"STORAGE",id:"storage",level:3},{value:"BUFFERLEN",id:"bufferlen",level:3},{value:"STOREGLOBALNAME",id:"storeglobalname",level:3},{value:"Properties",id:"properties",level:2},{value:"StoreRoot",id:"storeroot",level:3},{value:"rollback",id:"rollback",level:3},{value:"StoreNode",id:"storenode",level:3},{value:"TempNode",id:"tempnode",level:3},{value:"MaxNodeNo",id:"maxnodeno",level:3},{value:"NodeNo",id:"nodeno",level:3},{value:"StoreGlvn",id:"storeglvn",level:3},{value:"TempGlvn",id:"tempglvn",level:3},{value:"Buffer",id:"buffer",level:3},{value:"Position",id:"position",level:3},{value:"IOSize",id:"iosize",level:3},{value:"%LastModified",id:"lastmodified",level:3},{value:"Methods",id:"methods",level:2},{value:"%LocationSet",id:"locationset",level:3},{value:"%LocationGet",id:"locationget",level:3},{value:"StoreGlvnGet",id:"storeglvnget",level:3},{value:"TempGlvnGet",id:"tempglvnget",level:3},{value:"%OnNew",id:"onnew",level:3},{value:"IOInit",id:"ioinit",level:3},{value:"%OnClose",id:"onclose",level:3},{value:"%GetLockReference",id:"getlockreference",level:3},{value:"%LockStream",id:"lockstream",level:3},{value:"Rewind",id:"rewind",level:3},{value:"Flush",id:"flush",level:3},{value:"SizeGet",id:"sizeget",level:3},{value:"IOGetStreamId",id:"iogetstreamid",level:3},{value:"OpenStream",id:"openstream",level:3},{value:"%OnConstructClone",id:"onconstructclone",level:3},{value:"%OnRollBack",id:"onrollback",level:3},{value:"%SaveData",id:"savedata",level:3},{value:"SaveStream",id:"savestream",level:3},{value:"IODeleteStream",id:"iodeletestream",level:3},{value:"Read",id:"read",level:3},{value:"Write",id:"write",level:3},{value:"CheckAtEnd",id:"checkatend",level:3},{value:"ReadIntoBuffer",id:"readintobuffer",level:3},{value:"WriteBuffer",id:"writebuffer",level:3},{value:"MoveToEnd",id:"movetoend",level:3},{value:"CopyFrom",id:"copyfrom",level:3},{value:"OutputToDevice",id:"outputtodevice",level:3},{value:"Clear",id:"clear",level:3},{value:"LastModifiedGet",id:"lastmodifiedget",level:3},{value:"ReadLine",id:"readline",level:3},{value:"ReadLineIntoStream",id:"readlineintostream",level:3},{value:"GlobalFromSid",id:"globalfromsid",level:3},{value:"%NormalizeObject",id:"normalizeobject",level:3},{value:"%ValidateObject",id:"validateobject",level:3},{value:"%Exists",id:"exists",level:3},{value:"%ObjectIsNull",id:"objectisnull",level:3},{value:"StreamOIDIsNull",id:"streamoidisnull",level:3},{value:"%ObjectSizeInternal",id:"objectsizeinternal",level:3},{value:"%LOBPrefetchInternal",id:"lobprefetchinternal",level:3}];function c(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"libraryglobalstreamadaptor",children:"%Library.GlobalStreamAdaptor"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Class %Library.GlobalStreamAdaptor Extends %AbstractStream [ Abstract, System = 2 ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Stream adaptor for streams that store data in global nodes. Not to be used directly."}),"\n",(0,t.jsx)(s.h2,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsx)(s.h3,{id:"storage",children:"STORAGE"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter STORAGE = "GLOBAL";\n'})}),"\n",(0,t.jsx)(s.h3,{id:"bufferlen",children:"BUFFERLEN"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Parameter BUFFERLEN = 163280;\n"})}),"\n",(0,t.jsx)(s.p,{children:"Number of characters that we are storing in each global node"}),"\n",(0,t.jsx)(s.h3,{id:"storeglobalname",children:"STOREGLOBALNAME"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'Parameter STOREGLOBALNAME = "^CacheStream";\n'})}),"\n",(0,t.jsx)(s.p,{children:"Default location: can be overridden at run-time"}),"\n",(0,t.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,t.jsx)(s.h3,{id:"storeroot",children:"StoreRoot"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property StoreRoot As %String(MAXLEN = 5000) [ InitialExpression = {..#STOREGLOBALNAME}, Private ];\n"})}),"\n",(0,t.jsx)(s.p,{children:"Root is Global Location (name and top subscripts)"}),"\n",(0,t.jsx)(s.h3,{id:"rollback",children:"rollback"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property rollback As %String [ MultiDimensional, Private ];\n"})}),"\n",(0,t.jsx)(s.h3,{id:"storenode",children:"StoreNode"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property StoreNode As %String(MAXLEN = 5000) [ Private ];\n"})}),"\n",(0,t.jsx)(s.h3,{id:"tempnode",children:"TempNode"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property TempNode As %String(MAXLEN = 5000) [ Private ];\n"})}),"\n",(0,t.jsx)(s.h3,{id:"maxnodeno",children:"MaxNodeNo"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property MaxNodeNo As %Integer [ InitialExpression = 0, Private, Transient ];\n"})}),"\n",(0,t.jsx)(s.p,{children:"Maximum subscript in data we are reading"}),"\n",(0,t.jsx)(s.h3,{id:"nodeno",children:"NodeNo"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property NodeNo As %String(MAXLEN = 5000) [ InitialExpression = 0, Private ];\n"})}),"\n",(0,t.jsx)(s.p,{children:"The current node we are reading from."}),"\n",(0,t.jsx)(s.h3,{id:"storeglvn",children:"StoreGlvn"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property StoreGlvn As %String(MAXLEN = 5000) [ Calculated, Private ];\n"})}),"\n",(0,t.jsx)(s.p,{children:"StoreGlvn is actual location where data is stored: StoreRoot + StoreNode"}),"\n",(0,t.jsx)(s.h3,{id:"tempglvn",children:"TempGlvn"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property TempGlvn As %String(MAXLEN = 5000) [ Calculated, Private ];\n"})}),"\n",(0,t.jsx)(s.p,{children:"TempGlvn is actual temp location: TEMPGLOBALNAME + TempNode"}),"\n",(0,t.jsx)(s.h3,{id:"buffer",children:"Buffer"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'Property Buffer As %Binary(MAXLEN = "") [ Private ];\n'})}),"\n",(0,t.jsx)(s.h3,{id:"position",children:"Position"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property Position As %Integer [ InitialExpression = 1, Private ];\n"})}),"\n",(0,t.jsx)(s.h3,{id:"iosize",children:"IOSize"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property IOSize As %Integer [ InitialExpression = 0, Private ];\n"})}),"\n",(0,t.jsx)(s.h3,{id:"lastmodified",children:"%LastModified"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Property %LastModified As %String [ Private, Transient ];\n"})}),"\n",(0,t.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(s.h3,{id:"locationset",children:"%LocationSet"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %LocationSet(value As %String) As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"locationget",children:"%LocationGet"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %LocationGet() As %String [ CodeMode = expression ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"storeglvnget",children:"StoreGlvnGet"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method StoreGlvnGet() As %String [ CodeMode = expression, Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"tempglvnget",children:"TempGlvnGet"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method TempGlvnGet() As %String [ CodeMode = expression, Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"onnew",children:"%OnNew"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'Method %OnNew(initval As %String = "") As %Status [ Private ]\n'})}),"\n",(0,t.jsx)(s.h3,{id:"ioinit",children:"IOInit"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method IOInit() [ Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"onclose",children:"%OnClose"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %OnClose() As %Status [ Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"getlockreference",children:"%GetLockReference"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'ClassMethod %GetLockReference(pLocation As %String(MAXLEN="") = "", pId As %String(MAXLEN="") = "") As %String(MAXLEN="") [ Private ]\n'})}),"\n",(0,t.jsx)(s.p,{children:"Returns the global reference used to lock the current stream object Throws %Exception.AbstractException"}),"\n",(0,t.jsx)(s.h3,{id:"lockstream",children:"%LockStream"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %LockStream() [ ProcedureBlock = 1, ServerOnly = 1 ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"%LockStream() Obtain a shared lock on the current stream object. The return value is 1 if the stream was already locked or if it was successfully locked. If the stream cannot be locked the return value is 0. This version of %LockStream differs from %Stream.Object only in the arguments passed to %GetLockReference."}),"\n",(0,t.jsx)(s.h3,{id:"rewind",children:"Rewind"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method Rewind() As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"flush",children:"Flush"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method Flush() As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"sizeget",children:"SizeGet"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method SizeGet() As %Integer [ CodeMode = expression ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Return the current size of the data stream."}),"\n",(0,t.jsx)(s.h3,{id:"iogetstreamid",children:"IOGetStreamId"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method IOGetStreamId() As %String [ CodeMode = expression, Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"openstream",children:"OpenStream"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method OpenStream(sid As %String) As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"onconstructclone",children:"%OnConstructClone"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %OnConstructClone(object As %RegisteredObject, deep As %Boolean = 0, ByRef cloned As %String) As %Status [ Private, ProcedureBlock = 1 ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"onrollback",children:"%OnRollBack"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %OnRollBack() As %Status [ Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"savedata",children:"%SaveData"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %SaveData(ByRef sid As %String) As %Status [ Private, ProcedureBlock = 1 ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"savestream",children:"SaveStream"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method SaveStream() As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"iodeletestream",children:"IODeleteStream"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod IODeleteStream(sid As %String, concurrency As %Integer = 0) As %Status [ Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"read",children:"Read"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method Read(ByRef len As %Integer, ByRef sc As %Status) As %RawString\n"})}),"\n",(0,t.jsx)(s.h3,{id:"write",children:"Write"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:'Method Write(data As %RawString = "") As %Status\n'})}),"\n",(0,t.jsx)(s.h3,{id:"checkatend",children:"CheckAtEnd"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method CheckAtEnd() [ Private ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Check if we are at the end of the global, but do not read the next buffer"}),"\n",(0,t.jsx)(s.h3,{id:"readintobuffer",children:"ReadIntoBuffer"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method ReadIntoBuffer() As %Boolean [ Private ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Reads the next node into Buffer."}),"\n",(0,t.jsx)(s.p,{children:"Returns 0 if there is no more data."}),"\n",(0,t.jsx)(s.h3,{id:"writebuffer",children:"WriteBuffer"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method WriteBuffer() As %Status [ Private ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"movetoend",children:"MoveToEnd"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method MoveToEnd() As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"copyfrom",children:"CopyFrom"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method CopyFrom(source As %AbstractStream) As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"outputtodevice",children:"OutputToDevice"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method OutputToDevice(ByRef len As %Integer = -1) As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"clear",children:"Clear"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method Clear(permanent As %Boolean = 1) As %Status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"lastmodifiedget",children:"LastModifiedGet"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method LastModifiedGet() As %TimeStamp [ CodeMode = expression ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"readline",children:"ReadLine"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method ReadLine(ByRef len As %Integer = 32656, ByRef sc As %Status, ByRef eol As %Boolean) As %RawString\n"})}),"\n",(0,t.jsx)(s.h3,{id:"readlineintostream",children:"ReadLineIntoStream"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method ReadLineIntoStream() As %AbstractStream\n"})}),"\n",(0,t.jsx)(s.p,{children:"This reads from the stream until it find the LineTerminator and returns this as a stream. If the stream does not contain the line terminator this can potentially be the entire stream."}),"\n",(0,t.jsx)(s.h3,{id:"globalfromsid",children:"GlobalFromSid"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GlobalFromSid(sid As %String) As %String\n"})}),"\n",(0,t.jsx)(s.p,{children:"Given a stream id this returns the root global node where this stream is stored"}),"\n",(0,t.jsx)(s.h3,{id:"normalizeobject",children:"%NormalizeObject"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %NormalizeObject() As %Status [ CodeMode = expression ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"validateobject",children:"%ValidateObject"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"Method %ValidateObject(force As %Integer = 0) As %Status [ CodeMode = expression ]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"exists",children:"%Exists"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod %Exists(soid As %ObjectIdentity) As %Boolean\n"})}),"\n",(0,t.jsx)(s.h3,{id:"objectisnull",children:"%ObjectIsNull"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod %ObjectIsNull(soid As %ObjectIdentity) As %Boolean\n"})}),"\n",(0,t.jsx)(s.p,{children:"Return true if this stream oid is a null stream and false if the stream is not null"}),"\n",(0,t.jsx)(s.h3,{id:"streamoidisnull",children:"StreamOIDIsNull"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod StreamOIDIsNull(soid As %ObjectIdentity) As %Boolean [ CodeMode = call ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Return true if this stream oid is a null stream and false if the stream is not null"}),"\n",(0,t.jsx)(s.h3,{id:"objectsizeinternal",children:"%ObjectSizeInternal"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod %ObjectSizeInternal(soid As %ObjectIdentity) As %Integer [ Private ]\n"})}),"\n",(0,t.jsx)(s.p,{children:"Return the size of the stream pointed to by soid"}),"\n",(0,t.jsx)(s.h3,{id:"lobprefetchinternal",children:"%LOBPrefetchInternal"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod %LOBPrefetchInternal(soid As %ObjectIdentity, prefetchsize As %Integer, ByRef data As %String) As %Integer [ Private ]\n"})})]})}function d(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>i});var t=n(96540);const l={},r=t.createContext(l);function a(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);