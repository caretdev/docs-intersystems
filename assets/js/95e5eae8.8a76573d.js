"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[23018],{82589:(e,s,r)=>{r.r(s),r.d(s,{contentTitle:()=>o,default:()=>c,frontMatter:()=>i,toc:()=>l});var n=r(74848),t=r(28453);const i={pagination_prev:null,pagination_next:null},o="%CSP.UserAgent",l=[{value:"Properties",id:"properties",level:2},{value:"UserAgent",id:"useragent",level:3},{value:"SupportsXMLHttpRequest",id:"supportsxmlhttprequest",level:3},{value:"Browser",id:"browser",level:3},{value:"Platform",id:"platform",level:3},{value:"Version",id:"version",level:3},{value:"Methods",id:"methods",level:2},{value:"%OnNew",id:"onnew",level:3},{value:"UserAgentSet",id:"useragentset",level:3},{value:"XMLHttpRequest",id:"xmlhttprequest",level:3},{value:"GetVersion",id:"getversion",level:3}];function a(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"cspuseragent",children:"%CSP.UserAgent"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Class %CSP.UserAgent Extends %RegisteredObject [ System = 4 ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Determine browser parameters from HTTP_USER_AGENT CGI variable."}),"\n",(0,n.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,n.jsx)(s.h3,{id:"useragent",children:"UserAgent"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property UserAgent As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"User agent for this class."}),"\n",(0,n.jsx)(s.h3,{id:"supportsxmlhttprequest",children:"SupportsXMLHttpRequest"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property SupportsXMLHttpRequest As %Boolean;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Supports XMLHttpRequest."}),"\n",(0,n.jsx)(s.h3,{id:"browser",children:"Browser"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property Browser As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Browser name"}),"\n",(0,n.jsx)(s.h3,{id:"platform",children:"Platform"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property Platform As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Browser platform"}),"\n",(0,n.jsx)(s.h3,{id:"version",children:"Version"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Property Version As %String;\n"})}),"\n",(0,n.jsx)(s.p,{children:"Browser version"}),"\n",(0,n.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(s.h3,{id:"onnew",children:"%OnNew"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method %OnNew(userAgent As %String) As %Status\n"})}),"\n",(0,n.jsx)(s.p,{children:"Initialize with HTTP_USER_AGENT."}),"\n",(0,n.jsx)(s.h3,{id:"useragentset",children:"UserAgentSet"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"Method UserAgentSet(value As %String) As %Status [ Internal ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Set method for UserAgent property"}),"\n",(0,n.jsx)(s.h3,{id:"xmlhttprequest",children:"XMLHttpRequest"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod XMLHttpRequest(userAgent As %String, ByRef browser As %String, ByRef platform As %String, ByRef version As %String) As %Boolean\n"})}),"\n",(0,n.jsx)(s.p,{children:"XMLHttpRequest returns true if XMLHttpRequest object is supported by the browser indicated by the userAgent. Current implementation parses User Agents beginning with:"}),"\n",(0,n.jsx)(s.p,{children:'| Opera/ | Browser type is Opera. The version must be greater than or equal to 7.60. |  | Mozilla/5.0 ( | If the User Agent contains "Safari/", the browser type is Safari. The version number must be greater 119.0. Otherwise the platform type must be one of Windows, Macintosh, or X11 and the User Agent must contain "Gecko/". Otherwise User Agent must contain "rv:". The browser type is Mozilla and the version must be greater than 1.3. Camino version 5-- plus browsers listed in exclude-list are not supported. |\n| ------ | ------------------------------------------------------------------------- |  | ------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |'}),"\n",(0,n.jsx)(s.h3,{id:"getversion",children:"GetVersion"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-objectscript-class",children:"ClassMethod GetVersion(version As %String, pos As %Integer, ByRef major As %String, ByRef minor As %String) [ Internal ]\n"})}),"\n",(0,n.jsx)(s.p,{children:"Extract version information from specified start position as major.minor"})]})}function c(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},28453:(e,s,r)=>{r.d(s,{R:()=>o,x:()=>l});var n=r(96540);const t={},i=n.createContext(t);function o(e){const s=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);