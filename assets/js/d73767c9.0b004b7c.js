"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[14555],{54070:(e,n,t)=>{t.r(n),t.d(n,{contentTitle:()=>i,default:()=>r,frontMatter:()=>c,toc:()=>l});var s=t(74848),a=t(28453);const c={pagination_prev:null,pagination_next:null},i="%XDBC.Gateway.ODBC.Connection",l=[{value:"Properties",id:"properties",level:2},{value:"gateway",id:"gateway",level:3},{value:"enviroment",id:"enviroment",level:3},{value:"connection",id:"connection",level:3},{value:"Methods",id:"methods",level:2},{value:"InitEnvironment",id:"initenvironment",level:3},{value:"GetODBCConnection",id:"getodbcconnection",level:3},{value:"Commit",id:"commit",level:3},{value:"Close",id:"close",level:3},{value:"Rollback",id:"rollback",level:3},{value:"SetAutoCommit",id:"setautocommit",level:3},{value:"GetAutoCommit",id:"getautocommit",level:3},{value:"CreateStatement",id:"createstatement",level:3},{value:"GetTransactionIsolation",id:"gettransactionisolation",level:3},{value:"SetTransactionIsolation",id:"settransactionisolation",level:3},{value:"IsReadOnly",id:"isreadonly",level:3},{value:"SetReadOnly",id:"setreadonly",level:3},{value:"PrepareCall",id:"preparecall",level:3},{value:"PrepareStatement",id:"preparestatement",level:3},{value:"GetInfo",id:"getinfo",level:3},{value:"GetConnectionAttribute",id:"getconnectionattribute",level:3},{value:"SetAttribute",id:"setattribute",level:3},{value:"GetTables",id:"gettables",level:3},{value:"GetTablePriviligies",id:"gettablepriviligies",level:3},{value:"IsClosed",id:"isclosed",level:3},{value:"IsValid",id:"isvalid",level:3},{value:"GetMetaData",id:"getmetadata",level:3},{value:"GetSchema",id:"getschema",level:3},{value:"SetSchema",id:"setschema",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"xdbcgatewayodbcconnection",children:"%XDBC.Gateway.ODBC.Connection"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Class %XDBC.Gateway.ODBC.Connection Extends %XDBC.Gateway.Connection [ System = 4 ]\n"})}),"\n",(0,s.jsx)(n.p,{children:"FOR INTERNAL USE - do not invoke directly"}),"\n",(0,s.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,s.jsx)(n.h3,{id:"gateway",children:"gateway"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property gateway As %ObjectHandle;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"enviroment",children:"enviroment"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property enviroment As %ObjectHandle;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"connection",children:"connection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Property connection As %ObjectHandle;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(n.h3,{id:"initenvironment",children:"InitEnvironment"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod InitEnvironment() As %ObjectHandle\n"})}),"\n",(0,s.jsx)(n.h3,{id:"getodbcconnection",children:"GetODBCConnection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod GetODBCConnection(connectionInfo As %Library.DynamicObject) As %XDBC.Gateway.ODBC.Connection\n"})}),"\n",(0,s.jsx)(n.h3,{id:"commit",children:"Commit"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method Commit()\n"})}),"\n",(0,s.jsx)(n.p,{children:"Makes all changes made since the previous commit/rollback permanent and releases any database locks currently held by this Connection object"}),"\n",(0,s.jsx)(n.h3,{id:"close",children:"Close"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method Close()\n"})}),"\n",(0,s.jsx)(n.p,{children:"Call Close (ODBC Disconnect) on connection"}),"\n",(0,s.jsx)(n.h3,{id:"rollback",children:"Rollback"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method Rollback()\n"})}),"\n",(0,s.jsx)(n.p,{children:"Undoes all changes made in the current transaction and releases any database locks currently held by this Connection object"}),"\n",(0,s.jsx)(n.h3,{id:"setautocommit",children:"SetAutoCommit"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method SetAutoCommit(autoCommit As %Boolean)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Sets this connection's auto-commit mode to the given state"}),"\n",(0,s.jsx)(n.h3,{id:"getautocommit",children:"GetAutoCommit"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetAutoCommit() As %Boolean\n"})}),"\n",(0,s.jsx)(n.p,{children:"Retrieves the current auto-commit mode for this Connection object"}),"\n",(0,s.jsx)(n.h3,{id:"createstatement",children:"CreateStatement"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method CreateStatement() As Statement\n"})}),"\n",(0,s.jsx)(n.p,{children:"Creates a Statement object for sending SQL statements to the database"}),"\n",(0,s.jsx)(n.h3,{id:"gettransactionisolation",children:"GetTransactionIsolation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetTransactionIsolation() As %Integer\n"})}),"\n",(0,s.jsx)(n.p,{children:"Retrieves this Connection object's current transaction isolation level"}),"\n",(0,s.jsx)(n.h3,{id:"settransactionisolation",children:"SetTransactionIsolation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method SetTransactionIsolation(level As %Integer)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Attempts to change the transaction isolation level for this Connection object to the one given level is 1, 2, 4 (Connection.TRANSACTION_REPEATABLE_READ) or 8 (Connection.TRANSACTION_SERIALIZABLE)"}),"\n",(0,s.jsx)(n.h3,{id:"isreadonly",children:"IsReadOnly"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method IsReadOnly() As %Boolean\n"})}),"\n",(0,s.jsx)(n.p,{children:"Retrieves whether this Connection object is in read-only mode"}),"\n",(0,s.jsx)(n.h3,{id:"setreadonly",children:"SetReadOnly"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method SetReadOnly(readOnly As %Boolean)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Puts this connection in read-only mode as a hint to the driver to enable database optimizations"}),"\n",(0,s.jsx)(n.h3,{id:"preparecall",children:"PrepareCall"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method PrepareCall(sql As %String) As Statement\n"})}),"\n",(0,s.jsx)(n.p,{children:"Creates a Statement object for calling stored procedures"}),"\n",(0,s.jsx)(n.h3,{id:"preparestatement",children:"PrepareStatement"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method PrepareStatement(sql As %String) As Statement\n"})}),"\n",(0,s.jsx)(n.p,{children:"Creates a statement object for sending parameterized SQL statements to the database"}),"\n",(0,s.jsx)(n.h3,{id:"getinfo",children:"GetInfo"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetInfo(Type As %Integer) As %String\n"})}),"\n",(0,s.jsx)(n.p,{children:"Get connection information specifyed by Type"}),"\n",(0,s.jsx)(n.h3,{id:"getconnectionattribute",children:"GetConnectionAttribute"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetConnectionAttribute(Attribute As %Integer, IsInteger As %Boolean) As %String\n"})}),"\n",(0,s.jsx)(n.h3,{id:"setattribute",children:"SetAttribute"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method SetAttribute(Attribute As %Integer, Value As %String, IsInteger As %Boolean) As %Status\n"})}),"\n",(0,s.jsx)(n.h3,{id:"gettables",children:"GetTables"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetTables(Catalog As %String, Schema As %String, Table As %String) As ResultSet\n"})}),"\n",(0,s.jsx)(n.h3,{id:"gettablepriviligies",children:"GetTablePriviligies"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetTablePriviligies(Schema As %String, Table As %String) As ResultSet\n"})}),"\n",(0,s.jsx)(n.h3,{id:"isclosed",children:"IsClosed"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method IsClosed() As %Boolean\n"})}),"\n",(0,s.jsx)(n.p,{children:"Retrieves whether this Connection object has been closed"}),"\n",(0,s.jsx)(n.h3,{id:"isvalid",children:"IsValid"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method IsValid(timeout As %Integer = 0) As %Boolean\n"})}),"\n",(0,s.jsx)(n.p,{children:"Returns true if the connection has not been closed and is still valid"}),"\n",(0,s.jsx)(n.h3,{id:"getmetadata",children:"GetMetaData"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetMetaData() As %XDBC.Gateway.ODBC.DatabaseMetaData\n"})}),"\n",(0,s.jsx)(n.p,{children:"Retrieves a DatabaseMetaData object that contains metadata about the database to which this Connection object represents a connection"}),"\n",(0,s.jsx)(n.h3,{id:"getschema",children:"GetSchema"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetSchema() As %String\n"})}),"\n",(0,s.jsx)(n.p,{children:"Retrieves this Connection object's current schema name"}),"\n",(0,s.jsx)(n.h3,{id:"setschema",children:"SetSchema"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-objectscript-class",children:"Method SetSchema(schema As %String)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Sets the given schema name to access"})]})}function r(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var s=t(96540);const a={},c=s.createContext(a);function i(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);