"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[97201],{63938:(e,n,s)=>{s.r(n),s.d(n,{contentTitle:()=>a,default:()=>o,frontMatter:()=>i,toc:()=>l});var r=s(74848),t=s(28453);const i={pagination_prev:null,pagination_next:null},a="%DeepSee.Diagnostic.MDXUtils",l=[{value:"Parameters",id:"parameters",level:2},{value:"VERSION",id:"version",level:3},{value:"UTILNAME",id:"utilname",level:3},{value:"Properties",id:"properties",level:2},{value:"Query",id:"query",level:3},{value:"ResultsCached",id:"resultscached",level:3},{value:"ResultsUncached",id:"resultsuncached",level:3},{value:"lastPrep",id:"lastprep",level:3},{value:"pJob",id:"pjob",level:3},{value:"pTime",id:"ptime",level:3},{value:"UseCache",id:"usecache",level:3},{value:"BaseDir",id:"basedir",level:3},{value:"StartTimes",id:"starttimes",level:3},{value:"CubeGroup",id:"cubegroup",level:3},{value:"Verbose",id:"verbose",level:3},{value:"TrackingOn",id:"trackingon",level:3},{value:"Methods",id:"methods",level:2},{value:"Version",id:"version-1",level:3},{value:"%Run",id:"run",level:3},{value:"Analyze",id:"analyze",level:3},{value:"%Prep",id:"prep",level:3},{value:"%Exec",id:"exec",level:3},{value:"PrintQueryStats",id:"printquerystats",level:3},{value:"PrintCubeStats",id:"printcubestats",level:3},{value:"ExportDefinitions",id:"exportdefinitions",level:3},{value:"FindSelectivity",id:"findselectivity",level:3},{value:"PrintPlan",id:"printplan",level:3},{value:"StartPerf",id:"startperf",level:3},{value:"InitPerf",id:"initperf",level:3},{value:"WaitPerfStop",id:"waitperfstop",level:3},{value:"SetBaseDir",id:"setbasedir",level:3},{value:"PrintDependencies",id:"printdependencies",level:3},{value:"PrintAgentMetrics",id:"printagentmetrics",level:3},{value:"RunSystemPerformance",id:"runsystemperformance",level:3},{value:"GetQueryCubeGroup",id:"getquerycubegroup",level:3},{value:"%ClearHistory",id:"clearhistory",level:3},{value:"ToHTML",id:"tohtml",level:3},{value:"%OnNew",id:"onnew",level:3}];function c(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"deepseediagnosticmdxutils",children:"%DeepSee.Diagnostic.MDXUtils"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Class %DeepSee.Diagnostic.MDXUtils Extends (%XML.Adaptor, %ZEN.DataModel.Adaptor) [ System = 4 ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"This class provides an API for analyzing MDX queries and generating report data. This class is intended for diagnostic purposes only. There is no guarantee made about either the behavior or future operation of this class. Production applications should not make direct use of these APIs."}),"\n",(0,r.jsxs)(n.p,{children:["Files generated are as follows:",(0,r.jsx)(n.br,{}),"\n- A general statistics report,",(0,r.jsx)(n.br,{}),"\n- PERFMON samples from running the query both uncached and cached,",(0,r.jsx)(n.br,{}),"\n- An export of the cube class and fact table. If this cube is a member of a relationship group, all related cube classes will also be exported."]}),"\n",(0,r.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(n.h3,{id:"version",children:"VERSION"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'Parameter VERSION [ Internal ] = "2.1 (January 10, 2014)";\n'})}),"\n",(0,r.jsx)(n.h3,{id:"utilname",children:"UTILNAME"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'Parameter UTILNAME [ Internal ] = "MDX Query Performance Analyzer";\n'})}),"\n",(0,r.jsx)(n.h2,{id:"properties",children:"Properties"}),"\n",(0,r.jsx)(n.h3,{id:"query",children:"Query"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property Query As %DeepSee.Datatype.string;\n"})}),"\n",(0,r.jsx)(n.p,{children:"MDX Query being analyzed."}),"\n",(0,r.jsx)(n.h3,{id:"resultscached",children:"ResultsCached"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property ResultsCached As %DeepSee.ResultSet;\n"})}),"\n",(0,r.jsx)(n.p,{children:"DeepSee ResultSet from cached query preparartion (contains statistics)."}),"\n",(0,r.jsx)(n.h3,{id:"resultsuncached",children:"ResultsUncached"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property ResultsUncached As %DeepSee.ResultSet;\n"})}),"\n",(0,r.jsx)(n.p,{children:"DeepSee ResultSet from uncached query preparation (contains statistics)."}),"\n",(0,r.jsx)(n.h3,{id:"lastprep",children:"lastPrep"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property lastPrep As %Integer [ InitialExpression = -1, Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Last MDX result set prepared (cached / uncached)"}),"\n",(0,r.jsx)(n.h3,{id:"pjob",children:"pJob"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property pJob As %Integer [ InitialExpression = 0, Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"PID of current PERFMON background check."}),"\n",(0,r.jsx)(n.h3,{id:"ptime",children:"pTime"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property pTime As %Integer [ InitialExpression = 0, Internal ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Collection period of current PERFMON background check."}),"\n",(0,r.jsx)(n.h3,{id:"usecache",children:"UseCache"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property UseCache As %Boolean;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Use cache for statistics - set by %Prep method."}),"\n",(0,r.jsx)(n.h3,{id:"basedir",children:"BaseDir"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property BaseDir As %String;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Base directory for analysis output; defaults to install directory."}),"\n",(0,r.jsx)(n.h3,{id:"starttimes",children:"StartTimes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property StartTimes As array Of %Numeric;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Holds the start times of the query execution and the start of %Run"}),"\n",(0,r.jsx)(n.h3,{id:"cubegroup",children:"CubeGroup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property CubeGroup As %String [ MultiDimensional ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"This property contains the ordered list of cubes that have some logical relation to the cube currently being queried. The list is ordered from least dependent to most independent."}),"\n",(0,r.jsx)(n.h3,{id:"verbose",children:"Verbose"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property Verbose As %Boolean [ InitialExpression = 0 ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Controls whether or not status updates should be output to the current device."}),"\n",(0,r.jsx)(n.h3,{id:"trackingon",children:"TrackingOn"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Property TrackingOn As %Boolean [ InitialExpression = 0 ];\n"})}),"\n",(0,r.jsx)(n.p,{children:"Used to trigger communication to the UI via the ^DeepSee.MDXUtils global"}),"\n",(0,r.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,r.jsx)(n.h3,{id:"version-1",children:"Version"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod Version() As %Status\n"})}),"\n",(0,r.jsx)(n.p,{children:"Prints the current version to the screen"}),"\n",(0,r.jsx)(n.h3,{id:"run",children:"%Run"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod %Run(pMDX As %String = "", pBaseDir As %String = "", pVerbose As %Boolean = 0, ByRef pParms = "", Output pOutFile = "") As %Status\n'})}),"\n",(0,r.jsxs)(n.p,{children:["This method is used for analysis of an MDX query. This runs the query two times; once uncached and once cached. During each of these a PERFMON report will be generated and saved to the destination folder. This utility will also collect and save general query statistics, as well as export the Cube and Fact table definitions.",(0,r.jsx)(n.br,{}),"\npMDX - The MDX query to be analyzed",(0,r.jsx)(n.br,{}),"\npBaseDir - The base directory for storing the output folder. This is set to the instance installation directory by default.",(0,r.jsx)(n.br,{}),"\npVerbose - If true, the analysis will print the long-form output to the current device. Setting pVerbose = 0 will run the analysis completely silently."]}),"\n",(0,r.jsxs)(n.p,{children:["There are other options that may be turned on via the pParms array:",(0,r.jsx)(n.br,{}),'\npParms("CubeStatsOn") = 1',(0,r.jsx)(n.br,{}),'\npParms("TimePERFMON") = 15',(0,r.jsx)(n.br,{}),'\npParms("SystemPerformanceOn") = 0',(0,r.jsx)(n.br,{}),'\npParms("SystemPerformanceProfile") = ""',(0,r.jsx)(n.br,{}),'\npParms("UnattendedOn") = 1',(0,r.jsx)(n.br,{}),'\n"On" in flag name denotes it is treated as a boolean, "Time" denotes it accepts a positive integer argument, in seconds.']}),"\n",(0,r.jsx)(n.h3,{id:"analyze",children:"Analyze"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method Analyze(pMDX As %String, pOutFile As %String, pPerfTime As %Integer = 0, pUseCache As %Boolean = 0) As %Status [ Internal ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Run MDX query analysis.",(0,r.jsx)(n.br,{}),"\npMDX - (mandatory) MDX Query to run.",(0,r.jsx)(n.br,{}),"\noutFile - (mandatory) Output file for PERFMON statistics.",(0,r.jsx)(n.br,{}),"\nperfTime - PERFMON collection period; any non-zero value will run PERFMON.",(0,r.jsx)(n.br,{}),"\nUseCache - Use cache for query run (default false)."]}),"\n",(0,r.jsx)(n.h3,{id:"prep",children:"%Prep"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'Method %Prep(pMDX As %String = "", pUseCache As %Boolean = 1) As %Status [ Internal ]\n'})}),"\n",(0,r.jsx)(n.p,{children:"Prepare MDX query for execution and set internal variables accordingly."}),"\n",(0,r.jsx)(n.h3,{id:"exec",children:"%Exec"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method %Exec() As %Status [ Internal ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Execute prepared MDX query; store results accordingly."}),"\n",(0,r.jsx)(n.h3,{id:"printquerystats",children:"PrintQueryStats"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method PrintQueryStats() [ Internal ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Intended for use in report printing only.",(0,r.jsx)(n.br,{}),"\nPrint statistics of last analyzed query; includes ResultSet statistics."]}),"\n",(0,r.jsx)(n.h3,{id:"printcubestats",children:"PrintCubeStats"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method PrintCubeStats(pVerbose As %Boolean = 1) [ Internal ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Intended for use in report printing only.",(0,r.jsx)(n.br,{}),"\nCube Analyze output (to show indices cardinality)"]}),"\n",(0,r.jsx)(n.h3,{id:"exportdefinitions",children:"ExportDefinitions"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method ExportDefinitions(pCubeFileName) As %Status [ Internal ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Export Cube class and Cube fact class to single XML file."}),"\n",(0,r.jsx)(n.h3,{id:"findselectivity",children:"FindSelectivity"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method FindSelectivity() [ Internal ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Unimplemented."}),"\n",(0,r.jsx)(n.h3,{id:"printplan",children:"PrintPlan"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method PrintPlan() [ Internal ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Intended for use in report printing only.",(0,r.jsx)(n.br,{}),"\nPinting method for the query plan"]}),"\n",(0,r.jsx)(n.h3,{id:"startperf",children:"StartPerf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod StartPerf(pFile As %String = "", pTime As %Integer = 15) [ Internal ]\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Start background PERFMON process; this must be JOBbed off,",(0,r.jsx)(n.br,{}),"\nand should only be done through the InitPerf() method."]}),"\n",(0,r.jsx)(n.h3,{id:"initperf",children:"InitPerf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'Method InitPerf(pFile As %String = "", pTime As %Integer = 15) As %Status [ Internal ]\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Starts PERFMON background process from %Run() context.",(0,r.jsx)(n.br,{}),"\nThis will also affect the ..pJob Property, and a subsequent",(0,r.jsx)(n.br,{}),"\ncall to WaitPerfStop will expect to deal with that PID.",(0,r.jsx)(n.br,{}),"\nThe ..pTime property will also be adjusted to wait an",(0,r.jsx)(n.br,{}),"\nappropriate amount of time for the last PERFMON run to complete."]}),"\n",(0,r.jsx)(n.h3,{id:"waitperfstop",children:"WaitPerfStop"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method WaitPerfStop() As %Status [ Internal ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Wait for current PERFMON to stop; the information regarding that",(0,r.jsx)(n.br,{}),"\nprocess' PID and run period will have been set by a successful",(0,r.jsx)(n.br,{}),"\nInitPerf() earlier.",(0,r.jsx)(n.br,{}),"\nLowest timeout threshold is 30 seconds."]}),"\n",(0,r.jsx)(n.h3,{id:"setbasedir",children:"SetBaseDir"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'Method SetBaseDir(pBaseDir As %String = "", pVerbose As %Boolean = 0, pUnattended = 1) As %Status [ Internal ]\n'})}),"\n",(0,r.jsx)(n.p,{children:"Determine the path where the collection data will be stored"}),"\n",(0,r.jsx)(n.h3,{id:"printdependencies",children:"PrintDependencies"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method PrintDependencies() As %Status [ Internal ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Intended for use in report printing only.",(0,r.jsx)(n.br,{}),"\nPrint the dependencies for the cube class and the the DeepSee model"]}),"\n",(0,r.jsx)(n.h3,{id:"printagentmetrics",children:"PrintAgentMetrics"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method PrintAgentMetrics() As %Status [ Internal ]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Intended for use in report printing only.",(0,r.jsx)(n.br,{}),"\n- NOT IMPLEMENTED -"]}),"\n",(0,r.jsx)(n.h3,{id:"runsystemperformance",children:"RunSystemPerformance"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'ClassMethod RunSystemPerformance(pDir, pProfile = "1min") As %Status [ Internal ]\n'})}),"\n",(0,r.jsx)(n.p,{children:"Switches to the %SYS namespace to run SystemPerformance.  Best jobbed off?"}),"\n",(0,r.jsx)(n.h3,{id:"getquerycubegroup",children:"GetQueryCubeGroup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method GetQueryCubeGroup(pCube) As %Status [ Internal ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Find the logical group that this cube belongs to. Information about the group as a whole is needed."}),"\n",(0,r.jsx)(n.h3,{id:"clearhistory",children:"%ClearHistory"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"ClassMethod %ClearHistory() As %Status\n"})}),"\n",(0,r.jsx)(n.p,{children:"Clear the execution history from the logging global. This will not affect any of the diagnostic reports."}),"\n",(0,r.jsx)(n.h3,{id:"tohtml",children:"ToHTML"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:"Method ToHTML(ByRef pFileName As %String, pCubeStats As %Boolean, pStatus As %Status = 1) As %Status [ Internal ]\n"})}),"\n",(0,r.jsx)(n.p,{children:"Genenrate MDX Analysis as HTML file."}),"\n",(0,r.jsx)(n.h3,{id:"onnew",children:"%OnNew"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-objectscript-class",children:'Method %OnNew(pMDX As %String = "") As %Status [ Internal ]\n'})})]})}function o(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var r=s(96540);const t={},i=r.createContext(t);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);