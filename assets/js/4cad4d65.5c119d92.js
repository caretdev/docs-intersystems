"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[27516],{73463:(e,r,n)=>{n.r(r),n.d(r,{contentTitle:()=>o,default:()=>d,frontMatter:()=>i,toc:()=>l});var t=n(74848),s=n(28453);const i={pagination_prev:null,pagination_next:null},o="%SQL.Import.Mgr",l=[{value:"Parameters",id:"parameters",level:2},{value:"RTNPREFIX",id:"rtnprefix",level:3},{value:"Properties",id:"properties",level:2},{value:"DeferIndices",id:"deferindices",level:3},{value:"UseTransaction",id:"usetransaction",level:3},{value:"IndexPending",id:"indexpending",level:3},{value:"Methods",id:"methods",level:2},{value:"Reset",id:"reset",level:3},{value:"AllocateRoutine",id:"allocateroutine",level:3},{value:"GenerateImportRoutine",id:"generateimportroutine",level:3},{value:"DeleteImportRoutine",id:"deleteimportroutine",level:3},{value:"FileSize",id:"filesize",level:3},{value:"ErrorCount",id:"errorcount",level:3},{value:"Import",id:"import",level:3},{value:"OpenImport",id:"openimport",level:3},{value:"ImportRows",id:"importrows",level:3},{value:"BuildIndices",id:"buildindices",level:3},{value:"ReadHeader",id:"readheader",level:3},{value:"CloseImport",id:"closeimport",level:3},{value:"ErrorLogExecute",id:"errorlogexecute",level:3},{value:"ErrorLogClose",id:"errorlogclose",level:3},{value:"ErrorLogFetch",id:"errorlogfetch",level:3}];function c(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"sqlimportmgr",children:"%SQL.Import.Mgr"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Class %SQL.Import.Mgr Extends (%RegisteredObject, %SQL.ExImData) [ Inheritance = right, Not ProcedureBlock, System = 3 ]\n"})}),"\n",(0,t.jsx)(r.p,{children:"Import Controller for SQL Import."}),"\n",(0,t.jsx)(r.h2,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsx)(r.h3,{id:"rtnprefix",children:"RTNPREFIX"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:'Parameter RTNPREFIX = "SQLImport";\n'})}),"\n",(0,t.jsx)(r.h2,{id:"properties",children:"Properties"}),"\n",(0,t.jsx)(r.h3,{id:"deferindices",children:"DeferIndices"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Property DeferIndices As %Integer [ InitialExpression = 1 ];\n"})}),"\n",(0,t.jsx)(r.p,{children:"If true, generate indices after importing data using %SortBegin/%SortEnd."}),"\n",(0,t.jsx)(r.h3,{id:"usetransaction",children:"UseTransaction"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Property UseTransaction As %Integer [ InitialExpression = 0 ];\n"})}),"\n",(0,t.jsx)(r.p,{children:"If true, nest the entire import operation in a transaction."}),"\n",(0,t.jsx)(r.p,{children:"NOT IMPLEMENTED."}),"\n",(0,t.jsx)(r.h3,{id:"indexpending",children:"IndexPending"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Property IndexPending As %Integer [ InitialExpression = 0, Private ];\n"})}),"\n",(0,t.jsx)(r.p,{children:"If true, we still need to build indices."}),"\n",(0,t.jsx)(r.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(r.h3,{id:"reset",children:"Reset"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method Reset()\n"})}),"\n",(0,t.jsx)(r.p,{children:"Reset the state of this object."}),"\n",(0,t.jsx)(r.h3,{id:"allocateroutine",children:"AllocateRoutine"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method AllocateRoutine(ByRef rtn As %String) As %Status [ ProcedureBlock = 1 ]\n"})}),"\n",(0,t.jsx)(r.p,{children:"Return the name of the routine to use for the import"}),"\n",(0,t.jsx)(r.h3,{id:"generateimportroutine",children:"GenerateImportRoutine"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method GenerateImportRoutine() As %Status\n"})}),"\n",(0,t.jsx)(r.p,{children:"Generate the Import routine."}),"\n",(0,t.jsx)(r.h3,{id:"deleteimportroutine",children:"DeleteImportRoutine"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method DeleteImportRoutine() As %Status\n"})}),"\n",(0,t.jsx)(r.p,{children:"Delete the generated import routine."}),"\n",(0,t.jsx)(r.h3,{id:"filesize",children:"FileSize"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method FileSize() As %Integer\n"})}),"\n",(0,t.jsx)(r.p,{children:"Returns the size of the import file."}),"\n",(0,t.jsx)(r.h3,{id:"errorcount",children:"ErrorCount"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method ErrorCount() As %Integer\n"})}),"\n",(0,t.jsx)(r.p,{children:"Returns the current number of import errors."}),"\n",(0,t.jsx)(r.h3,{id:"import",children:"Import"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method Import(savertn As %Boolean = 0) As %Status\n"})}),"\n",(0,t.jsx)(r.p,{children:"Do an import from the command line."}),"\n",(0,t.jsx)(r.h3,{id:"openimport",children:"OpenImport"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method OpenImport() As %Status\n"})}),"\n",(0,t.jsx)(r.p,{children:"Prepares the start of an import."}),"\n",(0,t.jsx)(r.p,{children:"Call this after generating an import routine."}),"\n",(0,t.jsx)(r.h3,{id:"importrows",children:"ImportRows"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method ImportRows(ByRef count As %Integer, ByRef inserted As %Integer, ByRef bytes As %Integer, ByRef done As %Integer, ByRef errorcount As %Integer, total As %Integer) As %Status\n"})}),"\n",(0,t.jsx)(r.p,{children:"Reads the next count rows from the import file."}),"\n",(0,t.jsx)(r.p,{children:"On return, counts contains the number of rows read from the file. inserted contains the number of rows successfully inserted. bytes contains the number of bytes read from the file. done is set to one when the import is complete. errorcount is the cumulative number of INSERT errors encountered."}),"\n",(0,t.jsx)(r.h3,{id:"buildindices",children:"BuildIndices"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method BuildIndices() As %Status\n"})}),"\n",(0,t.jsx)(r.p,{children:"Perform the merge sort to build the indices."}),"\n",(0,t.jsx)(r.h3,{id:"readheader",children:"ReadHeader"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method ReadHeader(ByRef header As %String, ByRef size As %Integer) As %Status\n"})}),"\n",(0,t.jsx)(r.p,{children:"Reads the first line of the import file."}),"\n",(0,t.jsx)(r.h3,{id:"closeimport",children:"CloseImport"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"Method CloseImport(abort As %Integer = 0) As %Status\n"})}),"\n",(0,t.jsx)(r.p,{children:"Call this at the end of the import operation."}),"\n",(0,t.jsx)(r.h3,{id:"errorlogexecute",children:"ErrorLogExecute"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"ClassMethod ErrorLogExecute(ByRef QHandle As %Binary) As %Status\n"})}),"\n",(0,t.jsx)(r.h3,{id:"errorlogclose",children:"ErrorLogClose"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"ClassMethod ErrorLogClose(QHandle As %Binary) As %Status\n"})}),"\n",(0,t.jsx)(r.h3,{id:"errorlogfetch",children:"ErrorLogFetch"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-objectscript-class",children:"ClassMethod ErrorLogFetch(ByRef QHandle As %Binary, ByRef Row As %List, ByRef AtEnd As %Integer = 0) As %Status\n"})})]})}function d(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>l});var t=n(96540);const s={},i=t.createContext(s);function o(e){const r=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:r},e.children)}}}]);