"use strict";(self.webpackChunkdocs_intersystems=self.webpackChunkdocs_intersystems||[]).push([[17722],{97724:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>o,default:()=>l,frontMatter:()=>a,toc:()=>i});var s=n(74848),r=n(28453);const a={pagination_prev:null,pagination_next:null},o="%Api.Atelier.v4",i=[{value:"XDatas",id:"xdatas",level:2},{value:"UrlMap",id:"urlmap",level:3},{value:"Methods",id:"methods",level:2},{value:"GetDoc",id:"getdoc",level:3},{value:"Index",id:"index",level:3},{value:"AppendResultSet",id:"appendresultset",level:3}];function c(e){const t={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"apiatelierv4",children:"%Api.Atelier.v4"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"Class %Api.Atelier.v4 Extends %Api.Atelier.v3\n"})}),"\n",(0,s.jsx)(t.p,{children:"%Api.Atelier.v4 provides version 4 APIs for Atelier"}),"\n",(0,s.jsx)(t.h2,{id:"xdatas",children:"XDatas"}),"\n",(0,s.jsx)(t.h3,{id:"urlmap",children:"UrlMap"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:'XData UrlMap [ XMLNamespace = "http://www.intersystems.com/urlmap" ]\n'})}),"\n",(0,s.jsx)(t.h2,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(t.h3,{id:"getdoc",children:"GetDoc"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod GetDoc(pNamespace As %String, pDocName As %String) As %Status\n"})}),"\n",(0,s.jsx)(t.p,{children:"This method returns the text for the named document and namespace."}),"\n",(0,s.jsx)(t.p,{children:"HTTP Codes returned:-"}),"\n",(0,s.jsxs)(t.p,{children:["HTTP 200 if OK",(0,s.jsx)(t.br,{}),"\nHTTP 304 if the document has not been modified (see ",(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/HTTP%5C_ETag",children:"https://en.wikipedia.org/wiki/HTTP\\_ETag"}),")",(0,s.jsx)(t.br,{}),"\nHTTP 400 if the named resource is not a valid document name",(0,s.jsx)(t.br,{}),"\nHTTP 404 if the document does not exist",(0,s.jsx)(t.br,{}),"\nHTTP 500 if an unxpected error occurs (details will be in status error array)"]}),"\n",(0,s.jsxs)(t.p,{children:["Return content will contain a document object.",(0,s.jsx)(t.br,{}),"\nErrors pertaining to the document will be in the status property of the document object. If source control hooks are enabled for the namespace any console output generated by the hook will be captured and returned as an array of lines in the 'console' array."]}),"\n",(0,s.jsx)(t.p,{children:"The result contains the name of the requested document, the database where it is stored, its timestamp and category (CLS - class, RTN - routine, CSP - csp, OTH - other), as well as the document contents which are returned in an array."}),"\n",(0,s.jsxs)(t.p,{children:["For text documents this will be an array of strings and the 'enc' json field will be set to false.",(0,s.jsx)(t.br,{}),"\nFor binary documents this will be an array of base64 encoded chunks and the 'enc' field will be set to true."]}),"\n",(0,s.jsx)(t.p,{children:"The URL parameter ?binary=1 can be passed to force the document to be encoded as binary."}),"\n",(0,s.jsx)(t.p,{children:"The URL parameter ?storageOnly=1 can be passed to return only the storage portion of a class."}),"\n",(0,s.jsx)(t.p,{children:'The URL parameter ?format= can be passed to specify the source format. The choices are "udl" (the default), "udl-multiline" or "xml". Specifying "udl-multiline" will format method arguments on multiple lines.'}),"\n",(0,s.jsx)(t.p,{children:"If a 'soft' error occurs such as a 'document does not exist', additional information can be found in the 'status' field of the result. Examples of other soft errors are 'file is locked' etc."}),"\n",(0,s.jsx)(t.p,{children:"Here is an example of the result of asking for %Activate.Enum.cls"}),"\n",(0,s.jsx)(t.p,{children:'{   "status": {     "errors": [],     "summary": ""   },   "console": [],   "result": {     "name": "%Activate.Enum.cls",     "db": "IRISLIB",     "ts": "2016-01-04 14:00:04.000",     "cat": "CLS",     "status": "",     "enc": false,     "content": [       "/// This class is the superclass for all enumerated types generated from",       "/// a type library",       "Class %Activate.Enum Extends %Integer [ Not ProcedureBlock, System = 3 ]",       "{",       "",       "}",       ""     ]   } }'}),"\n",(0,s.jsx)(t.p,{children:"and here is the result with ?binary=1"}),"\n",(0,s.jsx)(t.p,{children:'{   "status": {     "errors": [],     "summary": ""   },   "console": [],   "result": {     "name": "%Activate.Enum.cls",     "db": "IRISLIB",     "ts": "2016-01-04 14:00:04.000",     "cat": "CLS",     "status": "",     "enc": true,     "content": [       "Ly8vIFRoaXMgY2xhc3MgaXMgdGhlIHN1cGVyY2xhc3MgZm9yIGFsbCBlbnVtZXJhdGVkIHR5cGVzIGdlbmVyYXRlZCBmcm9tCi8vLyBhIHR5cGUgbGlicmFyeQpDbGFzcyAlQWN0aXZhdGUuRW51bSBFeHRlbmRzICVJbnRlZ2VyIFsgTm90IFByb2NlZHVyZUJsb2NrLCBTeXN0ZW0gPSAzIF0KewoKfQo="     ]   } }'}),"\n",(0,s.jsx)(t.h3,{id:"index",children:"Index"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod Index(pNamespace As %String) As %Status\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This method returns the indices for the all the specified documents in the namespace.",(0,s.jsx)(t.br,{}),"\nA list of documents to be indexed is passed in the body of the http request.",(0,s.jsx)(t.br,{}),'\nThe request body is simply a JSON array of names of documents you want to index [ "%Activate.Enum.cls", ... ]']}),"\n",(0,s.jsxs)(t.p,{children:['An optional label+offset location can be included at the end of a document name, delimited by a colon: [ "%Activate.Enum.cls:method+5", ... ]',(0,s.jsx)(t.br,{}),'\nIf a location is provided for a document, the values in the "others" array in the response object will contain the',(0,s.jsx)(t.br,{}),"\ndocument name followed by a ':' and then the offset corresponding to the location in the requested document."]}),"\n",(0,s.jsx)(t.p,{children:"NOTE: Currently we only support the indexing of classes"}),"\n",(0,s.jsx)(t.p,{children:"HTTP Codes returned:-"}),"\n",(0,s.jsxs)(t.p,{children:["HTTP 200 if OK",(0,s.jsx)(t.br,{}),"\nHTTP 415 if the we are not passed application/json as the content type",(0,s.jsx)(t.br,{}),"\nHTTP 500 if an error occurs (details will be in status error array)"]}),"\n",(0,s.jsxs)(t.p,{children:["Return content will be an array of index document objects. Errors pertaining to a document",(0,s.jsx)(t.br,{}),"\nwill be in the status property of each document object. The index contains information relating",(0,s.jsx)(t.br,{}),"\nto the structure and documentation of documents on the server and will vary by the category to",(0,s.jsx)(t.br,{}),"\nwhich the document belongs. Below is an example for a class."]}),"\n",(0,s.jsx)(t.p,{children:'{   "status": {     "errors": [],     "summary": ""   },   "console": [],   "result": {     "content": [       {         "name": "%Activate.GenericObject.cls",         "db": "IRISLIB",         "ts": "2016-01-04 14:00:04.000",         "gen": false,         "others": [           "%Activate.GenericObject.1.INT"         ],         "cat": "CLS",         "content": {           "desc": "This class provides functionality to create an ActiveX object, invoke its methods\\nand Get/Set its properties by name.",           "depl": false,           "depr": false,           "final": false,           "hidden": false,           "super": [             "%Activate.IDispatch"           ],           "methods": [             {               "name": "CreateObject",               "desc": "This method is used to create a generic object given only its progid. If the object\\ncannot be found an exception is thrown. The return value should be tested against\\n$$$NULLOREF  in the usual manner to ensure that the object has been successfully\\ncreated",               "depr": false,               "final": true,               "internal": false,               "private": false,               "scope": "class",               "returntype": "%Library.RegisteredObject",               "args": [                 {                   "name": "Progid",                   "type": "%Library.String"                 }               ]             },             {               "name": "GetObject",               "desc": "This method is used to create a generic object from a moniker. If the object\\ncannot be found an exception is thrown. The return value should be tested against\\n$$$NULLOREF  in the usual manner to ensure that the object has been successfully\\ncreated.",               "depr": false,               "final": true,               "internal": false,               "private": false,               "scope": "class",               "returntype": "%Library.RegisteredObject",               "args": [                 {                   "name": "Moniker",                   "type": "%Library.String"                 }               ]             }           ],           "parameters": [],           "properties": []         },         "status": ""       }     ]   } }'}),"\n",(0,s.jsx)(t.h3,{id:"appendresultset",children:"AppendResultSet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-objectscript-class",children:"ClassMethod AppendResultSet(pArray As %DynamicArray, pResult As %SQL.StatementResult) As %Status [ Internal, Private ]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Helper method for Query Appends result set (%SQL.StatementResult) to an array. Largely copied from %DataModel.Document.Server.SQL.Query"})]})}function l(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var s=n(96540);const r={},a=s.createContext(r);function o(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);